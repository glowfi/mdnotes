<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>26_Docker - Markdown Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-6e69d290.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-3a843a61.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">Markdown Notes</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="-docker-complete-cheatsheet-for-beginners"><a class="header" href="#-docker-complete-cheatsheet-for-beginners">ğŸ³ Docker Complete Cheatsheet for Beginners</a></h1>
<hr>
<h2 id="-official-documentation-links"><a class="header" href="#-official-documentation-links">ğŸ“š Official Documentation Links</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Resource</th><th>Link</th></tr>
</thead>
<tbody>
<tr><td>Docker Documentation</td><td>https://docs.docker.com/</td></tr>
<tr><td>Dockerfile Reference</td><td>https://docs.docker.com/reference/dockerfile/</td></tr>
<tr><td>Docker CLI Reference</td><td>https://docs.docker.com/reference/cli/docker/</td></tr>
<tr><td>Docker Compose</td><td>https://docs.docker.com/compose/</td></tr>
<tr><td>Docker Hub</td><td>https://hub.docker.com/</td></tr>
<tr><td>Best Practices</td><td>https://docs.docker.com/develop/develop-images/dockerfile_best-practices/</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="-basic-docker-commands"><a class="header" href="#-basic-docker-commands">ğŸ“¦ Basic Docker Commands</a></h2>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/</p>
</blockquote>
<h3 id="images"><a class="header" href="#images">Images</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/image/</p>
</blockquote>
<pre><code class="language-bash"># List images
docker images

# Pull image from Docker Hub
docker pull python:3.11

# Build image from Dockerfile
docker build -t myapp .

# Build with custom Dockerfile
docker build -f Dockerfile.prod -t myapp .

# Remove image
docker rmi myapp

# Remove all unused images
docker image prune -a

# Tag image
docker tag myapp myapp:v1.0

# Push to registry
docker push username/myapp:v1.0
</code></pre>
<h3 id="containers"><a class="header" href="#containers">Containers</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/container/</p>
</blockquote>
<pre><code class="language-bash"># Run container
docker run myapp

# Run with port mapping
docker run -p 8000:8000 myapp

# Run in background (detached)
docker run -d myapp

# Run with name
docker run --name my-container myapp

# Run interactively
docker run -it myapp bash

# Run with environment variables
docker run -e PORT=3000 -e DEBUG=true myapp

# Run with volume mount
docker run -v $(pwd):/app myapp

# Run and remove after exit
docker run --rm myapp

# List running containers
docker ps

# List all containers (including stopped)
docker ps -a

# Stop container
docker stop my-container

# Start stopped container
docker start my-container

# Restart container
docker restart my-container

# Remove container
docker rm my-container

# Remove running container (force)
docker rm -f my-container

# Remove all stopped containers
docker container prune
</code></pre>
<h3 id="logs--debugging"><a class="header" href="#logs--debugging">Logs &amp; Debugging</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/container/logs/</p>
</blockquote>
<pre><code class="language-bash"># View logs
docker logs my-container

# Follow logs (live)
docker logs -f my-container

# Show last 100 lines
docker logs --tail 100 my-container

# Execute command in running container
docker exec -it my-container bash

# View container details
docker inspect my-container

# View container resource usage
docker stats

# View container processes
docker top my-container
</code></pre>
<h3 id="cleanup"><a class="header" href="#cleanup">Cleanup</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/system/prune/</p>
</blockquote>
<pre><code class="language-bash"># Remove all stopped containers
docker container prune

# Remove all unused images
docker image prune -a

# Remove all unused volumes
docker volume prune

# Remove all unused networks
docker network prune

# Remove EVERYTHING unused
docker system prune -a

# View disk usage
docker system df
</code></pre>
<hr>
<h2 id="-dockerfile-reference"><a class="header" href="#-dockerfile-reference">ğŸ“ Dockerfile Reference</a></h2>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/reference/dockerfile/</p>
</blockquote>
<h3 id="basic-instructions"><a class="header" href="#basic-instructions">Basic Instructions</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Instruction</th><th>Purpose</th><th>Example</th><th>Docs</th></tr>
</thead>
<tbody>
<tr><td><code>FROM</code></td><td>Base image</td><td><code>FROM python:3.11-slim</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#from">Link</a></td></tr>
<tr><td><code>WORKDIR</code></td><td>Set working directory</td><td><code>WORKDIR /app</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#workdir">Link</a></td></tr>
<tr><td><code>COPY</code></td><td>Copy files</td><td><code>COPY . .</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#copy">Link</a></td></tr>
<tr><td><code>ADD</code></td><td>Copy files (supports URLs, tar)</td><td><code>ADD app.tar.gz /app</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#add">Link</a></td></tr>
<tr><td><code>RUN</code></td><td>Execute command</td><td><code>RUN pip install flask</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#run">Link</a></td></tr>
<tr><td><code>ENV</code></td><td>Set environment variable</td><td><code>ENV PORT=8000</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#env">Link</a></td></tr>
<tr><td><code>ARG</code></td><td>Build-time variable</td><td><code>ARG VERSION=1.0</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#arg">Link</a></td></tr>
<tr><td><code>EXPOSE</code></td><td>Document port</td><td><code>EXPOSE 8000</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#expose">Link</a></td></tr>
<tr><td><code>CMD</code></td><td>Default command</td><td><code>CMD ["python", "app.py"]</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#cmd">Link</a></td></tr>
<tr><td><code>ENTRYPOINT</code></td><td>Fixed command</td><td><code>ENTRYPOINT ["python"]</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#entrypoint">Link</a></td></tr>
<tr><td><code>VOLUME</code></td><td>Create mount point</td><td><code>VOLUME /data</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#volume">Link</a></td></tr>
<tr><td><code>USER</code></td><td>Set user</td><td><code>USER appuser</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#user">Link</a></td></tr>
<tr><td><code>LABEL</code></td><td>Add metadata</td><td><code>LABEL version="1.0"</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#label">Link</a></td></tr>
<tr><td><code>HEALTHCHECK</code></td><td>Container health check</td><td><code>HEALTHCHECK CMD curl -f http://localhost/</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#healthcheck">Link</a></td></tr>
<tr><td><code>SHELL</code></td><td>Change default shell</td><td><code>SHELL ["/bin/bash", "-c"]</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#shell">Link</a></td></tr>
<tr><td><code>STOPSIGNAL</code></td><td>Set stop signal</td><td><code>STOPSIGNAL SIGTERM</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#stopsignal">Link</a></td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="-dockerfile-examples"><a class="header" href="#-dockerfile-examples">ğŸ“„ Dockerfile Examples</a></h2>
<h3 id="python-single-stage"><a class="header" href="#python-single-stage">Python (Single Stage)</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://hub.docker.com/_/python</p>
</blockquote>
<pre><code class="language-dockerfile">FROM python:3.11-slim

ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1

WORKDIR /app

# Install dependencies first (caching)
COPY requirements.txt .
RUN pip install --upgrade pip &amp;&amp; \
    pip install --no-cache-dir -r requirements.txt

# Copy application code
COPY . .

EXPOSE 8000

CMD ["python", "app.py"]
</code></pre>
<h3 id="python-with-virtual-environment"><a class="header" href="#python-with-virtual-environment">Python with Virtual Environment</a></h3>
<pre><code class="language-dockerfile">FROM python:3.11-slim

ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1

WORKDIR /app

# Create and activate virtual environment
RUN python -m venv /opt/venv
ENV PATH="/opt/venv/bin:$PATH"

COPY requirements.txt .
RUN pip install --upgrade pip &amp;&amp; \
    pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 8000

CMD ["python", "app.py"]
</code></pre>
<h3 id="nodejs-single-stage"><a class="header" href="#nodejs-single-stage">Node.js (Single Stage)</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://hub.docker.com/_/node</p>
</blockquote>
<pre><code class="language-dockerfile">FROM node:20-alpine

WORKDIR /app

# Install dependencies first (caching)
COPY package*.json ./
RUN npm ci --only=production

COPY . .

EXPOSE 3000

CMD ["node", "server.js"]
</code></pre>
<h3 id="go-single-stage"><a class="header" href="#go-single-stage">Go (Single Stage)</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://hub.docker.com/_/golang</p>
</blockquote>
<pre><code class="language-dockerfile">FROM golang:1.21-alpine

WORKDIR /app

COPY go.mod go.sum ./
RUN go mod download

COPY . .

RUN go build -o main .

EXPOSE 8080

CMD ["./main"]
</code></pre>
<hr>
<h2 id="-multi-stage-builds"><a class="header" href="#-multi-stage-builds">ğŸ—ï¸ Multi-Stage Builds</a></h2>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/build/building/multi-stage/</p>
</blockquote>
<h3 id="why-multi-stage"><a class="header" href="#why-multi-stage">Why Multi-Stage?</a></h3>
<ul>
<li>âœ… Smaller final image</li>
<li>âœ… No build tools in production</li>
<li>âœ… Better security</li>
<li>âœ… Faster deployments</li>
</ul>
<h3 id="python-multi-stage"><a class="header" href="#python-multi-stage">Python Multi-Stage</a></h3>
<pre><code class="language-dockerfile"># ============ Build Stage ============
FROM python:3.11-slim AS builder

WORKDIR /app

RUN python -m venv /opt/venv
ENV PATH="/opt/venv/bin:$PATH"

COPY requirements.txt .
RUN pip install --upgrade pip &amp;&amp; \
    pip install --no-cache-dir -r requirements.txt

# ============ Production Stage ============
FROM python:3.11-slim

WORKDIR /app

# Copy virtual environment from builder
COPY --from=builder /opt/venv /opt/venv
ENV PATH="/opt/venv/bin:$PATH"

# Create non-root user
RUN useradd --create-home appuser
USER appuser

COPY --chown=appuser:appuser . .

EXPOSE 8000

CMD ["gunicorn", "--bind", "0.0.0.0:8000", "app:app"]
</code></pre>
<h3 id="nodejs-multi-stage"><a class="header" href="#nodejs-multi-stage">Node.js Multi-Stage</a></h3>
<pre><code class="language-dockerfile"># ============ Build Stage ============
FROM node:20-alpine AS builder

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .
RUN npm run build

# ============ Production Stage ============
FROM node:20-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

# Copy built files from builder
COPY --from=builder /app/dist ./dist

USER node

EXPOSE 3000

CMD ["node", "dist/server.js"]
</code></pre>
<h3 id="go-multi-stage-tiny-image"><a class="header" href="#go-multi-stage-tiny-image">Go Multi-Stage (Tiny Image!)</a></h3>
<pre><code class="language-dockerfile"># ============ Build Stage ============
FROM golang:1.21-alpine AS builder

WORKDIR /app

COPY go.mod go.sum ./
RUN go mod download

COPY . .

# Build static binary
RUN CGO_ENABLED=0 GOOS=linux go build -o main .

# ============ Production Stage ============
FROM scratch

# Copy only the binary
COPY --from=builder /app/main /main

EXPOSE 8080

ENTRYPOINT ["/main"]
</code></pre>
<h3 id="react-multi-stage-with-nginx"><a class="header" href="#react-multi-stage-with-nginx">React Multi-Stage (with Nginx)</a></h3>
<blockquote>
<p>ğŸ“– <strong>Nginx Docs:</strong> https://hub.docker.com/_/nginx</p>
</blockquote>
<pre><code class="language-dockerfile"># ============ Build Stage ============
FROM node:20-alpine AS builder

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .
RUN npm run build

# ============ Production Stage ============
FROM nginx:alpine

COPY --from=builder /app/build /usr/share/nginx/html

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
</code></pre>
<hr>
<h2 id="-docker-compose"><a class="header" href="#-docker-compose">ğŸ™ Docker Compose</a></h2>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/compose/
ğŸ“– <strong>Compose File Reference:</strong> https://docs.docker.com/compose/compose-file/</p>
</blockquote>
<h3 id="basic-commands"><a class="header" href="#basic-commands">Basic Commands</a></h3>
<blockquote>
<p>ğŸ“– <strong>CLI Reference:</strong> https://docs.docker.com/reference/cli/docker/compose/</p>
</blockquote>
<pre><code class="language-bash"># Start services
docker compose up

# Start in background
docker compose up -d

# Build and start
docker compose up --build

# Stop services
docker compose down

# Stop and remove volumes
docker compose down -v

# View logs
docker compose logs

# Follow logs
docker compose logs -f

# View logs for specific service
docker compose logs app

# List running services
docker compose ps

# Execute command in service
docker compose exec app bash

# Restart services
docker compose restart

# Stop services (without removing)
docker compose stop

# Start stopped services
docker compose start

# Build images
docker compose build

# Pull images
docker compose pull
</code></pre>
<h3 id="basic-docker-composeyml"><a class="header" href="#basic-docker-composeyml">Basic docker-compose.yml</a></h3>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        ports:
            - '8000:8000'
        environment:
            - DEBUG=true
</code></pre>
<h3 id="full-example-app--database--redis"><a class="header" href="#full-example-app--database--redis">Full Example (App + Database + Redis)</a></h3>
<blockquote>
<p>ğŸ“– <strong>PostgreSQL:</strong> https://hub.docker.com/<em>/postgres
ğŸ“– <strong>Redis:</strong> https://hub.docker.com/</em>/redis</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    # ============ Web Application ============
    app:
        build:
            context: .
            dockerfile: Dockerfile
        ports:
            - '8000:8000'
        environment:
            - DATABASE_URL=postgresql://user:password@db:5432/mydb
            - REDIS_URL=redis://redis:6379
        depends_on:
            - db
            - redis
        volumes:
            - .:/app # For development
        restart: unless-stopped

    # ============ PostgreSQL Database ============
    db:
        image: postgres:15-alpine
        environment:
            - POSTGRES_USER=user
            - POSTGRES_PASSWORD=password
            - POSTGRES_DB=mydb
        volumes:
            - postgres_data:/var/lib/postgresql/data
        ports:
            - '5432:5432'
        restart: unless-stopped

    # ============ Redis Cache ============
    redis:
        image: redis:7-alpine
        ports:
            - '6379:6379'
        volumes:
            - redis_data:/data
        restart: unless-stopped

# ============ Named Volumes ============
volumes:
    postgres_data:
    redis_data:
</code></pre>
<h3 id="with-environment-file"><a class="header" href="#with-environment-file">With Environment File</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/compose/environment-variables/</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        ports:
            - '8000:8000'
        env_file:
            - .env
</code></pre>
<p><strong>.env file:</strong></p>
<pre><code>DATABASE_URL=postgresql://user:pass@db:5432/mydb
SECRET_KEY=mysecretkey
DEBUG=false
</code></pre>
<h3 id="multiple-compose-files"><a class="header" href="#multiple-compose-files">Multiple Compose Files</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/compose/multiple-compose-files/</p>
</blockquote>
<pre><code class="language-bash"># Development
docker compose -f docker-compose.yml -f docker-compose.dev.yml up

# Production
docker compose -f docker-compose.yml -f docker-compose.prod.yml up
</code></pre>
<p><strong>docker-compose.yml (base):</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        environment:
            - DATABASE_URL=postgresql://user:pass@db:5432/mydb
</code></pre>
<p><strong>docker-compose.dev.yml:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        volumes:
            - .:/app
        environment:
            - DEBUG=true
        ports:
            - '8000:8000'
</code></pre>
<p><strong>docker-compose.prod.yml:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        environment:
            - DEBUG=false
        restart: always
</code></pre>
<h3 id="health-checks"><a class="header" href="#health-checks">Health Checks</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/compose/compose-file/05-services/#healthcheck</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        ports:
            - '8000:8000'
        healthcheck:
            test: ['CMD', 'curl', '-f', 'http://localhost:8000/health']
            interval: 30s
            timeout: 10s
            retries: 3
            start_period: 40s

    db:
        image: postgres:15-alpine
        healthcheck:
            test: ['CMD-SHELL', 'pg_isready -U user -d mydb']
            interval: 10s
            timeout: 5s
            retries: 5
</code></pre>
<h3 id="depends-on-with-conditions"><a class="header" href="#depends-on-with-conditions">Depends On with Conditions</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/compose/compose-file/05-services/#depends_on</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        depends_on:
            db:
                condition: service_healthy
            redis:
                condition: service_started

    db:
        image: postgres:15-alpine
        healthcheck:
            test: ['CMD-SHELL', 'pg_isready']
            interval: 5s
            timeout: 5s
            retries: 5

    redis:
        image: redis:7-alpine
</code></pre>
<hr>
<h2 id="-networking"><a class="header" href="#-networking">ğŸŒ Networking</a></h2>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/network/</p>
</blockquote>
<h3 id="network-commands"><a class="header" href="#network-commands">Network Commands</a></h3>
<blockquote>
<p>ğŸ“– <strong>CLI Docs:</strong> https://docs.docker.com/reference/cli/docker/network/</p>
</blockquote>
<pre><code class="language-bash"># List networks
docker network ls

# Create network
docker network create mynetwork

# Run container on network
docker run --network mynetwork myapp

# Connect container to network
docker network connect mynetwork my-container

# Disconnect from network
docker network disconnect mynetwork my-container

# Inspect network
docker network inspect mynetwork

# Remove network
docker network rm mynetwork
</code></pre>
<h3 id="network-drivers"><a class="header" href="#network-drivers">Network Drivers</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/engine/network/drivers</p>
</blockquote>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Driver</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><code>bridge</code></td><td>Default. Containers on same host communicate</td></tr>
<tr><td><code>host</code></td><td>Container uses hostâ€™s network directly</td></tr>
<tr><td><code>none</code></td><td>No networking</td></tr>
<tr><td><code>overlay</code></td><td>Multi-host networking (Swarm)</td></tr>
</tbody>
</table>
</div>
<h3 id="compose-networks"><a class="header" href="#compose-networks">Compose Networks</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/compose/networking/</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    frontend:
        build: ./frontend
        networks:
            - frontend-network

    backend:
        build: ./backend
        networks:
            - frontend-network
            - backend-network

    db:
        image: postgres:15
        networks:
            - backend-network

networks:
    frontend-network:
    backend-network:
</code></pre>
<hr>
<h2 id="-volumes"><a class="header" href="#-volumes">ğŸ’¾ Volumes</a></h2>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/storage/volumes/</p>
</blockquote>
<h3 id="volume-commands"><a class="header" href="#volume-commands">Volume Commands</a></h3>
<blockquote>
<p>ğŸ“– <strong>CLI Docs:</strong> https://docs.docker.com/reference/cli/docker/volume/</p>
</blockquote>
<pre><code class="language-bash"># List volumes
docker volume ls

# Create volume
docker volume create myvolume

# Run with volume
docker run -v myvolume:/data myapp

# Bind mount (host directory)
docker run -v $(pwd)/data:/app/data myapp

# Read-only mount
docker run -v $(pwd)/config:/app/config:ro myapp

# Inspect volume
docker volume inspect myvolume

# Remove volume
docker volume rm myvolume

# Remove unused volumes
docker volume prune
</code></pre>
<h3 id="volume-types"><a class="header" href="#volume-types">Volume Types</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/storage/</p>
</blockquote>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Type</th><th>Syntax</th><th>Use Case</th></tr>
</thead>
<tbody>
<tr><td>Named Volume</td><td><code>-v myvolume:/data</code></td><td>Persistent data</td></tr>
<tr><td>Bind Mount</td><td><code>-v $(pwd):/app</code></td><td>Development</td></tr>
<tr><td>tmpfs</td><td><code>--tmpfs /temp</code></td><td>Temporary data</td></tr>
</tbody>
</table>
</div>
<h3 id="compose-volumes"><a class="header" href="#compose-volumes">Compose Volumes</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/compose/compose-file/07-volumes/</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        volumes:
            # Named volume
            - app_data:/app/data

            # Bind mount
            - ./src:/app/src

            # Read-only bind mount
            - ./config:/app/config:ro

volumes:
    app_data:
</code></pre>
<hr>
<h2 id="-dockerignore"><a class="header" href="#-dockerignore">ğŸ“ .dockerignore</a></h2>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/reference/dockerfile/#dockerignore-file</p>
</blockquote>
<pre><code># Git
.git
.gitignore

# Python
__pycache__
*.pyc
*.pyo
venv/
.env

# Node
node_modules/
npm-debug.log

# IDE
.vscode/
.idea/

# OS
.DS_Store
Thumbs.db

# Docker
Dockerfile*
docker-compose*

# Docs
README.md
docs/

# Tests
tests/
*.test.js
</code></pre>
<hr>
<h2 id="-security-best-practices"><a class="header" href="#-security-best-practices">ğŸ”’ Security Best Practices</a></h2>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/develop/security-best-practices/</p>
</blockquote>
<h3 id="run-as-non-root-user"><a class="header" href="#run-as-non-root-user">Run as Non-Root User</a></h3>
<blockquote>
<p>ğŸ“– <strong>USER Docs:</strong> https://docs.docker.com/reference/dockerfile/#user</p>
</blockquote>
<pre><code class="language-dockerfile"># Create user
RUN useradd --create-home appuser

# Switch to user
USER appuser

# Copy files with correct ownership
COPY --chown=appuser:appuser . .
</code></pre>
<h3 id="use-specific-image-tags"><a class="header" href="#use-specific-image-tags">Use Specific Image Tags</a></h3>
<pre><code class="language-dockerfile"># âŒ Bad
FROM python:latest

# âœ… Good
FROM python:3.11.6-slim-bookworm
</code></pre>
<h3 id="scan-for-vulnerabilities"><a class="header" href="#scan-for-vulnerabilities">Scan for Vulnerabilities</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docker Scout Docs:</strong> https://docs.docker.com/scout/</p>
</blockquote>
<pre><code class="language-bash"># Scan image
docker scout cves myapp

# Quick overview
docker scout quickview myapp
</code></pre>
<hr>
<h2 id="-best-practices"><a class="header" href="#-best-practices">ğŸ”§ Best Practices</a></h2>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/develop/develop-images/dockerfile_best-practices/</p>
</blockquote>
<h3 id="dockerfile"><a class="header" href="#dockerfile">Dockerfile</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>âœ… Do</th><th>âŒ Donâ€™t</th></tr>
</thead>
<tbody>
<tr><td>Use specific image tags</td><td>Use <code>latest</code> tag</td></tr>
<tr><td>Use <code>.dockerignore</code></td><td>Copy unnecessary files</td></tr>
<tr><td>Order by change frequency</td><td>Random instruction order</td></tr>
<tr><td>Combine RUN commands</td><td>Multiple RUN for one task</td></tr>
<tr><td>Use multi-stage builds</td><td>Include build tools in prod</td></tr>
<tr><td>Run as non-root user</td><td>Run as root</td></tr>
<tr><td>Use <code>COPY</code> over <code>ADD</code></td><td>Use <code>ADD</code> unless needed</td></tr>
</tbody>
</table>
</div>
<h3 id="layer-caching-order"><a class="header" href="#layer-caching-order">Layer Caching Order</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/build/cache/</p>
</blockquote>
<pre><code class="language-dockerfile"># 1. Base image (rarely changes)
FROM python:3.11-slim

# 2. System dependencies (rarely changes)
RUN apt-get update &amp;&amp; apt-get install -y curl

# 3. App dependencies (sometimes changes)
COPY requirements.txt .
RUN pip install -r requirements.txt

# 4. Application code (frequently changes)
COPY . .

# 5. Runtime config
CMD ["python", "app.py"]
</code></pre>
<hr>
<h2 id="-quick-reference-card"><a class="header" href="#-quick-reference-card">ğŸš€ Quick Reference Card</a></h2>
<h3 id="most-used-commands"><a class="header" href="#most-used-commands">Most Used Commands</a></h3>
<pre><code class="language-bash"># Build
docker build -t myapp .

# Run
docker run -d -p 8000:8000 --name myapp myapp

# Logs
docker logs -f myapp

# Shell access
docker exec -it myapp bash

# Stop &amp; Remove
docker stop myapp &amp;&amp; docker rm myapp

# Compose up
docker compose up -d --build

# Compose down
docker compose down -v

# Cleanup
docker system prune -a
</code></pre>
<h3 id="port-mapping"><a class="header" href="#port-mapping">Port Mapping</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/container/run/#publish</p>
</blockquote>
<pre><code>-p HOST:CONTAINER

-p 8000:8000     # localhost:8000 â†’ container:8000
-p 3000:8000     # localhost:3000 â†’ container:8000
-p 127.0.0.1:8000:8000  # Only localhost
</code></pre>
<h3 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h3>
<blockquote>
<p>ğŸ“– <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/container/run/#env</p>
</blockquote>
<pre><code class="language-bash"># Single variable
docker run -e MY_VAR=value myapp

# Multiple variables
docker run -e VAR1=a -e VAR2=b myapp

# From file
docker run --env-file .env myapp
</code></pre>
<hr>
<h2 id="-image-size-comparison"><a class="header" href="#-image-size-comparison">ğŸ“Š Image Size Comparison</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Base Image</th><th>Size</th><th>Docs</th></tr>
</thead>
<tbody>
<tr><td><code>python:3.11</code></td><td>~900MB</td><td><a href="https://hub.docker.com/_/python">Link</a></td></tr>
<tr><td><code>python:3.11-slim</code></td><td>~120MB</td><td><a href="https://hub.docker.com/_/python">Link</a></td></tr>
<tr><td><code>python:3.11-alpine</code></td><td>~50MB</td><td><a href="https://hub.docker.com/_/python">Link</a></td></tr>
<tr><td><code>node:20</code></td><td>~1GB</td><td><a href="https://hub.docker.com/_/node">Link</a></td></tr>
<tr><td><code>node:20-slim</code></td><td>~200MB</td><td><a href="https://hub.docker.com/_/node">Link</a></td></tr>
<tr><td><code>node:20-alpine</code></td><td>~130MB</td><td><a href="https://hub.docker.com/_/node">Link</a></td></tr>
<tr><td><code>golang:1.21</code></td><td>~800MB</td><td><a href="https://hub.docker.com/_/golang">Link</a></td></tr>
<tr><td><code>golang:1.21-alpine</code></td><td>~250MB</td><td><a href="https://hub.docker.com/_/golang">Link</a></td></tr>
<tr><td><code>nginx:alpine</code></td><td>~40MB</td><td><a href="https://hub.docker.com/_/nginx">Link</a></td></tr>
<tr><td><code>scratch</code></td><td>0MB</td><td><a href="https://hub.docker.com/_/scratch">Link</a></td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="-additional-resources"><a class="header" href="#-additional-resources">ğŸ“– Additional Resources</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Resource</th><th>Link</th></tr>
</thead>
<tbody>
<tr><td>Docker Getting Started</td><td>https://docs.docker.com/get-started/</td></tr>
<tr><td>Docker Samples</td><td>https://docs.docker.com/samples/</td></tr>
<tr><td>Dockerfile Reference</td><td>https://docs.docker.com/reference/dockerfile/</td></tr>
<tr><td>Compose File Reference</td><td>https://docs.docker.com/compose/compose-file/</td></tr>
<tr><td>Docker CLI Reference</td><td>https://docs.docker.com/reference/cli/docker/</td></tr>
<tr><td>Awesome Docker</td><td>https://github.com/veggiemonk/awesome-docker</td></tr>
<tr><td>Docker Labs</td><td>https://github.com/docker/labs</td></tr>
<tr><td>Play with Docker</td><td>https://labs.play-with-docker.com/</td></tr>
<tr><td>Docker Curriculum</td><td>https://docker-curriculum.com/</td></tr>
</tbody>
</table>
</div>
<hr>
<h1 id="-container-design-patterns"><a class="header" href="#-container-design-patterns">ğŸ¨ Container Design Patterns</a></h1>
<blockquote>
<p>ğŸ“– <strong>Kubernetes Patterns Reference:</strong> https://kubernetes.io/docs/concepts/workloads/pods/#how-pods-manage-multiple-containers
ğŸ“– <strong>Multi-Container Patterns:</strong> https://kubernetes.io/blog/2015/06/the-distributed-system-toolkit-patterns/</p>
</blockquote>
<p>These patterns are commonly used in Docker Compose and Kubernetes to design multi-container applications.</p>
<hr>
<h2 id="1-sidecar-pattern"><a class="header" href="#1-sidecar-pattern">1ï¸âƒ£ Sidecar Pattern</a></h2>
<blockquote>
<p><strong>Purpose:</strong> Extend or enhance the main container without modifying it.</p>
</blockquote>
<p>The sidecar runs alongside the main container, sharing the same resources (volumes, network).</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Pod/Service                    â”‚
â”‚                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚                 â”‚   â”‚                 â”‚      â”‚
â”‚   â”‚    Main App     â”‚   â”‚    Sidecar      â”‚      â”‚
â”‚   â”‚                 â”‚â—„â”€â–ºâ”‚   (Logs/        â”‚      â”‚
â”‚   â”‚                 â”‚   â”‚   Metrics)      â”‚      â”‚
â”‚   â”‚                 â”‚   â”‚                 â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚            â”‚                     â”‚               â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                       â”‚                          â”‚
â”‚               Shared Volume                      â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Log shipping (Fluentd, Filebeat)</li>
<li>Metrics collection (Prometheus exporter)</li>
<li>Security scanning</li>
<li>Configuration reloading</li>
</ul>
<p><strong>Docker Compose Example:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    # ============ Main Application ============
    app:
        build: .
        volumes:
            - app_logs:/var/log/app
        ports:
            - '8000:8000'

    # ============ Sidecar: Log Shipper ============
    log-shipper:
        image: fluent/fluentd:v1.16-1
        volumes:
            - app_logs:/var/log/app:ro
            - ./fluentd.conf:/fluentd/etc/fluent.conf
        depends_on:
            - app

volumes:
    app_logs:
</code></pre>
<p><strong>Another Example: Nginx + Metrics Sidecar</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    # Main web server
    nginx:
        image: nginx:alpine
        ports:
            - '80:80'
        volumes:
            - nginx_status:/var/run/nginx

    # Sidecar: Prometheus exporter
    nginx-exporter:
        image: nginx/nginx-prometheus-exporter:0.11
        command:
            - '-nginx.scrape-uri=http://nginx:80/stub_status'
        ports:
            - '9113:9113'
        depends_on:
            - nginx

volumes:
    nginx_status:
</code></pre>
<hr>
<h2 id="2-adapter-pattern"><a class="header" href="#2-adapter-pattern">2ï¸âƒ£ Adapter Pattern</a></h2>
<blockquote>
<p><strong>Purpose:</strong> Standardize or transform output from the main container.</p>
</blockquote>
<p>The adapter translates the main appâ€™s output to a standard format that external systems expect.</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Pod/Service                            â”‚
â”‚                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚                 â”‚   â”‚                 â”‚                   â”‚
â”‚   â”‚    Main App     â”‚â”€â”€â–ºâ”‚    Adapter      â”‚â”€â”€â–º Standard       â”‚
â”‚   â”‚                 â”‚   â”‚   (Transform)   â”‚    Output         â”‚
â”‚   â”‚   (Custom       â”‚   â”‚                 â”‚                   â”‚
â”‚   â”‚    Output)      â”‚   â”‚                 â”‚                   â”‚
â”‚   â”‚                 â”‚   â”‚                 â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Converting logs to JSON format</li>
<li>Transforming metrics to Prometheus format</li>
<li>Normalizing API responses</li>
<li>Protocol translation</li>
</ul>
<p><strong>Docker Compose Example: Log Format Adapter</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    # ============ Main App (Custom Log Format) ============
    app:
        build: .
        volumes:
            - app_logs:/var/log/app

    # ============ Adapter: Convert to JSON ============
    log-adapter:
        build:
            context: ./adapter
            dockerfile: Dockerfile
        volumes:
            - app_logs:/var/log/app:ro
            - json_logs:/var/log/json
        environment:
            - INPUT_PATH=/var/log/app/app.log
            - OUTPUT_PATH=/var/log/json/app.json

    # ============ Log Collector (Expects JSON) ============
    log-collector:
        image: fluent/fluentd:v1.16-1
        volumes:
            - json_logs:/var/log/json:ro

volumes:
    app_logs:
    json_logs:
</code></pre>
<p><strong>Adapter Dockerfile:</strong></p>
<pre><code class="language-dockerfile">FROM python:3.11-slim

WORKDIR /app

COPY adapter.py .

CMD ["python", "adapter.py"]
</code></pre>
<p><strong>adapter.py:</strong></p>
<pre><code class="language-python">import json
import os
import time

INPUT_PATH = os.environ.get('INPUT_PATH', '/var/log/app/app.log')
OUTPUT_PATH = os.environ.get('OUTPUT_PATH', '/var/log/json/app.json')

def transform_log(line):
    """Convert custom log format to JSON"""
    parts = line.strip().split(' | ')
    return json.dumps({
        "timestamp": parts[0] if len(parts) &gt; 0 else "",
        "level": parts[1] if len(parts) &gt; 1 else "",
        "message": parts[2] if len(parts) &gt; 2 else line
    })

while True:
    try:
        with open(INPUT_PATH, 'r') as infile:
            with open(OUTPUT_PATH, 'a') as outfile:
                for line in infile:
                    outfile.write(transform_log(line) + '\n')
    except FileNotFoundError:
        pass
    time.sleep(1)
</code></pre>
<hr>
<h2 id="3-ambassador-pattern"><a class="header" href="#3-ambassador-pattern">3ï¸âƒ£ Ambassador Pattern</a></h2>
<blockquote>
<p><strong>Purpose:</strong> Proxy connections to external services.</p>
</blockquote>
<p>The ambassador acts as a proxy, simplifying how the main app connects to external services.</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Pod/Service                            â”‚
â”‚                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚            â”‚  â”‚
â”‚   â”‚    Main App     â”‚â”€â”€â–ºâ”‚   Ambassador    â”‚â”€â”€â–ºâ”‚  External  â”‚  â”‚
â”‚   â”‚                 â”‚   â”‚    (Proxy)      â”‚   â”‚  Service   â”‚  â”‚
â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚  (DB/API)  â”‚  â”‚
â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚            â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                               â”‚
â”‚     localhost:5432         Handles:             Remote DB     â”‚
â”‚                         - Connection pool                     â”‚
â”‚                         - Retry logic                         â”‚
â”‚                         - TLS termination                     â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Database connection pooling (PgBouncer)</li>
<li>Service discovery</li>
<li>TLS/SSL termination</li>
<li>Rate limiting</li>
<li>Circuit breaker</li>
</ul>
<p><strong>Docker Compose Example: Database Ambassador</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    # ============ Main Application ============
    app:
        build: .
        environment:
            # App connects to ambassador, not directly to DB
            - DATABASE_URL=postgresql://user:pass@pgbouncer:5432/mydb
        depends_on:
            - pgbouncer

    # ============ Ambassador: Connection Pooler ============
    pgbouncer:
        image: edoburu/pgbouncer:1.21.0
        environment:
            - DATABASE_URL=postgresql://user:pass@db:5432/mydb
            - POOL_MODE=transaction
            - MAX_CLIENT_CONN=100
            - DEFAULT_POOL_SIZE=20
        depends_on:
            - db

    # ============ External Database ============
    db:
        image: postgres:15-alpine
        environment:
            - POSTGRES_USER=user
            - POSTGRES_PASSWORD=pass
            - POSTGRES_DB=mydb
        volumes:
            - postgres_data:/var/lib/postgresql/data

volumes:
    postgres_data:
</code></pre>
<p><strong>Another Example: Redis Ambassador with HAProxy</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        environment:
            # Connect through ambassador
            - REDIS_URL=redis://redis-ambassador:6379

    # Ambassador handles failover
    redis-ambassador:
        image: haproxy:2.8-alpine
        volumes:
            - ./haproxy.cfg:/usr/local/etc/haproxy/haproxy.cfg:ro
        depends_on:
            - redis-master
            - redis-replica

    redis-master:
        image: redis:7-alpine

    redis-replica:
        image: redis:7-alpine
        command: redis-server --replicaof redis-master 6379
</code></pre>
<hr>
<h2 id="4-init-container-pattern"><a class="header" href="#4-init-container-pattern">4ï¸âƒ£ Init Container Pattern</a></h2>
<blockquote>
<p><strong>Purpose:</strong> Run setup tasks before the main container starts.</p>
</blockquote>
<p>Init containers run to completion before the main app starts. Used for initialization tasks.</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Startup Sequence                         â”‚
â”‚                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚           â”‚   â”‚           â”‚   â”‚                       â”‚   â”‚
â”‚   â”‚  Init 1   â”‚â”€â”€â–ºâ”‚  Init 2   â”‚â”€â”€â–ºâ”‚   Main Container      â”‚   â”‚
â”‚   â”‚ (migrate) â”‚   â”‚  (wait)   â”‚   â”‚       (app)           â”‚   â”‚
â”‚   â”‚           â”‚   â”‚           â”‚   â”‚                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚    Completes       Completes           Runs                   â”‚
â”‚    &amp; exits         &amp; exits          continuously              â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Database migrations</li>
<li>Wait for dependencies</li>
<li>Download configuration</li>
<li>Set up permissions</li>
<li>Seed data</li>
</ul>
<p><strong>Docker Compose Example:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    # ============ Init: Wait for DB ============
    init-wait-db:
        image: postgres:15-alpine
        command: &gt;
            sh -c "
              until pg_isready -h db -U user; do
                echo 'Waiting for database...';
                sleep 2;
              done;
              echo 'Database is ready!'
            "
        depends_on:
            - db

    # ============ Init: Run Migrations ============
    init-migrate:
        build: .
        command: python manage.py migrate
        environment:
            - DATABASE_URL=postgresql://user:pass@db:5432/mydb
        depends_on:
            init-wait-db:
                condition: service_completed_successfully

    # ============ Init: Seed Data ============
    init-seed:
        build: .
        command: python manage.py seed
        environment:
            - DATABASE_URL=postgresql://user:pass@db:5432/mydb
        depends_on:
            init-migrate:
                condition: service_completed_successfully

    # ============ Main Application ============
    app:
        build: .
        ports:
            - '8000:8000'
        environment:
            - DATABASE_URL=postgresql://user:pass@db:5432/mydb
        depends_on:
            init-seed:
                condition: service_completed_successfully

    # ============ Database ============
    db:
        image: postgres:15-alpine
        environment:
            - POSTGRES_USER=user
            - POSTGRES_PASSWORD=pass
            - POSTGRES_DB=mydb
        volumes:
            - postgres_data:/var/lib/postgresql/data
        healthcheck:
            test: ['CMD-SHELL', 'pg_isready -U user -d mydb']
            interval: 5s
            timeout: 5s
            retries: 5

volumes:
    postgres_data:
</code></pre>
<p><strong>Simple Init with Shell Script:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    init:
        image: busybox
        volumes:
            - shared_config:/config
        command: &gt;
            sh -c "
              echo 'Downloading config...';
              wget -O /config/app.conf https://example.com/config;
              echo 'Setting permissions...';
              chmod 644 /config/app.conf;
              echo 'Init complete!'
            "

    app:
        build: .
        volumes:
            - shared_config:/app/config:ro
        depends_on:
            init:
                condition: service_completed_successfully

volumes:
    shared_config:
</code></pre>
<hr>
<h2 id="5-work-queue-pattern"><a class="header" href="#5-work-queue-pattern">5ï¸âƒ£ Work Queue Pattern</a></h2>
<blockquote>
<p><strong>Purpose:</strong> Distribute tasks across multiple worker containers.</p>
</blockquote>
<p>A queue holds tasks that multiple workers process concurrently.</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Work Queue Pattern                       â”‚
â”‚                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚             â”‚   â”‚                 â”‚   â”‚                â”‚  â”‚
â”‚   â”‚  Producer   â”‚â”€â”€â–ºâ”‚     Queue       â”‚â—„â”€â”€â”‚   Worker 1     â”‚  â”‚
â”‚   â”‚   (API)     â”‚   â”‚                 â”‚â—„â”€â”€â”‚   Worker 2     â”‚  â”‚
â”‚   â”‚             â”‚   â”‚  (Redis/        â”‚â—„â”€â”€â”‚   Worker 3     â”‚  â”‚
â”‚   â”‚             â”‚   â”‚   RabbitMQ)     â”‚   â”‚                â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                               â”‚
â”‚    Adds tasks         Holds tasks         Process tasks       â”‚
â”‚    to queue          until picked         concurrently        â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Background job processing</li>
<li>Email sending</li>
<li>Image/video processing</li>
<li>Report generation</li>
<li>Data pipelines</li>
</ul>
<p><strong>Docker Compose Example: Celery Workers</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    # ============ Web API (Producer) ============
    web:
        build: .
        command: gunicorn --bind 0.0.0.0:8000 app:app
        ports:
            - '8000:8000'
        environment:
            - CELERY_BROKER_URL=redis://redis:6379/0
            - CELERY_RESULT_BACKEND=redis://redis:6379/0
        depends_on:
            - redis

    # ============ Celery Workers ============
    worker:
        build: .
        command: celery -A tasks worker --loglevel=info
        environment:
            - CELERY_BROKER_URL=redis://redis:6379/0
            - CELERY_RESULT_BACKEND=redis://redis:6379/0
        depends_on:
            - redis
        deploy:
            replicas: 3

    # ============ Celery Beat (Scheduler) ============
    beat:
        build: .
        command: celery -A tasks beat --loglevel=info
        environment:
            - CELERY_BROKER_URL=redis://redis:6379/0
        depends_on:
            - redis

    # ============ Message Queue ============
    redis:
        image: redis:7-alpine
        volumes:
            - redis_data:/data

    # ============ Monitoring (Flower) ============
    flower:
        build: .
        command: celery -A tasks flower --port=5555
        ports:
            - '5555:5555'
        environment:
            - CELERY_BROKER_URL=redis://redis:6379/0
        depends_on:
            - redis

volumes:
    redis_data:
</code></pre>
<p><strong>tasks.py (Celery Tasks):</strong></p>
<pre><code class="language-python">from celery import Celery

app = Celery('tasks')
app.config_from_object({
    'broker_url': 'redis://redis:6379/0',
    'result_backend': 'redis://redis:6379/0'
})

@app.task
def process_image(image_id):
    """Long-running image processing task"""
    # Processing logic here
    return f"Processed image {image_id}"

@app.task
def send_email(to, subject, body):
    """Email sending task"""
    # Email logic here
    return f"Email sent to {to}"
</code></pre>
<p><strong>RabbitMQ Example:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    web:
        build: .
        ports:
            - '8000:8000'
        environment:
            - RABBITMQ_URL=amqp://user:pass@rabbitmq:5672/
        depends_on:
            rabbitmq:
                condition: service_healthy

    worker:
        build: .
        command: python worker.py
        environment:
            - RABBITMQ_URL=amqp://user:pass@rabbitmq:5672/
        depends_on:
            rabbitmq:
                condition: service_healthy
        deploy:
            replicas: 5

    rabbitmq:
        image: rabbitmq:3-management-alpine
        environment:
            - RABBITMQ_DEFAULT_USER=user
            - RABBITMQ_DEFAULT_PASS=pass
        ports:
            - '5672:5672'
            - '15672:15672'
        volumes:
            - rabbitmq_data:/var/lib/rabbitmq
        healthcheck:
            test: ['CMD', 'rabbitmq-diagnostics', 'check_running']
            interval: 10s
            timeout: 5s
            retries: 5

volumes:
    rabbitmq_data:
</code></pre>
<hr>
<h2 id="-pattern-comparison"><a class="header" href="#-pattern-comparison">ğŸ“Š Pattern Comparison</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Pattern</th><th>Purpose</th><th>Lifecycle</th><th>Example</th></tr>
</thead>
<tbody>
<tr><td><strong>Sidecar</strong></td><td>Extend main app</td><td>Runs alongside</td><td>Log shipping, metrics</td></tr>
<tr><td><strong>Adapter</strong></td><td>Transform output</td><td>Runs alongside</td><td>Format conversion</td></tr>
<tr><td><strong>Ambassador</strong></td><td>Proxy connections</td><td>Runs alongside</td><td>DB pooling</td></tr>
<tr><td><strong>Init</strong></td><td>Setup before main</td><td>Runs once, exits</td><td>Migrations</td></tr>
<tr><td><strong>Work Queue</strong></td><td>Distribute tasks</td><td>Multiple workers</td><td>Background jobs</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="-when-to-use-each-pattern"><a class="header" href="#-when-to-use-each-pattern">ğŸ¯ When to Use Each Pattern</a></h2>
<pre><code>Need to run setup before app starts?
â””â”€â–º YES â”€â”€â–º Init Pattern

Need to enhance app without modifying it?
â””â”€â–º YES â”€â”€â–º Sidecar Pattern

Need to transform app output to standard format?
â””â”€â–º YES â”€â”€â–º Adapter Pattern

Need to simplify external service connections?
â””â”€â–º YES â”€â”€â–º Ambassador Pattern

Need to process tasks asynchronously?
â””â”€â–º YES â”€â”€â–º Work Queue Pattern
</code></pre>
<hr>
<h2 id="-combined-patterns-example"><a class="header" href="#-combined-patterns-example">ğŸ”— Combined Patterns Example</a></h2>
<p>Real-world applications often combine multiple patterns:</p>
<pre><code class="language-yaml">version: '3.8'

services:
    # ===== Init Containers =====
    init-wait:
        image: busybox
        command: &gt;
            sh -c "
              echo 'Waiting for services...';
              sleep 5;
              echo 'Ready!'
            "

    init-migrate:
        build: .
        command: python manage.py migrate
        depends_on:
            init-wait:
                condition: service_completed_successfully
            db:
                condition: service_healthy

    # ===== Main Application =====
    app:
        build: .
        ports:
            - '8000:8000'
        environment:
            - DATABASE_URL=postgresql://user:pass@pgbouncer:5432/mydb
        depends_on:
            init-migrate:
                condition: service_completed_successfully
        volumes:
            - app_logs:/var/log/app

    # ===== Sidecar: Log Shipper =====
    log-shipper:
        image: fluent/fluentd:v1.16-1
        volumes:
            - app_logs:/var/log/app:ro
        depends_on:
            - app

    # ===== Sidecar: Metrics Exporter =====
    metrics-exporter:
        image: prom/statsd-exporter
        ports:
            - '9102:9102'
        depends_on:
            - app

    # ===== Ambassador: DB Connection Pool =====
    pgbouncer:
        image: edoburu/pgbouncer:1.21.0
        environment:
            - DATABASE_URL=postgresql://user:pass@db:5432/mydb
            - POOL_MODE=transaction
        depends_on:
            - db

    # ===== Work Queue: Background Workers =====
    worker:
        build: .
        command: celery -A tasks worker --loglevel=info
        environment:
            - CELERY_BROKER_URL=redis://redis:6379/0
        depends_on:
            - redis
        deploy:
            replicas: 3

    # ===== Infrastructure =====
    db:
        image: postgres:15-alpine
        environment:
            - POSTGRES_USER=user
            - POSTGRES_PASSWORD=pass
            - POSTGRES_DB=mydb
        volumes:
            - postgres_data:/var/lib/postgresql/data
        healthcheck:
            test: ['CMD-SHELL', 'pg_isready -U user']
            interval: 5s
            timeout: 5s
            retries: 5

    redis:
        image: redis:7-alpine
        volumes:
            - redis_data:/data

volumes:
    app_logs:
    postgres_data:
    redis_data:
</code></pre>
<p><strong>Architecture Diagram:</strong></p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Application Stack                           â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     Init Phase                               â”‚    â”‚
â”‚  â”‚   [init-wait] â”€â”€â–º [init-migrate] â”€â”€â–º Ready                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                      â”‚
â”‚                              â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     Runtime Phase                            â”‚    â”‚
â”‚  â”‚                                                              â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚    â”‚
â”‚  â”‚   â”‚   App   â”‚   â”‚  Log    â”‚   â”‚ Metrics â”‚   â—„â”€â”€ Sidecars     â”‚    â”‚
â”‚  â”‚   â”‚         â”‚   â”‚ Shipper â”‚   â”‚Exporter â”‚                    â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚    â”‚
â”‚  â”‚        â”‚                                                     â”‚    â”‚
â”‚  â”‚        â–¼                                                     â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                â”‚    â”‚
â”‚  â”‚   â”‚PgBouncerâ”‚   â—„â”€â”€ Ambassador                               â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                â”‚    â”‚
â”‚  â”‚        â”‚                                                     â”‚    â”‚
â”‚  â”‚        â–¼                                                     â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚    â”‚
â”‚  â”‚   â”‚   DB    â”‚   â”‚  Redis  â”‚   â”‚ Workers â”‚   â—„â”€â”€ Work Queue   â”‚    â”‚
â”‚  â”‚   â”‚         â”‚   â”‚         â”‚   â”‚ (1,2,3) â”‚                    â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚    â”‚
â”‚  â”‚                                                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr>
<h2 id="-additional-resources-1"><a class="header" href="#-additional-resources-1">ğŸ“– Additional Resources</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Resource</th><th>Link</th></tr>
</thead>
<tbody>
<tr><td>Kubernetes Multi-Container Pods</td><td>https://kubernetes.io/docs/concepts/workloads/pods/</td></tr>
<tr><td>Distributed System Patterns</td><td>https://kubernetes.io/blog/2015/06/the-distributed-system-toolkit-patterns/</td></tr>
<tr><td>Sidecar Pattern</td><td>https://learn.microsoft.com/en-us/azure/architecture/patterns/sidecar</td></tr>
<tr><td>Ambassador Pattern</td><td>https://learn.microsoft.com/en-us/azure/architecture/patterns/ambassador</td></tr>
<tr><td>Docker Compose Docs</td><td>https://docs.docker.com/compose/</td></tr>
</tbody>
</table>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="25_Golang.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="27_Kubernetes.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="25_Golang.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="27_Kubernetes.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
