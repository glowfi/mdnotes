<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Markdown Notes</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-24d815cf.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-3a843a61.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">Markdown Notes</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="react-i"><a class="header" href="#react-i">React I</a></h1>
<blockquote>
<p>What is React and some of its advantages.</p>
</blockquote>
<ul>
<li>
<p>React is a <strong>Javascript library for creating user interfaces</strong>.</p>
</li>
<li>
<p>React is all about <strong>components</strong>. Components are <strong>idependent chunks
of user interfaces</strong> ,which can be pieced up together like lego
blocks and as a result we will be able to create a complex app.</p>
</li>
<li>
<p>Components are <strong>independent , isolated &amp; resuable</strong> and once they are ready they can
be used anywhere. So if we want to change a logic in one of the components
we have do it only in one place and all the instances where we are
using it will be updated with the new logic.</p>
</li>
<li>
<p>Basically we can <strong>update the logic of components without
breaking our whole app</strong> ,if we are making an app which is divided
into multiple isolated components.</p>
</li>
<li>
<p>Under the hood React is very <strong>fast</strong> as it uses something called
<strong>Virtual DOM</strong> which only updates the components which requires
updating and without re-rendering our whole app.</p>
</li>
</ul>
<h3 id="npx"><a class="header" href="#npx">NPX</a></h3>
<p>NPX will only execute the package and will not install the package
globally</p>
<h3 id="popluar-options-to-get-setup-reactjs"><a class="header" href="#popluar-options-to-get-setup-reactjs">Popluar options to get setup ReactJS</a></h3>
<ul>
<li>Vite (Pronounced as Veet) [https://create-react-app.dev/docs/getting-started]</li>
<li>create-react-app [https://vitejs.dev/]</li>
</ul>
<p><b>Snippet to setup react with create-react-app</b></p>
<p>Will craete a folder a named myapp</p>
<pre><code class="language-sh">npx create-react-app myapp
cd myapp
npm audit fix --force
</code></pre>
<h3 id="what-is-webpack"><a class="header" href="#what-is-webpack">What is webpack?</a></h3>
<p>Webpack is a tool that helps developers bundle and manage their JavaScript code.
It takes all the different files (assets,scripts,iamges) and dependencies in a project and combines them into a single file,
making it easier to load and run in a web browser. It also optimizes the code by removing
any unnecessary parts.</p>
<h3 id="what-is-babel"><a class="header" href="#what-is-babel">What is Babel?</a></h3>
<p>Babel is a JavaScript compiler
Babel is a tool that helps developers write modern
JavaScript code and convert it into a version that can
be understood by older browsers.</p>
<h3 id="babel-vs-webpack"><a class="header" href="#babel-vs-webpack">Babel vs Webpack</a></h3>
<p>Babel helps with making modern JavaScript code compatible with older browsers,
while webpack is a tool for bundling and managing JavaScript code
for web development</p>
<h3 id="folder-structure"><a class="header" href="#folder-structure">Folder Structure</a></h3>
<ul>
<li>
<p><strong>node_modules</strong> : Contains all dependencies required by our app.</p>
</li>
<li>
<p><strong>public</strong> : Contains static assests including index.html</p>
<pre><code> index.html
    - title
    - fonts
    - css
    - favicon
    - id="root" - our entire app
</code></pre>
</li>
<li>
<p><strong>src</strong> : Contains all our javascript files . We do all our work here.
Brain of our app.src/index.js is the JavaScript entry point.</p>
</li>
<li>
<p><strong>package.json</strong> : Contains info about our projects like name,version,scripts,
dependencies</p>
</li>
<li>
<p><strong>package.json.lock</strong> : Contains a snapshot of our dependency tree. Automatically
generated when installing or updating packages in a JavaScript project.
It keeps track of the exact versions of all the dependencies
installed in the project.</p>
</li>
</ul>
<hr>
<h2 id="react-fundamentals"><a class="header" href="#react-fundamentals">React Fundamentals</a></h2>
<p><strong>export vs export default</strong></p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>export (named export)</th><th>export default</th></tr>
</thead>
<tbody>
<tr><td>Can have muliple export in a single file</td><td>Can have only single</td></tr>
<tr><td>Imported module should have the same name as the exported module</td><td>Imported module can have any name</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Boiler Plate</p>
</blockquote>
<ul>
<li>Delete the src created and recreate the folder</li>
<li>Inside src create index.js (entrypoint of our react app)</li>
</ul>
<p><strong>Rules for writing components</strong></p>
<ul>
<li>Always start name with capital letter</li>
<li>Must return JSX element.</li>
<li>Must self close the component wherever you use it you use it. <br>
Example : &lt;/Hello&gt;</li>
</ul>
<p><strong>What is JSX</strong></p>
<p>JSX stands for JavaScript XML.
JSX is a syntax extension for JavaScript that allows you to
write HTML-like code in your JavaScript files. It’s used
in popular frameworks like React and Vue.js.
JSX code is transpiled into regular JavaScript
code before being executed by the browser.</p>
<p><strong>Rules for JSX</strong></p>
<ul>
<li>
<p><strong>Must return one single parent element</strong>. Either enclose the JSX
return entire with inbuilt html tags or react Fragments.
React Fragments helps us to let’s us to group elements without
adding extra node</p>
<pre><code class="language-js">// One way
return &lt;React.Fragment&gt;...rest of the return&lt;/React.Fragment&gt;;

// Another way
return &lt;&gt;...rest of the return&lt;/&gt;;
</code></pre>
</li>
<li>
<p><strong>camelCase for defininig property names</strong></p>
</li>
</ul>
<pre><code class="language-js">return (
  &lt;div tabIndex={1}&gt;
    &lt;button onClick={myFunction}&gt;click me&lt;/button&gt;
    &lt;label htmlFor='name'&gt;Name&lt;/label&gt;
    &lt;input readOnly={true} id='name' /&gt;
  &lt;/div&gt;
)
// in html
&lt;div tabindex="1"&gt;
    &lt;button onclick="myFunction()"&gt;click me&lt;/button&gt;
    &lt;label for='name'&gt;Name&lt;/label&gt;
    &lt;input readonly id='name' /&gt;
&lt;/div&gt;
</code></pre>
<ul>
<li><strong>Close every element</strong></li>
</ul>
<p>Close every tag that does not even supports closing in HTML5</p>
<pre><code class="language-js">return &lt;img /&gt;;
// or
return &lt;input /&gt;;
</code></pre>
<ul>
<li><strong>Formatting</strong></li>
</ul>
<p>Use () to enclose return statements when returning some
nested elements.We can ignore () when returning just 1
single element.</p>
<pre><code class="language-js">function Hello() {
    return (
        &lt;&gt;
            &lt;div className="someValue"&gt;
                &lt;h3&gt;hello world&lt;/h3&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;a href="#"&gt;hello world&lt;/a&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
            &lt;h2&gt;hello world&lt;/h2&gt;
            &lt;input type="text" name="" id="" /&gt;
        &lt;/&gt;
    );
}
</code></pre>
<p><strong>Basic React APP</strong></p>
<blockquote>
<p>index.js</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom/client';

const Hello = () =&gt; {
    return &lt;h1&gt;Hello World&lt;/h1&gt;;
};

const root = ReactDOM.createRoot(document.getElementById('root'));

root.render(&lt;Hello /&gt;);
</code></pre>
<p><strong>Create element in react</strong></p>
<blockquote>
<p>Using JSX is easier to read than using react’s createElement</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom/client';

// With JSX
const Hello = () =&gt; {
    return &lt;h1&gt;Hello&lt;/h1&gt;;
};

// With React craete element
const Hello = () =&gt; {
    return React.createElement('h1', {}, 'Hello');
};

// Nested React createElement
const Hello = () =&gt; {
    return React.createElement(
        'div',
        {},
        React.createElement('h1', {}, 'Hello')
    );
};

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(&lt;Hello /&gt;);
</code></pre>
<hr>
<h3 id="simple-booklist-app"><a class="header" href="#simple-booklist-app">Simple Booklist App</a></h3>
<ul>
<li><strong>1. First Steps</strong></li>
</ul>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom/client';

// Booklist
const Booklist = () =&gt; {
    return (
        &lt;&gt;
            &lt;Book /&gt;
            &lt;Book /&gt;
            &lt;Book /&gt;
        &lt;/&gt;
    );
};

// Book
const Book = () =&gt; {
    return (
        &lt;&gt;
            &lt;Image /&gt;
            &lt;Title /&gt;
            &lt;Author /&gt;
        &lt;/&gt;
    );
};

// Items in Book
const Image = () =&gt; {
    return (
        &lt;img
            src="https://m.media-amazon.com/images/I/51TrWpIwMfL.jpg"
            alt="IMG"
        /&gt;
    );
};

const Title = () =&gt; {
    return &lt;h3&gt;David Copperfield&lt;/h3&gt;;
};

const Author = () =&gt; {
    return &lt;p&gt;Charles Dickens&lt;/p&gt;;
};

// Render
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(&lt;Booklist /&gt;);
</code></pre>
<ul>
<li><strong>2. Adding CSS</strong></li>
</ul>
<p>Create an index.css in src</p>
<blockquote>
<p>index.css</p>
</blockquote>
<pre><code class="language-css">/* Reset CSS */

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family:
        system-ui,
        -apple-system,
        BlinkMacSystemFont,
        'Segoe UI',
        Roboto,
        Oxygen,
        Ubuntu,
        Cantarell,
        'Open Sans',
        'Helvetica Neue',
        sans-serif;
    background: #f1f5f8;
    color: #222;
}

/* CSS */

.booklist {
    width: 90vw;
    max-width: 1170px;
    margin: 3rem 3rem;
    display: grid;
    gap: 2rem;
}

.book {
    background: #fff;
    border-radius: 1rem;
    padding: 2rem;
    text-align: center;
}
.book img {
    width: 100%;
    object-fit: cover;
}
.book h3 {
    margin-top: 1rem;
    font-size: 1rem;
}

/* Media Query */

@media screen and (min-width: 768px) {
    .booklist {
        grid-template-columns: repeat(3, 1fr);
    }
}
</code></pre>
<blockquote>
<p>index.js</p>
</blockquote>
<p>Import the css by mentioning the path at the top of js file</p>
<pre><code class="language-js">import './index.css';
</code></pre>
<h3 id="local-images"><a class="header" href="#local-images">Local Images</a></h3>
<ul>
<li>
<p>local images (public folder) - less performant</p>
</li>
<li>
<p>local images (src folder) - better solution for assets, since under the hood they get optimized.</p>
</li>
</ul>
<p>Note :<b> Whenever using public folder images and writing an URL,
Imagine that u are in public folder and write the image path as
below.I Know its not logical why ./ is used but assume you are
in public folder.You can type in the browser the url
http://localhost:3000/images/&lt;imgname.ext&gt; and see the image will
appear that you have placed in the public/image folder.</b></p>
<pre><code class="language-js">const Image = () =&gt; (
    &lt;img
        src="./images/book-1.jpg"
        alt="Interesting Facts For Curious Minds"
        alt="IMG"
    /&gt;
);
</code></pre>
<h3 id="jsx-css"><a class="header" href="#jsx-css">JSX CSS</a></h3>
<ul>
<li>{} in JSX means going back to JS Land</li>
<li>value is an object with key/value pairs - capitalized and with ‘’</li>
<li>property names should be in camel case</li>
</ul>
<blockquote>
<p>Example (Inline CSS)</p>
</blockquote>
<pre><code class="language-js">const Author = () =&gt; (
    &lt;h4 style={{ color: '#617d98', fontSize: '0.75rem', marginTop: '0.5rem' }}&gt;
        Jordan Moore
    &lt;/h4&gt;
);
</code></pre>
<blockquote>
<p>Alternative option using variables</p>
</blockquote>
<pre><code class="language-js">const Author = () =&gt; {
    const inlineHeadingStyles = {
        color: '#617d98',
        fontSize: '0.75rem',
        marginTop: '0.5rem'
    };
    return &lt;h4 style={inlineHeadingStyles}&gt;Jordan Moore &lt;/h4&gt;;
};
</code></pre>
<h3 id="jsx-js"><a class="header" href="#jsx-js">JSX JS</a></h3>
<ul>
<li>{} in JSX means going back to JS Land</li>
<li>value inside must be an expression (return value), can’t be a statement</li>
</ul>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';

// Booklist
const Booklist = () =&gt; {
    return (
        &lt;section className="booklist"&gt;
            &lt;Book /&gt;
            &lt;Book /&gt;
            &lt;Book /&gt;
        &lt;/section&gt;
    );
};

// Book
const author = 'Charles Dickens'; // variable can be outside
const Book = () =&gt; {
    const title = 'David Copperfield'; // variable can be inside
    return (
        &lt;article className="book"&gt;
            &lt;img
                src="https://m.media-amazon.com/images/I/51TrWpIwMfL.jpg"
                alt="IMG"
            /&gt;
            &lt;h3&gt;{title}&lt;/h3&gt;
            &lt;p&gt;{author.toUpperCase()}&lt;/p&gt;
            {/* &lt;p&gt;{let x = 6}&lt;/p&gt; */}
            &lt;p&gt;${6 + 6}&lt;/p&gt;
        &lt;/article&gt;
    );
};

// Render
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(&lt;Booklist /&gt;);
</code></pre>
<h3 id="props-basics"><a class="header" href="#props-basics">Props Basics</a></h3>
<ul>
<li>Props, short for properties, are a way to pass data from one component to another in React.</li>
<li>Props can be named anything like xyz</li>
</ul>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';

const author = 'Charles Dickens';
const title = 'David Copperfield';
const img = 'https://m.media-amazon.com/images/I/51TrWpIwMfL.jpg';

// Booklist
const Booklist = () =&gt; {
    return (
        &lt;section className="booklist"&gt;
            &lt;Book img={img} title={title} author={author} /&gt;
            &lt;Book img={img} title={title} author={author} /&gt;
        &lt;/section&gt;
    );
};

// Book [Destructuring inside body]

const Book = (props) =&gt; {
    const { img, title, author } = props;
    return (
        &lt;article className="book"&gt;
            &lt;img src={img} alt={title} /&gt;
            &lt;h3&gt;{title}&lt;/h3&gt;
            &lt;p&gt;{author.toUpperCase()}&lt;/p&gt;
        &lt;/article&gt;
    );
};

// Book [Destructuring in the parameter itself]
const Book = ({ img, title, author }) =&gt; {
    return (
        &lt;article className="book"&gt;
            &lt;img src={img} alt={title} /&gt;
            &lt;h3&gt;{title}&lt;/h3&gt;
            &lt;p&gt;{author.toUpperCase()}&lt;/p&gt;
        &lt;/article&gt;
    );
};

// Render
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(&lt;Booklist /&gt;);
</code></pre>
<h3 id="children-props"><a class="header" href="#children-props">Children props</a></h3>
<ul>
<li>everything we render between component tags</li>
<li>mostly use it in Context API</li>
<li>special prop, has to be named “children”</li>
<li>can place anywhere in JSX</li>
</ul>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';

const author = 'Charles Dickens';
const title = 'David Copperfield';
const img = 'https://m.media-amazon.com/images/I/51TrWpIwMfL.jpg';

// Booklist
const Booklist = () =&gt; {
    return (
        &lt;section className="booklist"&gt;
            &lt;Book img={img} title={title} author={author}&gt;
                &lt;p&gt;
                    Lorem ipsum dolor sit amet, consectetur adipisicing elit.
                    Eligendi, repellat.
                &lt;/p&gt;
                &lt;button type="button"&gt;click me&lt;/button&gt;
            &lt;/Book&gt;
            &lt;Book img={img} title={title} author={author} /&gt;
        &lt;/section&gt;
    );
};

// Book
const Book = ({ img, title, author, children }) =&gt; {
    return (
        &lt;article className="book"&gt;
            &lt;img src={img} alt={title} /&gt;
            &lt;h3&gt;{title}&lt;/h3&gt;
            &lt;p&gt;{author.toUpperCase()}&lt;/p&gt;
            {children}
        &lt;/article&gt;
    );
};

// Render
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(&lt;Booklist /&gt;);
</code></pre>
<h3 id="simple-list"><a class="header" href="#simple-list">Simple List</a></h3>
<p>Note : <strong>map - creates a new array from calling a function for every array element.</strong> <br /></p>
<p>Note: <strong>Use Keyprop to assign unique value.The key prop in React is used to uniquely identify
each element in a list of elements that have the same type. This is necessary because React
needs a way to keep track of which elements have changed so that it can efficiently update the UI.</strong></p>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';

const data = [
    {
        author: 'Charles Dickens',
        title: 'David Copperfield',
        img: 'https://m.media-amazon.com/images/I/51TrWpIwMfL.jpg',
        id: 1
    },
    {
        author: 'Charles Dickens',
        title: 'Oliver Twist',
        img: 'https://m.media-amazon.com/images/I/81QGqaKWjXL._AC_UF1000,1000_QL80_.jpg',
        id: 2
    }
];

// const obj = {
//     author: 'Charles Dickens',
//     title: 'Oliver Twist',
//     img: 'https://m.media-amazon.com/images/I/81QGqaKWjXL._AC_UF1000,1000_QL80_.jpg'
// };

const Booklist = () =&gt; {
    return (
        &lt;&gt;
            &lt;section className="booklist"&gt;
                {data.map(({ author, title, img }, index) =&gt; {
                    return (
                        &lt;Book
                            author={author}
                            title={title}
                            img={img}
                            key={index}
                        /&gt;
                    );
                })}
            &lt;/section&gt;
        &lt;/&gt;
    );
};

const Book = (props) =&gt; {
    const { author, title, img } = props;
    return (
        &lt;article className="book"&gt;
            &lt;img src={img} alt={title} /&gt;
            &lt;h3&gt;{title}&lt;/h3&gt;
            &lt;p&gt;{author}&lt;/p&gt;
        &lt;/article&gt;
    );
};

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(&lt;Booklist /&gt;);
</code></pre>
<h3 id="spread-operator"><a class="header" href="#spread-operator">Spread Operator</a></h3>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';

const data = [
    {
        author: 'Charles Dickens',
        title: 'David Copperfield',
        img: 'https://m.media-amazon.com/images/I/51TrWpIwMfL.jpg',
        id: 1
    },
    {
        author: 'Charles Dickens',
        title: 'Oliver Twist',
        img: 'https://m.media-amazon.com/images/I/81QGqaKWjXL._AC_UF1000,1000_QL80_.jpg',
        id: 2
    }
];

const Booklist = () =&gt; {
    return (
        &lt;&gt;
            &lt;section className="booklist"&gt;
                {data.map((book, index) =&gt; {
                    return &lt;Book {...book} key={index} /&gt;;
                })}
            &lt;/section&gt;
        &lt;/&gt;
    );
};

const Book = (props) =&gt; {
    const { author, title, img } = props;
    return (
        &lt;article className="book"&gt;
            &lt;img src={img} alt={title} /&gt;
            &lt;h3&gt;{title}&lt;/h3&gt;
            &lt;p&gt;{author}&lt;/p&gt;
        &lt;/article&gt;
    );
};

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(&lt;Booklist /&gt;);
</code></pre>
<h3 id="event-basics"><a class="header" href="#event-basics">Event Basics</a></h3>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';

const Booklist = () =&gt; {
    return (
        &lt;&gt;
            &lt;section className="booklist"&gt;
                &lt;EventBasics /&gt;
            &lt;/section&gt;
        &lt;/&gt;
    );
};

// e can be any name , e signifies event , every event handler function (like onClick,onSubmit) has access to event object
const handleSubmit = (e) =&gt; {
    e.preventDefault();
    console.log('submit');
    console.log(e);
};

const handleClick = (e) =&gt; {
    console.log('click');
};
const handleChange = (e) =&gt; {
    console.log('change');
    console.log(e);
    console.log(e.target.value);
    console.log(e.target.name);
};

// Arrow Functions too have access to event object
const EventBasics = () =&gt; {
    return (
        &lt;form onSubmit={handleSubmit}&gt;
            &lt;input type="text" name="txt" onChange={handleChange} /&gt;
            &lt;br /&gt;
            &lt;button
                type="button"
                onClick={(e) =&gt; {
                    console.log(e);
                }}
            &gt;
                Submit
            &lt;/button&gt;
        &lt;/form&gt;
    );
};

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(&lt;Booklist /&gt;);
</code></pre>
<h3 id="prop-drilling"><a class="header" href="#prop-drilling">Prop Drilling</a></h3>
<ul>
<li>react data flow - can only pass props down from parent component to child</li>
<li>alternatives Context API, redux, other state libraries</li>
</ul>
<h3 id="drilling-by-passing-a-function-down"><a class="header" href="#drilling-by-passing-a-function-down">Drilling by passing a function down</a></h3>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom/client';
import './index.css';

const data = [
    {
        author: 'Charles Dickens',
        title: 'David Copperfield',
        img: 'https://m.media-amazon.com/images/I/51TrWpIwMfL.jpg',
        id: 1
    },
    {
        author: 'Charles Dickens',
        title: 'Oliver Twist',
        img: 'https://m.media-amazon.com/images/I/81QGqaKWjXL._AC_UF1000,1000_QL80_.jpg',
        id: 2
    }
];

const Booklist = () =&gt; {
    const getBook = (id) =&gt; {
        const k = data.filter((item) =&gt; item.id == id);
        return k;
    };
    return (
        &lt;&gt;
            &lt;section className="booklist"&gt;
                {data.map((book, index) =&gt; {
                    return (
                        &lt;Book
                            newitem="sd"
                            {...book}
                            key={index}
                            getBook={getBook}
                        /&gt;
                    );
                })}
            &lt;/section&gt;
        &lt;/&gt;
    );
};

const Book = (props) =&gt; {
    // console.log(props);
    const { author, title, img, id, getBook } = props;
    return (
        &lt;article className="book"&gt;
            &lt;img src={img} alt={title} /&gt;
            &lt;h3&gt;{title}&lt;/h3&gt;
            &lt;p&gt;{author}&lt;/p&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    console.log(getBook(id));
                }}
            &gt;
                click
            &lt;/button&gt;
        &lt;/article&gt;
    );
};

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(&lt;Booklist /&gt;);
</code></pre>
<h3 id="local-images-src"><a class="header" href="#local-images-src">Local Images (src)</a></h3>
<ul>
<li>better performance because optimized</li>
</ul>
<pre><code class="language-js">import img1 from './images/book-1.jpg';
import img2 from './images/book-2.jpg';
import img3 from './images/book-3.jpg';
</code></pre>
<h3 id="vite-setup"><a class="header" href="#vite-setup">Vite Setup</a></h3>
<ul>
<li>need to use .jsx extension</li>
<li>index.html in the source instead of public</li>
<li>assets still in public</li>
<li>instead of index.js, need to use main.jsx</li>
<li>to spin up dev server - “npm run dev”</li>
<li>rest the same - imports/exports, deployment, assets, etc…</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="react-ii"><a class="header" href="#react-ii">React II</a></h1>
<p><strong>Note : When a state value changes in a React component, the component will
re-render to reflect the new changes. This includes both unmounting
and mounting the component.</strong></p>
<h3 id="react-hooks"><a class="header" href="#react-hooks">React Hooks</a></h3>
<h4 id="usestate"><a class="header" href="#usestate">useState</a></h4>
<p>It returns an array with 2 elements first element is the current
state value and second element is the function to update the state.</p>
<p>State is used to store and manage data that can change over time,
such as user input, API responses, or the current state of a component.</p>
<p>Note : <strong>We need to use state to trigger re-render ,otherwise
suppose we are doing the samething using pure js we had to
come up with our own logic to trigger re-render.</strong></p>
<blockquote>
<p>Triggering re-render manually using vanilla js</p>
</blockquote>
<pre><code class="language-js">const App = () =&gt; {
    let count = 0;

    const handleClick = () =&gt; {
        count += 1;
        console.log(count);
        let k = document.getElementById('changeme');
        k.innerHTML = `${count}`;
    };
    return (
        &lt;&gt;
            &lt;h1 id="changeme"&gt;{count}&lt;/h1&gt;
            &lt;button type="button" onClick={handleClick}&gt;
                click
            &lt;/button&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>Basic useState example using counter</p>
</blockquote>
<pre><code class="language-js">import { useState } from 'react';

const App = () =&gt; {
    const [count, setCount] = useState(0);
    const handleClick = () =&gt; {
        // We trigger re-render on updates and value is preserved
        setCount((c) =&gt; c + 1); // Can pass any values and any name
    };

    return (
        &lt;&gt;
            &lt;h1&gt;{count}&lt;/h1&gt;
            &lt;button type="button" onClick={handleClick}&gt;
                click
            &lt;/button&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<p><strong>Intial render and re-render</strong></p>
<ul>
<li>
<p>In a React application, the initial render is the first
time that the component tree is rendered to the DOM. It
happens when the application first loads, or when the root
component is first rendered. This is also known as
“mounting” the components.</p>
</li>
<li>
<p>Re-renders, on the other hand, happen when the component’s
state or props change, and the component needs to be
updated in the DOM to reflect these changes. React uses a
virtual DOM to optimize the process of updating the actual
DOM, so that only the necessary changes are made.</p>
</li>
</ul>
<p>There are a few ways that you can trigger a re-render in a
React component:</p>
<ul>
<li>
<p>By changing the component’s state or props. When the
component’s state or props change, React will re-render
the component to reflect these changes.</p>
</li>
<li>
<p>When the parent element re-renders, even if the
component’s state or props have not changed.</p>
</li>
</ul>
<p><strong>Hooks rules</strong></p>
<ul>
<li><strong>starts with “use” (both custom and react inbuilt hooks)</strong></li>
<li><strong>must be invoked inside a component</strong></li>
<li><strong>dont call hooks conditionally</strong></li>
<li><strong>set function do not update immediately. Do not expect synchronous behaviour.</strong>
<strong>use the count function above log the value in handleClick function to verify.</strong></li>
</ul>
<blockquote>
<p>Basic array clearAll and clearOne example with useState</p>
</blockquote>
<pre><code class="language-js">import { useState } from 'react';

const App = () =&gt; {
    const data = [
        { name: 'abc', id: 1 },
        { name: 'def', id: 2 },
        { name: 'hello', id: 3 }
    ];
    const [people, setPeople] = useState(data);

    const clearAll = () =&gt; {
        setPeople([]);
    };
    const clearOne = (id) =&gt; {
        const newData = people.filter((p) =&gt; {
            return p.id != id;
        });

        setPeople(newData);
    };

    return (
        &lt;&gt;
            {people.map(({ name, id }, idx) =&gt; {
                return (
                    &lt;div key={id}&gt;
                        &lt;h1&gt;{name}&lt;/h1&gt;
                        &lt;button
                            type="button"
                            onClick={() =&gt; {
                                clearOne(id);
                            }}
                        &gt;
                            Delete
                        &lt;/button&gt;
                    &lt;/div&gt;
                );
            })}
            &lt;br /&gt;
            &lt;button type="button" onClick={clearAll}&gt;
                Delete all
            &lt;/button&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h4 id="automatic-batching"><a class="header" href="#automatic-batching">Automatic Batching</a></h4>
<p>In React, “batching” refers to the process of grouping
multiple state updates into a single update. This can be
useful in certain cases because it allows React to
optimize the rendering of your components by minimizing
the number of DOM updates that it has to perform.</p>
<p>By default, React uses a technique called “auto-batching”
to group state updates that occur within the same event
loop into a single update. This means that if you call the
state update function multiple times in a short period of
time, React will only perform a single re-render for all
of the updates.</p>
<p>React v18 ensures that state updates invoked from any
location will be batched by default. This will batch state
updates, including native event handlers, asynchronous
operations, timeouts, and intervals.</p>
<h4 id="cyclic-behaviour-with-objects"><a class="header" href="#cyclic-behaviour-with-objects">Cyclic behaviour with objects</a></h4>
<pre><code class="language-js">import { useState } from 'react';

const App = () =&gt; {
    const data = [
        { name: 'abc', id: 1 },
        { name: 'def', id: 2 },
        { name: 'hello', id: 3 }
    ];
    const [idx, setIdx] = useState(0);
    const [people, setPeople] = useState(data[idx]);

    const length = data.length;

    return (
        &lt;div&gt;
            &lt;h1&gt;{people.name}&lt;/h1&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    let newIdx = (idx + 1) % length;
                    setIdx(newIdx);
                    setPeople(data[newIdx]);
                }}
            &gt;
                Show {data[(idx + 1) % length].name}
            &lt;/button&gt;
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<h4 id="getting-old-values"><a class="header" href="#getting-old-values">Getting old values</a></h4>
<ul>
<li>By default react will grab old values and increase it by 1 in
the setTimeout function. Because in the 3 seconds timespan the
setvalue function is still referencing the old value i.e. 0
so to fix it we use a callback.We typically use this callback
if we have some functionality which dependes on latest value.
To simulate that synchronous beahviour we do as it is below.
To preserve the value we use the callback , the value does not
gets preserved if no callback is used.</li>
</ul>
<ul>
<li>The reason why in your code the log function logs an outdated value is
because of closure - the count value is a const, and it is set when
the component is first rendered. So when you click the button, the value
of count is not the new value, but the one it was when it was
first rendered (i.e. -&gt; always going to be one less than you expect).</li>
</ul>
<p><strong>[When inside function it will have the same value as it had in its first render]</strong><br />
<strong>Refer closures</strong>
<a href="https://github.com/facebook/react/issues/14010">Issue</a></p>
<ul>
<li>In this code, log happens on every re-render. Since clicking the button
calls setCount, the state changes, and a re-render occurs. When that
happens, the log is executed, and you get the latest value</li>
</ul>
<p><strong>React hooks do not update value immediately</strong></p>
<p>React hooks do not update values immediately because of the way they are designed
to work. When a state value is updated using hooks, React schedules a
re-render of the component. During this re-render, the updated value
is applied to the component and any subsequent code that
relies on the updated value is executed.
If you need to perform some action immediately after a state update,
you can use the useEffect hook to run side effects after the
component has rendered with the updated values.</p>
<blockquote>
<p>fixed</p>
</blockquote>
<pre><code class="language-js">import { useState, useEffect } from 'react';

const App = () =&gt; {
    const [count, setCount] = useState(0);
    const handleCLick = () =&gt; {
        setCount((oldval) =&gt; oldval + 1); // this will work and get the latest value
        console.log(count); // will not work still
    };
    console.log(count); // will work
    return (
        &lt;&gt;
            &lt;div&gt;
                &lt;h1&gt;{count}&lt;/h1&gt;
                &lt;button type="button" onClick={handleCLick}&gt;
                    click
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>Example with setTimeout</p>
</blockquote>
<pre><code class="language-js">import { useState } from 'react';

const App = () =&gt; {
    const [count, setCount] = useState(0);

    const handleClick = () =&gt; {
        setTimeout(() =&gt; {
            // will reference old value
            // setCount(count + 1);

            // will reference latest value and preserve value between renders
            // must use return statement
            setCount(oldval =&gt;
                oldval + 1;
            );
        }, 3000);
    };

    return (
        &lt;&gt;
            &lt;h1&gt;{count}&lt;/h1&gt;
            &lt;button type="button" onClick={handleClick}&gt;
                click
            &lt;/button&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h4 id="useeffect"><a class="header" href="#useeffect">useEffect</a></h4>
<p>useEffect is a hook in React that allows you to perform side
effects in function components.There is no need for urban
dictionary - basically any work outside of the component. Some</p>
<p>Its a way of telling react what to do on component re-render.
Perform side-effects i.e actions that occur outside the DOM.
examples of side effects are: subscriptions, fetching data,
directly updating the DOM, re-registering and de-registering
event listeners, timers, etc.</p>
<p>Note : <strong>If you a noramal JS function and calling it inside a component
it will re-run after every re-render</strong></p>
<pre><code class="language-js">import { useState, useEffect } from 'react';

const App = () =&gt; {
    const [count, setCount] = useState(0);
    const handleCLick = () =&gt; {
        setCount((oldval) =&gt; oldval + 1);
        console.log(count);
    };

    const hello = () =&gt; {
        console.log('hello');
        //setCount(count + 1); // cause inifinite re-reender
    };

    // will get called after re-renders
    hello();

    return (
        &lt;&gt;
            &lt;div&gt;
                &lt;h1&gt;{count}&lt;/h1&gt;
                &lt;button type="button" onClick={handleCLick}&gt;
                    click
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<ul>
<li>accepts two arguments (second optional)</li>
<li>first argument - callback function</li>
<li>second argument — dependency array</li>
<li><strong>by default runs on each render (initial and re-render)
cb can’t return promise (so can’t make it async)</strong></li>
<li><strong>dont make the callback of useEffect async ever</strong></li>
<li>if dependency array empty [I runs only on initial render]</li>
</ul>
<blockquote>
<p>Why use it</p>
</blockquote>
<p>useEffect is used in React to perform side effects in functional components. Side effects
are actions that occur outside of the component, such as fetching data from
an API, subscribing to events, or manipulating the DOM.</p>
<p>The useEffect hook allows you to specify a function that will be
executed after every render of the component. This function can perform any
necessary side effects. It can also return a cleanup function that will be
executed before the component is unmounted or before the next render.</p>
<p>By using useEffect, you can ensure that side effects are only performed when
necessary and avoid unnecessary re-renders. It helps to keep the component’s
logic organized and separate from the rendering logic.</p>
<blockquote>
<p>Why useEffect runs twice {You will see this behaviour while fetching and logging data from API}?</p>
</blockquote>
<ul>
<li>component appears more than once in a page</li>
<li>somehting higher up the tree is unmounting and remounting</li>
<li>reaact strictmode is on</li>
</ul>
<blockquote>
<p>useEffect fetch data from an API</p>
</blockquote>
<pre><code class="language-js">import { useState, useEffect } from 'react';

const App = () =&gt; {
    const URL = 'https://api.github.com/users';
    const [people, setPeople] = useState([]);

    useEffect(() =&gt; {
        const getData = async () =&gt; {
            const data = await fetch(URL);
            const resp = await data.json();
            return resp;
        };

        getData().then((data) =&gt; {
            console.log(data);
            setPeople(data);
        });
    }, []);

    return (
        &lt;&gt;
            &lt;div&gt;
                {people.map(({ login, avatar_url }, idx) =&gt; {
                    return (
                        &lt;div key={idx}&gt;
                            &lt;img src={avatar_url} alt={login} width={'100px'} /&gt;
                            &lt;h1 key={idx}&gt;{login}&lt;/h1&gt;
                        &lt;/div&gt;
                    );
                })}
            &lt;/div&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h3 id="multiple-returns"><a class="header" href="#multiple-returns">Multiple returns</a></h3>
<pre><code class="language-js">import { useEffect, useState } from 'react';

const App = () =&gt; {
    const URL = 'https://api.github.com/users/QuincyLarson';
    const [iserror, setisError] = useState(false);
    const [isloading, setisLoading] = useState(true);
    const [people, setPeople] = useState([]);

    // Making Useeffect run on initial render only otherwise it will keep hitting the api on each re-render
    useEffect(() =&gt; {
        const getData = async () =&gt; {
            try {
                const response = await fetch(URL);
                const json = await response.json();
                console.log(response);

                // By default fetch api does not take HTTP code in range of 4xx-5xx as errors
                // Instead it considers status code to be indicative of success
                if (!response.ok) {
                    setisLoading(false);
                    setisError(true);
                    return;
                }
                setPeople(json);
                setisLoading(false);
            } catch (err) {
                setisError(true);
                setisLoading(false);
            }
        };

        getData();
    }, []);

    // If is loading show loading

    if (isloading) {
        return (
            &lt;&gt;
                &lt;h1&gt;Loading ...&lt;/h1&gt;
            &lt;/&gt;
        );
    }

    // If Error show error

    if (iserror) {
        return (
            &lt;&gt;
                &lt;h1&gt;Error&lt;/h1&gt;
            &lt;/&gt;
        );
    }

    // show data

    return (
        &lt;&gt;
            &lt;h1&gt;{JSON.stringify(people, null, 8)}&lt;/h1&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h3 id="order-matters"><a class="header" href="#order-matters">Order matters</a></h3>
<ul>
<li>
<p>Order matters : We should not destructure any user properties
before getting the results.</p>
</li>
<li>
<p>Use optional chaining to spit back an empty value if not present</p>
</li>
</ul>
<h3 id="location-of-fetch-function"><a class="header" href="#location-of-fetch-function">Location of fetch function</a></h3>
<p>if we are placing the fetch function outside the Useeffect
don not place the fetch function name into the dependency
array because on re-render fetch function will be recreated
and we will encounter an inifinite loop.</p>
<h3 id="toggling-a-component-using-ternary-operator"><a class="header" href="#toggling-a-component-using-ternary-operator">Toggling a component using ternary operator</a></h3>
<pre><code class="language-js">import { useState } from 'react';

const Hello = () =&gt; {
    return &lt;h1&gt;Hello&lt;/h1&gt;;
};

const App = () =&gt; {
    const [isvisible, setIsvisible] = useState(false);
    return (
        &lt;&gt;
            {isvisible ? &lt;Hello /&gt; : ''}
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setIsvisible(!isvisible);
                }}
            &gt;
                click
            &lt;/button&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h3 id="login-logout-with-ternary"><a class="header" href="#login-logout-with-ternary">login logout with ternary</a></h3>
<pre><code class="language-js">import { useState } from 'react';

const App = () =&gt; {
    const [user, setUser] = useState(null);
    return (
        &lt;&gt;
            {user ? (
                &lt;Loggedin {...user} setUser={setUser} /&gt;
            ) : (
                &lt;Loggedout setUser={setUser} /&gt;
            )}
        &lt;/&gt;
    );
};

const Loggedin = ({ name, setUser }) =&gt; {
    return (
        &lt;&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setUser(null);
                }}
            &gt;
                Logout
            &lt;/button&gt;
            &lt;h1&gt;Hello {name}&lt;/h1&gt;
        &lt;/&gt;
    );
};

const Loggedout = ({ setUser }) =&gt; {
    return (
        &lt;&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setUser({ name: 'johndoe' });
                }}
            &gt;
                Login
            &lt;/button&gt;
            &lt;h1&gt;Logged out&lt;/h1&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h3 id="cleanup-function"><a class="header" href="#cleanup-function">Cleanup Function</a></h3>
<p>In the below code since we are re-rendering the component conditionally
what we are doing is we are mounting and unmounting the component.One
thing to note is that useEffect runs on inital render and on every
re-render.But in the below code we have setup useEffect to run
on inital load but since we are <strong>Toggling the component conditionally
we are repeating the initial render process everytime we specially mount,
as a result useEffect will executed</strong>.</p>
<blockquote>
<p>Example showing useEffect will run on remounting the components as it repeats the initial re-render process</p>
</blockquote>
<pre><code class="language-js">import { useEffect, useState } from 'react';

const Hello = () =&gt; {
    // will run everytime we remount the component as its the initial render
    useEffect(() =&gt; {
        console.log('useefect ran..');
    }, []);
    return &lt;h3&gt;hello&lt;/h3&gt;;
};

const App = () =&gt; {
    const [toggle, setisToggled] = useState(false);
    return (
        &lt;&gt;
            {toggle ? &lt;Hello /&gt; : ''}
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setisToggled(!toggle);
                }}
            &gt;
                toggle
            &lt;/button&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h3 id="cleanup-function-setinterval-example-to-tun-somehting-on-mount-and-unmount"><a class="header" href="#cleanup-function-setinterval-example-to-tun-somehting-on-mount-and-unmount">Cleanup function setInterval example to tun somehting on mount and unmount</a></h3>
<pre><code class="language-js">import { useEffect, useState } from 'react';

const Hello = () =&gt; {
    // Do not make the useEffect callback async as it expects only a function to reurn in our case its cleanup function
    useEffect(() =&gt; {
        // will run on component mount
        const id = setInterval(() =&gt; {
            console.log('useefect ran..');
        }, 1000);

        // will run on component unmount
        return () =&gt; {
            console.log('cleanup');
            clearInterval(id);
        };
    }, []);
    return &lt;h3&gt;hello&lt;/h3&gt;;
};

const App = () =&gt; {
    const [toggle, setisToggled] = useState(false);
    console.log('render');
    return (
        &lt;&gt;
            {toggle ? &lt;Hello /&gt; : ''}
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setisToggled(!toggle);
                }}
            &gt;
                toggle
            &lt;/button&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h4 id="folder-structure-and-named-export"><a class="header" href="#folder-structure-and-named-export">Folder structure and named export</a></h4>
<p>When working with react we can use index.js to group export all components needed</p>
<pre><code>   Navbar (Folder)
      - index.css
      - index.js -&gt; [import first from first;import second from second ]and then [export {first,second}]
      - first component
      - second component
</code></pre>
<p>Now from App.jsx we just now import components like<br />
<code>import {first,second} from ./Navbar</code><br />
No need to mention any file name as index.js is entrypoint</p>
<h4 id="leverage-everything-known-till-now"><a class="header" href="#leverage-everything-known-till-now">Leverage everything known till now</a></h4>
<blockquote>
<p>List.jsx [Iterates over all People]</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import Person from './Person';

const List = (props) =&gt; {
    const { data } = props;
    return (
        &lt;div&gt;
            {data.map((p, idx) =&gt; {
                return (
                    &lt;div key={idx}&gt;
                        &lt;Person {...p} /&gt;
                    &lt;/div&gt;
                );
            })}
        &lt;/div&gt;
    );
};

export default List;
</code></pre>
<blockquote>
<p>Person.jsx [Component to show only one person and details like name]</p>
</blockquote>
<p>Uses optional chaining</p>
<pre><code class="language-js">import React from 'react';

const Person = (props) =&gt; {
    // const { name, nickName } = props;
    const { level } = props;
    // const lev = level &amp;&amp; level[0] &amp;&amp; level[0].count;
    const lev = level?.[0].count || 0;

    return (
        &lt;div style={{ border: '2px solid black' }}&gt;
            &lt;h1&gt; {props.name}&lt;/h1&gt;
            &lt;p&gt; {props.nickName}&lt;/p&gt;
            &lt;p&gt; {lev}&lt;/p&gt;
        &lt;/div&gt;
    );
};

export default Person;
</code></pre>
<blockquote>
<p>App.jsx [Show the list]</p>
</blockquote>
<pre><code class="language-js">import List from './List';

const data = [
    { id: 1, name: 'bob', nickName: 'Stud Muffin' },
    { id: 2, name: 'peter', nickName: 'Hello World', level: [{ count: 3 }] }
];

const App = () =&gt; {
    return (
        &lt;&gt;
            &lt;List data={data} /&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h3 id="controlled-input"><a class="header" href="#controlled-input">Controlled Input</a></h3>
<blockquote>
<p>App.jsx [Displays the form and previous list of people]</p>
</blockquote>
<pre><code class="language-js">import { useState } from 'react';
import List from './List';

const data = [
    { id: 1, name: 'bob', nickName: 'Stud Muffin' },
    { id: 2, name: 'peter', nickName: 'Hello World', level: [{ count: 3 }] }
];

const ControlledInput = ({ setPeople, people }) =&gt; {
    const [name, setName] = useState('');
    const [nickName, setNickname] = useState('');
    return (
        &lt;&gt;
            &lt;form&gt;
                &lt;div&gt;
                    &lt;p&gt;Name&lt;/p&gt;
                    &lt;input
                        type="text"
                        name=""
                        value={name}
                        onChange={(e) =&gt; {
                            setName(e.target.value);
                        }}
                    /&gt;
                &lt;/div&gt;
                &lt;div&gt;
                    &lt;p&gt;nickName&lt;/p&gt;
                    &lt;input
                        type="text"
                        name=""
                        value={nickName}
                        onChange={(e) =&gt; {
                            setNickname(e.target.value);
                        }}
                    /&gt;
                &lt;/div&gt;
                &lt;button
                    type="button"
                    onClick={() =&gt; {
                        console.log(name);
                        console.log(nickName);
                        setPeople((people) =&gt; {
                            return [
                                ...people,
                                {
                                    name: name,
                                    nickName: nickName,
                                    id: new Date()
                                }
                            ];
                        });
                    }}
                &gt;
                    SUbmit
                &lt;/button&gt;
            &lt;/form&gt;
        &lt;/&gt;
    );
};

const App = () =&gt; {
    const [people, setPeople] = useState(data);
    return (
        &lt;&gt;
            &lt;ControlledInput setPeople={setPeople} people={people} /&gt;
            &lt;List data={people} setPeople={setPeople} people={people} /&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>List.jsx [Iterates over all people]</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import Person from './Person';

const List = (props) =&gt; {
    const { data, setPeople, people } = props;
    return (
        &lt;div&gt;
            {data.map((p, idx) =&gt; {
                return (
                    &lt;div key={idx}&gt;
                        &lt;Person {...p} setPeople={setPeople} people={people} /&gt;
                    &lt;/div&gt;
                );
            })}
        &lt;/div&gt;
    );
};

export default List;
</code></pre>
<blockquote>
<p>People.jsx [Remove functionality on click based on id]</p>
</blockquote>
<pre><code class="language-js">import React from 'react';

const Person = (props) =&gt; {
    // const { name, nickName } = props;
    const { level, setPeople, people, id } = props;
    // const lev = level &amp;&amp; level[0] &amp;&amp; level[0].count;
    const lev = level?.[0].count || 0;

    const handleRemove = () =&gt; {
        // const newData = people.filter((p) =&gt; p.id != id);
        const newData = people.filter((p) =&gt; {
            if (id != p.id) {
                return p;
            }
        });
        setPeople(newData);
    };

    return (
        &lt;div style={{ border: '2px solid black' }}&gt;
            &lt;h1&gt; {props.name}&lt;/h1&gt;
            &lt;p&gt; {props.nickName}&lt;/p&gt;
            &lt;p&gt; {lev}&lt;/p&gt;
            &lt;button type="button" onClick={handleRemove}&gt;
                Remove
            &lt;/button&gt;
        &lt;/div&gt;
    );
};

export default Person;
</code></pre>
<h3 id="multiple-inputs"><a class="header" href="#multiple-inputs">Multiple inputs</a></h3>
<p>For multiple inputs use square bracket notation to use the Javascript’s
inbuilt dynamic object key feature.</p>
<h3 id="checkbox"><a class="header" href="#checkbox">Checkbox</a></h3>
<p>To access checkbox make checked = the state value and
onChange make the e.target.checked = current state value</p>
<h3 id="select-statement-example"><a class="header" href="#select-statement-example">Select statement example</a></h3>
<pre><code class="language-js">&lt;select
    value={val}
    onChange={(e) =&gt; {
        console.log(e.target.value);
    }}
&gt;
    &lt;option&gt;1&lt;/option&gt;
    &lt;option&gt;2&lt;/option&gt;
&lt;/select&gt;
</code></pre>
<h3 id="form-data-api"><a class="header" href="#form-data-api">Form Data API</a></h3>
<blockquote>
<p>Difference b/w e.target &amp; e.currentTarget</p>
</blockquote>
<ul>
<li><strong>e.target</strong> refers to the element that triggered the event,<br /></li>
<li><strong>e.currentTarget</strong> refers to the element that the event listener is attached to.</li>
</ul>
<pre><code class="language-js">const handleSubmit = (e) =&gt; {
    e.preventDefault();

    const formData = new FormData(e.currentTarget);

    // get values one by one
    const name = formData.get('name');
    console.log(name);

    // get all of them
    const newUser = Object.fromEntries(formData);

    // do something (post request, add to list, etc)
    console.log(newUser);

    // Gotcha - re-render won't clear out the values
    setValue(value + 1);
    // reset values
    e.currentTarget.reset();
};
</code></pre>
<h4 id="useref"><a class="header" href="#useref">useRef</a></h4>
<p>useRef is a hook in React that allows you to create a
reference to a DOM element or a value that persists
across re-renders.</p>
<p>It returns a mutable ref object which contains the reference
to a particular element or value in a react component . We
can use this to modify or read the value.</p>
<p>It can be used to access and modify the properties of
a DOM element, store a value that needs to be
accessed by multiple components, or to store
a value that needs to persist between renders
without triggering a re-render.</p>
<ul>
<li>useRef does not trigger re-render</li>
<li>initial value is an object with its key as current. {current:value you have set}</li>
</ul>
<blockquote>
<p>Plain use ref example with an input</p>
</blockquote>
<pre><code class="language-js">import { useRef } from 'react';

const App = () =&gt; {
    // It is initaited in form of an object {current:null} in this case
    const refCont = useRef(null);

    const handleChange = () =&gt; {
        // It is nothing but the input element as refCont is assocaited with ref
        console.log(refCont);
    };

    return (
        &lt;div&gt;
            &lt;input
                type="text"
                name="name"
                ref={refCont}
                onChange={handleChange}
            /&gt;
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>Making useEffect not run on initial render but on value change</p>
</blockquote>
<pre><code class="language-js">import React, { useEffect, useRef, useState } from 'react';

const App = () =&gt; {
    const [val, setVal] = useState(0);
    const isMounted = useRef(false);

    useEffect(() =&gt; {
        // ran every re-render and initial render preventing
        // Clenaup -&gt; Re-render
        if (!isMounted.current) {
            isMounted.current = true;
            return;
        }
        console.log('ran useEffect');

        // unomunt test
        return () =&gt; {
            console.log('cleanup');
        };
    });

    return (
        &lt;div&gt;
            &lt;h3&gt;{val}&lt;/h3&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setVal(val + 1);
                }}
            &gt;
                click
            &lt;/button&gt;
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<h3 id="custom-hooks"><a class="header" href="#custom-hooks">Custom Hooks</a></h3>
<blockquote>
<p>useFetch.js</p>
</blockquote>
<pre><code class="language-js">import React, { useEffect, useState } from 'react';

const useFetch = (URL) =&gt; {
    const [isloading, setIsloading] = useState(true);
    const [iserror, setIserror] = useState(false);
    const [data, setData] = useState(null);

    useEffect(() =&gt; {
        const getData = async () =&gt; {
            const resp = await fetch(URL);
            if (!resp.ok) {
                setIserror(true);
                setIsloading(false);
            }
            const json = await resp.json();
            setData(json);
            setIsloading(false);
        };
        console.log('start');
        setTimeout(() =&gt; {
            getData();
        }, 3000);
        console.log('end');
    }, []);

    console.log('mid');
    return { iserror, isloading, data };
};

export default useFetch;
</code></pre>
<blockquote>
<p>App.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import useFetch from './useFetch';

const App = () =&gt; {
    const URL = 'https://api.github.com/users/QuincyLarson';

    const { isloading, iserror, data } = useFetch(URL);
    console.log(isloading); //will be called 2 times

    if (isloading) {
        return &lt;h3&gt;Loading ....&lt;/h3&gt;;
    }
    if (iserror) {
        return &lt;h3&gt;Error ....&lt;/h3&gt;;
    }

    return &lt;div&gt;{JSON.stringify(data)}&lt;/div&gt;;
};

export default App;
</code></pre>
<h3 id="context-api"><a class="header" href="#context-api">Context API</a></h3>
<ul>
<li><strong>create a context using createContext</strong></li>
<li><strong>Must wrap the component in Context.Provider</strong></li>
<li><strong>Pass any properties using the <code>value</code> prop</strong></li>
<li><strong>access the created xontext using useContext hook</strong></li>
</ul>
<blockquote>
<p>App.jsx</p>
</blockquote>
<pre><code class="language-js">import React, { createContext, useState } from 'react';
import List from './List';

export const logincontext = createContext();

const App = () =&gt; {
    const [user, setUser] = useState(null);

    const logout = () =&gt; {
        setUser(null);
    };

    const login = (name) =&gt; {
        setUser(name);
    };

    const data = [{ name: 'abc' }, { name: 'def' }, { name: 'ghi' }];

    return (
        &lt;div&gt;
            {user ? (
                &lt;&gt;
                    &lt;h3&gt;Hello {user}&lt;/h3&gt;
                    &lt;button
                        type="button"
                        onClick={() =&gt; {
                            logout();
                        }}
                    &gt;
                        Logout
                    &lt;/button&gt;
                &lt;/&gt;
            ) : (
                &lt;&gt;
                    &lt;h3&gt;Not logged in&lt;/h3&gt;
                &lt;/&gt;
            )}
            &lt;logincontext.Provider value={{ login }}&gt;
                &lt;List data={data} /&gt;
            &lt;/logincontext.Provider&gt;
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>List.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import Person from './Person';

const List = ({ data }) =&gt; {
    return (
        &lt;&gt;
            {data.map((p, idx) =&gt; {
                return (
                    &lt;div key={idx}&gt;
                        &lt;div&gt;
                            &lt;Person name={p.name} /&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                );
            })}
        &lt;/&gt;
    );
};

export default List;
</code></pre>
<blockquote>
<p>Person.jsx</p>
</blockquote>
<pre><code class="language-js">import React, { useContext } from 'react';
import { logincontext } from './App';

const Person = ({ name }) =&gt; {
    const { login } = useContext(logincontext);

    return (
        &lt;div&gt;
            &lt;h3&gt;{name}&lt;/h3&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    login(name);
                }}
            &gt;
                Login
            &lt;/button&gt;
        &lt;/div&gt;
    );
};

export default Person;
</code></pre>
<h3 id="global-context"><a class="header" href="#global-context">Global Context</a></h3>
<ul>
<li>in src create context.jsx</li>
<li>setup a global context - GlobalContext</li>
<li>setup a component (AppContext) with one state value</li>
<li>return GlobalContext.Provider from AppContext</li>
<li>wrap then entire application (main.jsx) - children prop “gotcha”</li>
<li>setup a custom hook</li>
<li>access in App.jsx</li>
<li>log result</li>
</ul>
<h3 id="reducer"><a class="header" href="#reducer">Reducer</a></h3>
<blockquote>
<p>Structure of inbuilt reducer</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { useReducer } from 'react';

const data = [{ name: 'abc' }, { name: 'def' }, { name: 'ghi' }];

// Initial State
const defState = {
    people: data
};

// Reducer Function [Must return a state]
// Has access to current state,and action
const reducer = (state, action) =&gt; {
    return state;
};

const App = () =&gt; {
    // dispatch({type:"action-name",payload:"abc"})
    // state-&gt;current state
    const [state, dispatch] = useReducer(reducer, defState);

    return &lt;div&gt;App&lt;/div&gt;;
};

export default App;
</code></pre>
<blockquote>
<p>useReducer basics</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { useReducer } from 'react';

const data = [
    { name: 'abc', id: 1 },
    { name: 'def', id: 2 },
    { name: 'ghi', id: 3 }
];

const CLEAR_ALL = 'clear-all';
const REMOVE_ITEM = 'remove-item';
const RESET_LIST = 'reset-list';

// Initial State
const defState = {
    people: data
};

// Reducer Function [Must return a state]
// Has access to current state,and action
const reducer = (state, action) =&gt; {
    // Remove a single Person
    if (action.type === REMOVE_ITEM) {
        const newState = state.people.filter((p) =&gt; p.id != action.payload);
        console.log(newState);
        return { ...state, people: newState };
    }
    // Remove all
    else if (action.type === CLEAR_ALL) {
        return { ...state, people: [] };
    }
    // Reset List
    else if (action.type === RESET_LIST) {
        return { ...state, people: data };
    }
    return state;
};

const App = () =&gt; {
    // dispatch({type:"action",payload:"abc"})
    // state-&gt;current state
    const [state, dispatch] = useReducer(reducer, defState);
    console.log(state);

    return (
        &lt;div&gt;
            {state.people.map(({ name, id }, idx) =&gt; {
                return (
                    &lt;div key={idx}&gt;
                        &lt;h3&gt;{name}&lt;/h3&gt;
                        &lt;button
                            type="button"
                            onClick={() =&gt; {
                                dispatch({ type: REMOVE_ITEM, payload: id });
                            }}
                        &gt;
                            Remove Item
                        &lt;/button&gt;
                    &lt;/div&gt;
                );
            })}
            &lt;br /&gt;
            &lt;div&gt;
                &lt;button
                    type="button"
                    onClick={() =&gt; {
                        dispatch({ type: CLEAR_ALL });
                    }}
                &gt;
                    Clear All
                &lt;/button&gt;
                &lt;br /&gt;
                &lt;button
                    type="button"
                    onClick={() =&gt; {
                        dispatch({ type: RESET_LIST });
                    }}
                &gt;
                    Rest List
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<h3 id="performance"><a class="header" href="#performance">Performance</a></h3>
<p>When Component Re-Renders :</p>
<ul>
<li>
<p>When the component’s state or props change, React will re-render the component to reflect these changes.</p>
</li>
<li>
<p>When the parent element re-renders, even if the component’s state or props have not changed.</p>
</li>
</ul>
<p>If u take the below example the Counter componet fixes the issue of re-rendering everytime
ofthe Childnest component on parent component state change . Because re-renders the child
component if the parent re-renders.</p>
<blockquote>
<p>Parent.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { useState } from 'react';
import Child from './Child';
import Counter from './Counter';

const data = [
    { name: 'abc', id: 1 },
    { name: 'def', id: 2 },
    { name: 'ghi', id: 3 }
];

// Triggers re-renders of the Childnest component on state change of the count variable

// const Parent = () =&gt; {
// const [count, setCount] = useState(0);
//     return (
//         &lt;div&gt;
//             &lt;h1&gt;Count :{count}&lt;/h1&gt;
//             &lt;button
//                 type="button"
//                 onClick={() =&gt; {
//                     setCount(count + 1);
//                 }}
//             &gt;
//                 Click
//             &lt;/button&gt;
//             &lt;Child data={data} /&gt;
//         &lt;/div&gt;
//     );
// };

// Issue fixed on movinf the state variable to another component

const Parent = () =&gt; {
    return (
        &lt;div&gt;
            &lt;Counter /&gt;
            &lt;Child data={data} /&gt;
        &lt;/div&gt;
    );
};

export default Parent;
</code></pre>
<blockquote>
<p>Child.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import Childnest from './Childnest';

const Child = ({ data }) =&gt; {
    return (
        &lt;div&gt;
            {data.map(({ name }, idx) =&gt; {
                return (
                    &lt;div key={idx}&gt;
                        &lt;Childnest name={name} /&gt;
                    &lt;/div&gt;
                );
            })}
        &lt;/div&gt;
    );
};

export default Child;
</code></pre>
<blockquote>
<p>Childnest.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';

const Childnest = ({ name }) =&gt; {
    console.log('render');
    return &lt;div&gt;{name}&lt;/div&gt;;
};

export default Childnest;
</code></pre>
<blockquote>
<p>Counter.jsx</p>
</blockquote>
<pre><code class="language-js">import React, { useState } from 'react';

const Counter = () =&gt; {
    const [count, setCount] = useState(0);
    return (
        &lt;&gt;
            &lt;h1&gt;Count :{count}&lt;/h1&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setCount(count + 1);
                }}
            &gt;
                Click
            &lt;/button&gt;
        &lt;/&gt;
    );
};

export default Counter;
</code></pre>
<p><strong>Note : [Naive way of Fixing] Fixing the re-render by moving the state that causes
re-render of the parent component to another file</strong></p>
<blockquote>
<p>Input.jsx</p>
</blockquote>
<pre><code class="language-js">import React, { useState } from 'react';

const Input = () =&gt; {
    const [name, setName] = useState('');
    return (
        &lt;form&gt;
            &lt;input
                type="text"
                name="name"
                value={name}
                onChange={(e) =&gt; {
                    setName(e.target.value);
                }}
            /&gt;
        &lt;/form&gt;
    );
};

export default Input;
</code></pre>
<blockquote>
<p>App.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { useState } from 'react';
import Child from './Child';
import Input from './Input';

const dataz = [
    { name: 'abc', id: 1 },
    { name: 'def', id: 2 },
    { name: 'ghi', id: 3 }
];

const Parent = () =&gt; {
    const [data, setData] = useState(dataz);

    const addPerson = () =&gt; {
        setData([...data, { name, id: Date.now() }]);
    };

    // Issue fixed
    return (
        &lt;div&gt;
            &lt;Input /&gt;

            &lt;button
                type="button"
                onClick={() =&gt; {
                    addPerson();
                }}
            &gt;
                Add
            &lt;/button&gt;

            &lt;Child data={data} /&gt;
        &lt;/div&gt;
    );
};

export default Parent;
</code></pre>
<h3 id="reactmemo"><a class="header" href="#reactmemo">React.memo</a></h3>
<p>React.memo is a higher-order component (HOC) in React that allows you to memoize a component.
This means that if the input props to the component have not changed, the memoized
component will return the same result from the previous render, instead of re-rendering.
This can help improve performance by avoiding unnecessary render cycles.</p>
<p>The React.memo function takes a functional component as its argument and
returns a new component that has the same behavior, but with the added optimization
of checking if the props have changed. If the props have not changed, the
memoized component will return the cached result from the previous render.</p>
<blockquote>
<p>Child.jsx</p>
</blockquote>
<p>Instead moving the creating separate component to another file.
Use React.memo to trigger re-render only on props changed</p>
<pre><code class="language-js">export default memo(Child);
</code></pre>
<h3 id="usecallback"><a class="header" href="#usecallback">UseCallback</a></h3>
<p>The useCallback hook is a hook in React that allows you to memoize a function. It takes two arguments: the first is the function you want to memoize, and the second is an array of dependencies. The hook will return a memoized version of the function that only changes if one of the values in the dependency array changes.</p>
<p>By memoizing the function, you can avoid unnecessary re-renders and improve the performance of your React application. The function will only be re-created if one of its dependencies changes, otherwise the same instance of the function will be returned. This can be useful in situations where you have an expensive function that you only want to recompute when its dependencies change.</p>
<p>We will notice a gotcha by creating a removePerson function on
App.jsx , we will see even after with React.memo child component
re-renders again.This is happens beacuse when parent component
re-renders on state change in our case when we type input value
the removePerson is created from scratch so as a result when
removePerson is passed down as a prop to another child component
it trigger re-renders as the prop changed</p>
<blockquote>
<p>Wihout Fix</p>
</blockquote>
<pre><code class="language-js">const removePerson = (id) =&gt; {
    const newPeople = people.filter((person) =&gt; person.id !== id);
    setPeople(newPeople);
};
</code></pre>
<blockquote>
<p>Fix</p>
</blockquote>
<pre><code class="language-js">useCallback(
    (id) =&gt; {
        const newPeople = people.filter((person) =&gt; person.id !== id);
        setPeople(newPeople);
    },
    [people]
);
</code></pre>
<blockquote>
<p>useCallback - Common Use Case</p>
</blockquote>
<p>What happens if we keep dependency array as FetchData in
the useEffect is we will encounter inifinite re-renders
as the fetchData is created from scratch.To fix this and
still use fetchData as dependency we can use useCallback
to create the function only on initial re-render.Another fix
is to not use useCallback and remove fetchData from dependency.</p>
<pre><code class="language-js">import { useState, useEffect, useCallback } from 'react';
const url = 'https://api.github.com/users';

const FetchData = () =&gt; {
    const [users, setUsers] = useState([]);
    const fetchData = useCallback(async () =&gt; {
        try {
            const response = await fetch(url);
            const users = await response.json();
            setUsers(users);
        } catch (error) {
            console.log(error);
        }
    }, []);

    useEffect(() =&gt; {
        fetchData();
    }, [fetchData]);
    // rest of the logic
};
</code></pre>
<h3 id="usememo"><a class="header" href="#usememo">useMemo</a></h3>
<p>The useMemo hook is a hook in React that allows you to memoize a value. It
takes two arguments: the first is a function that returns the value you want to
memoize, and the second is an array of dependencies. The hook will return the
memoized value that will only change if one of the values in the dependency array changes.</p>
<p>By memoizing a value, you can avoid unnecessary calculations and improve the performance
of your React application. The value will only be recalculated if one of its dependencies
changes, otherwise the same instance of the value will be returned. This can be useful
in situations where you have an expensive calculation that you only want to recompute
when its dependencies change.</p>
<p>Make the below function run only on first render</p>
<pre><code class="language-js">const slowFunction = () =&gt; {
    let value = 0;
    for (let i = 0; i &lt;= 1000000000; i++) {
        value += i;
    }
    return value;
};

export default slowFunction;

const processedData = useMemo(() =&gt; {
    slowFunction();
}, []);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="3_react_3_axios"><a href="#3_react_3_axios" class="header">3_react_3_axios</a></h1>
<h3 id="axios"><a class="header" href="#axios">Axios</a></h3>
<h4 id="docs"><a class="header" href="#docs">Docs</a></h4>
<p><a href="https://axios-http.com/docs/intro">Axios Docs</a></p>
<h4 id="install"><a class="header" href="#install">Install</a></h4>
<pre><code class="language-sh">npm install axios
</code></pre>
<pre><code class="language-js">&lt;script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"&gt;&lt;/script&gt;
</code></pre>
<h4 id="first-request"><a class="header" href="#first-request">First Request</a></h4>
<ul>
<li>
<p>import axios</p>
</li>
<li>
<p>axios.get(url)</p>
</li>
<li>
<p>axios.post(url)</p>
</li>
<li>
<p>axios.patch/put(url)</p>
</li>
<li>
<p>axios.delete(url)</p>
</li>
<li>
<p>default get axios(url)</p>
</li>
<li>
<p>returns a promise</p>
</li>
<li>
<p>response data located in data property</p>
</li>
<li>
<p>error in error.response</p>
</li>
</ul>
<pre><code class="language-js">import axios from 'axios';

const fetchData = async () =&gt; {
    try {
        // axios.get(), axios.post(),axios.put(), axios.delete()
        const response = await axios(url);

        console.log(response);
    } catch (error) {
        console.log(error.response);
    }
};
</code></pre>
<h4 id="headers"><a class="header" href="#headers">Headers</a></h4>
<ul>
<li>
<p>second argument</p>
</li>
<li>
<p>axios.get(url,{})</p>
</li>
<li>
<p>third argument in requests with data</p>
</li>
<li>
<p>axios.post(url,{data},{})</p>
</li>
</ul>
<pre><code class="language-js">const fetchDadJoke = async () =&gt; {
    try {
        const { data } = await axios(url, {
            headers: {
                Accept: 'application/json'
            }
        });
        // console.log(data);
        setJoke(data.joke);
    } catch (error) {
        console.log(error.response);
    }
};
</code></pre>
<h4 id="post-request"><a class="header" href="#post-request">Post Request</a></h4>
<ul>
<li>send data to the server</li>
<li>axios.post(url, { data })</li>
<li>more options (auth header) - axios.post(url, { data },{})</li>
</ul>
<pre><code class="language-js">try {
    const resp = await axios.post(url, { data });
} catch (error) {
    console.log(error.response.data);
}
</code></pre>
<h4 id="global-defaults"><a class="header" href="#global-defaults">Global Defaults</a></h4>
<pre><code class="language-js">axios.defaults.headers.common['Accept'] = 'application/json';
axios.defaults.baseURL = 'https://api.example.com';
axios.defaults.headers.common['Authorization'] = AUTH_TOKEN;
axios.defaults.headers.post['Content-Type'] =
    'application/x-www-form-urlencoded';
</code></pre>
<h4 id="custom-instance"><a class="header" href="#custom-instance">Custom Instance</a></h4>
<pre><code class="language-js">const authFetch = axios.create({
    baseURL: 'https://course-api.com',
    headers: {
        Accept: 'application/json'
    }
});
</code></pre>
<h4 id="interceptors"><a class="header" href="#interceptors">Interceptors</a></h4>
<ul>
<li>global and custom</li>
</ul>
<pre><code class="language-js">authFetch.interceptors.request.use(
    (request) =&gt; {
        request.headers.common['Accept'] = `application/json`;
        console.log('request sent');
        // must return request
        return request;
    },
    (error) =&gt; {
        return Promise.reject(error);
    }
);

authFetch.interceptors.response.use(
    (response) =&gt; {
        console.log('got response');
        return response;
    },
    (error) =&gt; {
        console.log(error.response);
        if (error.response.status === 404) {
            // do something
            console.log('NOT FOUND');
        }
        return Promise.reject(error);
    }
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="react-router"><a class="header" href="#react-router">React Router</a></h1>
<h3 id="install-1"><a class="header" href="#install-1">Install</a></h3>
<pre><code class="language-sh">npm install react-router-dom@6
</code></pre>
<h3 id="basic-setup"><a class="header" href="#basic-setup">Basic Setup</a></h3>
<blockquote>
<p>main.jsx</p>
</blockquote>
<p>Wrap entire app with browser router</p>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App.jsx';
import { BrowserRouter } from 'react-router-dom';

ReactDOM.createRoot(document.getElementById('root')).render(
    &lt;BrowserRouter&gt;
        &lt;App /&gt;
    &lt;/BrowserRouter&gt;
);
</code></pre>
<p>Create 2 simple Pages Home,About</p>
<blockquote>
<p>Home.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';

const Home = () =&gt; {
    return &lt;div&gt;Home&lt;/div&gt;;
};

export default Home;
</code></pre>
<blockquote>
<p>About.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';

const About = () =&gt; {
    return &lt;div&gt;About&lt;/div&gt;;
};

export default About;
</code></pre>
<blockquote>
<p>App.jsx</p>
</blockquote>
<p>We use link because it will not refresh the pages.
If we use anchor tags it will refresh the pages.</p>
<p>Wrap Routes inside Route.
Use Route to define single route.</p>
<pre><code class="language-js">import React from 'react';
import { Link, Route, Routes } from 'react-router-dom';
import Home from './pages/Home';
import About from './pages/About';

const App = () =&gt; {
    return (
        &lt;&gt;
            &lt;nav&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/"&gt;Home&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/about"&gt;About&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/nav&gt;
            &lt;Routes&gt;
                &lt;Route path="/" element={&lt;Home /&gt;} /&gt;
                &lt;Route path="/about" element={&lt;About /&gt;} /&gt;
            &lt;/Routes&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h3 id="router-types"><a class="header" href="#router-types">Router Types</a></h3>
<ul>
<li>Hashrouter : Routes as #</li>
<li>unstable_HistoryRouter : Give direct acess to history</li>
<li>MemoryRouter: Used for testing.Stores history in memory.</li>
<li>StaticRouter : Does not allow to browse pages.</li>
</ul>
<h3 id="dynamic-routes"><a class="header" href="#dynamic-routes">Dynamic Routes</a></h3>
<p>Create Booklist and Book Component
Goal is read the route paramete like :id.Example: “/abc/xyz/book/:id”</p>
<blockquote>
<p>App.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { Link, Route, Routes } from 'react-router-dom';
import Home from './pages/Home';
import About from './pages/About';
import Books from './pages/Books';
import Book from './pages/Book';

const App = () =&gt; {
    return (
        &lt;&gt;
            &lt;nav&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/"&gt;Home&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/about"&gt;About&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/books"&gt;Books&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/nav&gt;
            &lt;Routes&gt;
                &lt;Route path="/" element={&lt;Home /&gt;} /&gt;
                &lt;Route path="/about" element={&lt;About /&gt;} /&gt;
                &lt;Route path="/books" element={&lt;Books /&gt;} /&gt;
                &lt;Route path="/books/:id" element={&lt;Book /&gt;} /&gt;
            &lt;/Routes&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>Books.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { Link } from 'react-router-dom';

const Books = () =&gt; {
    return (
        &lt;div&gt;
            &lt;h3&gt;Book List&lt;/h3&gt;
            &lt;Link to="/books/1"&gt;book 1&lt;/Link&gt;
            &lt;br /&gt;
            &lt;Link to="/books/2"&gt;book 2&lt;/Link&gt;
            &lt;br /&gt;
            &lt;Link to="/books/3"&gt;book 3&lt;/Link&gt;
            &lt;br /&gt;
        &lt;/div&gt;
    );
};

export default Books;
</code></pre>
<blockquote>
<p>Book.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { useParams } from 'react-router-dom';

const Book = () =&gt; {
    const params = useParams();
    return &lt;div&gt;Book {params.id}&lt;/div&gt;;
};

export default Book;
</code></pre>
<h3 id="route-specificity"><a class="header" href="#route-specificity">Route Specificity</a></h3>
<p>Suppose we have two routes “/books/:id” [1st] “/books/new” [2nd].
In previous version of react router dom what it would had done is gone
with the first match.But newer version will take the hardcoded value as
the possible route option.</p>
<blockquote>
<p>not found</p>
</blockquote>
<pre><code class="language-js">&lt;Route path="*" element={&lt;NotFound /&gt;} /&gt;
</code></pre>
<h3 id="nesting"><a class="header" href="#nesting">Nesting</a></h3>
<blockquote>
<p>App.jsx</p>
</blockquote>
<p>Basic Nesting</p>
<pre><code class="language-js">import React from 'react';
import { Link, Route, Routes } from 'react-router-dom';
import Home from './pages/Home';
import About from './pages/About';
import Books from './pages/Books';
import Book from './pages/Book';
import Notfound from './pages/Notfound';

const App = () =&gt; {
    return (
        &lt;&gt;
            &lt;nav&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/"&gt;Home&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/about"&gt;About&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/books"&gt;Books&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/nav&gt;

            {/* Basic Nesting */}

            &lt;Routes&gt;
                &lt;Route path="/" element={&lt;Home /&gt;} /&gt;
                &lt;Route path="/about" element={&lt;About /&gt;} /&gt;
                &lt;Route path="/books"&gt;
                    &lt;Route index element={&lt;Books /&gt;} /&gt;
                    &lt;Route path=":id" element={&lt;Book /&gt;} /&gt;
                &lt;/Route&gt;

                &lt;Route path="*" element={&lt;Notfound /&gt;} /&gt;
            &lt;/Routes&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h3 id="basic-nesting-by-passing-a-layout-in-every-children-routes-shared-layout"><a class="header" href="#basic-nesting-by-passing-a-layout-in-every-children-routes-shared-layout">Basic Nesting by passing a layout in every children routes [shared layout]</a></h3>
<blockquote>
<p>Layout.jsx</p>
</blockquote>
<p>Outlet must be added otherwise the dom will painter only with layout’s jsx.</p>
<pre><code class="language-js">import React from 'react';
import { Outlet } from 'react-router-dom';

const Layout = () =&gt; {
    return (
        &lt;&gt;
            &lt;h3&gt;This layout is to be shared.&lt;/h3&gt;
            &lt;Outlet /&gt;
        &lt;/&gt;
    );
};

export default Layout;
</code></pre>
<blockquote>
<p>App.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { Link, Route, Routes } from 'react-router-dom';
import Home from './pages/Home';
import About from './pages/About';
import Books from './pages/Books';
import Book from './pages/Book';
import Notfound from './pages/Notfound';
import Layout from './pages/Layout';

const App = () =&gt; {
    return (
        &lt;&gt;
            &lt;nav&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/"&gt;Home&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/about"&gt;About&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/books"&gt;Books&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/nav&gt;

            {/* Basic Nesting */}

            &lt;Routes&gt;
                &lt;Route path="/" element={&lt;Home /&gt;} /&gt;
                &lt;Route path="/about" element={&lt;About /&gt;} /&gt;
                &lt;Route path="/books" element={&lt;Layout /&gt;}&gt;
                    &lt;Route index element={&lt;Books /&gt;} /&gt;
                    &lt;Route path=":id" element={&lt;Book /&gt;} /&gt;
                &lt;/Route&gt;

                &lt;Route path="*" element={&lt;Notfound /&gt;} /&gt;
            &lt;/Routes&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h3 id="outlet-context"><a class="header" href="#outlet-context">Outlet context</a></h3>
<blockquote>
<p>Layout.jsx</p>
</blockquote>
<p>Outlet can be used to pass context</p>
<pre><code class="language-js">import React from 'react';
import { Outlet } from 'react-router-dom';

const Layout = () =&gt; {
    return (
        &lt;&gt;
            &lt;h3&gt;This layout is to be shared.&lt;/h3&gt;
            &lt;Outlet context={{ hello: 'world', name: 'john' }} /&gt;
        &lt;/&gt;
    );
};

export default Layout;
</code></pre>
<blockquote>
<p>Books.jsx</p>
</blockquote>
<p>Go to any child route adn access the context value with useContext</p>
<pre><code class="language-js">import React from 'react';
import { Link, useOutletContext } from 'react-router-dom';

const Books = () =&gt; {
    const val = useOutletContext();
    console.log(val);
    return (
        &lt;div&gt;
            &lt;h3&gt;Book List&lt;/h3&gt;
            &lt;Link to="/books/1"&gt;book 1&lt;/Link&gt;
            &lt;br /&gt;
            &lt;Link to="/books/2"&gt;book 2&lt;/Link&gt;
            &lt;br /&gt;
            &lt;Link to="/books/3"&gt;book 3&lt;/Link&gt;
            &lt;br /&gt;
        &lt;/div&gt;
    );
};

export default Books;
</code></pre>
<h3 id="routes-in-a-seperate-file"><a class="header" href="#routes-in-a-seperate-file">Routes in a seperate file</a></h3>
<blockquote>
<p>BookRoutes.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { Route, Routes } from 'react-router-dom';
import Books from './pages/Books';
import Book from './pages/Book';
import Layout from './pages/Layout';

const BookRoutes = () =&gt; {
    return (
        &lt;Routes&gt;
            &lt;Route element={&lt;Layout /&gt;}&gt;
                &lt;Route index element={&lt;Books /&gt;} /&gt;
                &lt;Route path=":id" element={&lt;Book /&gt;} /&gt;
            &lt;/Route&gt;
        &lt;/Routes&gt;
    );
};

export default BookRoutes;
</code></pre>
<blockquote>
<p>App.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { Link, Route, Routes } from 'react-router-dom';
import Home from './pages/Home';
import About from './pages/About';
import Notfound from './pages/Notfound';
import BookRoutes from './BookRoutes';

const App = () =&gt; {
    return (
        &lt;&gt;
            &lt;nav&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/"&gt;Home&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/about"&gt;About&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul&gt;
                    &lt;li&gt;
                        &lt;Link to="/books"&gt;Books&lt;/Link&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/nav&gt;

            {/* Basic Nesting */}

            &lt;Routes&gt;
                &lt;Route path="/" element={&lt;Home /&gt;} /&gt;
                &lt;Route path="/about" element={&lt;About /&gt;} /&gt;
                &lt;Route path="/books/*" element={&lt;BookRoutes /&gt;} /&gt;
                &lt;Route path="*" element={&lt;Notfound /&gt;} /&gt;
            &lt;/Routes&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<h3 id="useroute"><a class="header" href="#useroute">useRoute</a></h3>
<p>We can use Js instead to define routes</p>
<h2 id="handling-navigation"><a class="header" href="#handling-navigation">Handling Navigation</a></h2>
<p>In NavLink , Link ,Navigate</p>
<ul>
<li>replace (replace last visited page with current page),</li>
<li>reloadDocument (referesh the entirepage)</li>
</ul>
<h2 id="navlink"><a class="header" href="#navlink">NavLink</a></h2>
<p>By deafult adds class of active</p>
<pre><code class="language-js">&lt;NavLink
    to="/"
    style={({ isActive }) =&gt; ({ color: isActive ? 'red' : 'black' })}
&gt;
    {({ isActive }) =&gt; {
        return isActive ? 'Active Home' : 'Home';
    }}
&lt;/NavLink&gt;
</code></pre>
<h2 id="navigate"><a class="header" href="#navigate">Navigate</a></h2>
<p>navigate with a component</p>
<pre><code class="language-js">&lt;Navigate to="/" /&gt;
</code></pre>
<h2 id="usenavigate"><a class="header" href="#usenavigate">useNavigate</a></h2>
<p>navigate with a hook</p>
<pre><code class="language-js">const navigate = useNavigate();

unction onSubmit() {
  // Submit form results
  navigate("/books", { replace: true, state: { bookName: "Fake Title" } })
}
</code></pre>
<h2 id="search-params"><a class="header" href="#search-params">Search Params</a></h2>
<p>Access searchparams</p>
<pre><code class="language-js">import React from 'react';
import { Link, useOutletContext, useSearchParams } from 'react-router-dom';

const Books = () =&gt; {
    const val = useOutletContext();

    // Get search parameters
    const [searchparams, setSearchParams] = useSearchParams();
    console.log(searchparams.get('q'));

    // setSearchParams({ n: e.target.value })

    console.log(val);
    return (
        &lt;div&gt;
            &lt;h3&gt;Book List&lt;/h3&gt;
            &lt;Link to="/books/1"&gt;book 1&lt;/Link&gt;
            &lt;br /&gt;
            &lt;Link to="/books/2"&gt;book 2&lt;/Link&gt;
            &lt;br /&gt;
            &lt;Link to="/books/3"&gt;book 3&lt;/Link&gt;
            &lt;br /&gt;
        &lt;/div&gt;
    );
};

export default Books;
</code></pre>
<h2 id="uselocation"><a class="header" href="#uselocation">useLocation</a></h2>
<p>access state data passed from another route</p>
<pre><code class="language-js">const location = useLocation();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="5_react_5_redux_tookit"><a href="#5_react_5_redux_tookit" class="header">5_react_5_redux_tookit</a></h1>
<h3 id="redux-with-redux-toolkit"><a class="header" href="#redux-with-redux-toolkit">Redux with redux-toolkit</a></h3>
<h4 id="docs-1"><a class="header" href="#docs-1">Docs</a></h4>
<p><a href="https://redux-toolkit.js.org/introduction/getting-started">Redux Toolkit Docs</a></p>
<h4 id="install-template"><a class="header" href="#install-template">Install Template</a></h4>
<pre><code class="language-sh">npx create-react-app my-app --template redux
</code></pre>
<ul>
<li>@latest</li>
</ul>
<pre><code class="language-sh">npx create-react-app@latest my-app --template redux
</code></pre>
<h4 id="existing-app"><a class="header" href="#existing-app">Existing App</a></h4>
<pre><code class="language-sh">npm install @reduxjs/toolkit react-redux
</code></pre>
<h4 id="reduxjstoolkit"><a class="header" href="#reduxjstoolkit">@reduxjs/toolkit</a></h4>
<p>consists of few libraries</p>
<ul>
<li>redux (core library, state management)</li>
<li>immer (allows to mutate state)</li>
<li>redux-thunk (handles async actions)</li>
<li>reselect (simplifies reducer functions)</li>
</ul>
<h4 id="extras"><a class="header" href="#extras">Extras</a></h4>
<ul>
<li>redux devtools</li>
<li>combine reducers</li>
</ul>
<h4 id="react-redux"><a class="header" href="#react-redux">react-redux</a></h4>
<p>connects our app to redux</p>
<h4 id="setup-store"><a class="header" href="#setup-store">Setup Store</a></h4>
<ul>
<li>create store.js</li>
</ul>
<pre><code class="language-js">import { configureStore } from '@reduxjs/toolkit';

export const store = configureStore({
    reducer: {}
});
</code></pre>
<h4 id="setup-provider"><a class="header" href="#setup-provider">Setup Provider</a></h4>
<ul>
<li>index.js</li>
</ul>
<pre><code class="language-js">import React from 'react';
import ReactDOM from 'react-dom';
import './index.css';
import App from './App';
// import store and provider
import { store } from './store';
import { Provider } from 'react-redux';

ReactDOM.render(
    &lt;React.StrictMode&gt;
        &lt;Provider store={store}&gt;
            &lt;App /&gt;
        &lt;/Provider&gt;
    &lt;/React.StrictMode&gt;,
    document.getElementById('root')
);
</code></pre>
<h4 id="setup-cart-slice"><a class="header" href="#setup-cart-slice">Setup Cart Slice</a></h4>
<ul>
<li>application feature</li>
<li>create features folder/cart</li>
<li>create cartSlice.js</li>
</ul>
<pre><code class="language-js">import { createSlice } from '@reduxjs/toolkit';

const initialState = {
    cartItems: [],
    amount: 0,
    total: 0,
    isLoading: true
};

const cartSlice = createSlice({
    name: 'cart',
    initialState
});

console.log(cartSlice);

export default cartSlice.reducer;
</code></pre>
<ul>
<li>store.js</li>
</ul>
<pre><code class="language-js">import { configureStore } from '@reduxjs/toolkit';
import cartReducer from './features/cart/cartSlice';

export const store = configureStore({
    reducer: {
        cart: cartReducer
    }
});
</code></pre>
<h4 id="redux-devtools"><a class="header" href="#redux-devtools">Redux DevTools</a></h4>
<ul>
<li>extension</li>
</ul>
<h4 id="access-store-value"><a class="header" href="#access-store-value">Access store value</a></h4>
<ul>
<li>create components/Navbar.js</li>
</ul>
<pre><code class="language-js">import { CartIcon } from '../icons';
import { useSelector } from 'react-redux';

const Navbar = () =&gt; {
    const { amount } = useSelector((state) =&gt; state.cart);

    return (
        &lt;nav&gt;
            &lt;div className="nav-center"&gt;
                &lt;h3&gt;redux toolkit&lt;/h3&gt;
                &lt;div className="nav-container"&gt;
                    &lt;CartIcon /&gt;
                    &lt;div className="amount-container"&gt;
                        &lt;p className="total-amount"&gt;{amount}&lt;/p&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/nav&gt;
    );
};
export default Navbar;
</code></pre>
<h4 id="hero-icons"><a class="header" href="#hero-icons">Hero Icons</a></h4>
<ul>
<li><a href="https://heroicons.com/">Hero Icons</a></li>
</ul>
<pre><code class="language-css">nav svg {
    width: 40px;
    color: var(--clr-white);
}
</code></pre>
<h4 id="setup-cart"><a class="header" href="#setup-cart">Setup Cart</a></h4>
<ul>
<li>cartSlice.js</li>
</ul>
<pre><code class="language-js">import cartItems from '../../cartItems';

const initialState = {
    cartItems: cartItems,
    amount: 0,
    total: 0,
    isLoading: true
};
</code></pre>
<ul>
<li>create CartContainer.js and CartItem.js</li>
<li>CartContainer.js</li>
</ul>
<pre><code class="language-js">import React from 'react';
import CartItem from './CartItem';
import { useSelector } from 'react-redux';

const CartContainer = () =&gt; {
    const { cartItems, total, amount } = useSelector((state) =&gt; state.cart);

    if (amount &lt; 1) {
        return (
            &lt;section className="cart"&gt;
                {/* cart header */}
                &lt;header&gt;
                    &lt;h2&gt;your bag&lt;/h2&gt;
                    &lt;h4 className="empty-cart"&gt;is currently empty&lt;/h4&gt;
                &lt;/header&gt;
            &lt;/section&gt;
        );
    }
    return (
        &lt;section className="cart"&gt;
            {/* cart header */}
            &lt;header&gt;
                &lt;h2&gt;your bag&lt;/h2&gt;
            &lt;/header&gt;
            {/* cart items */}
            &lt;div&gt;
                {cartItems.map((item) =&gt; {
                    return &lt;CartItem key={item.id} {...item} /&gt;;
                })}
            &lt;/div&gt;
            {/* cart footer */}
            &lt;footer&gt;
                &lt;hr /&gt;
                &lt;div className="cart-total"&gt;
                    &lt;h4&gt;
                        total &lt;span&gt;${total}&lt;/span&gt;
                    &lt;/h4&gt;
                &lt;/div&gt;
                &lt;button className="btn clear-btn"&gt;clear cart&lt;/button&gt;
            &lt;/footer&gt;
        &lt;/section&gt;
    );
};

export default CartContainer;
</code></pre>
<ul>
<li>CartItem.js</li>
</ul>
<pre><code class="language-js">import React from 'react';
import { ChevronDown, ChevronUp } from '../icons';

const CartItem = ({ id, img, title, price, amount }) =&gt; {
    return (
        &lt;article className="cart-item"&gt;
            &lt;img src={img} alt={title} /&gt;
            &lt;div&gt;
                &lt;h4&gt;{title}&lt;/h4&gt;
                &lt;h4 className="item-price"&gt;${price}&lt;/h4&gt;
                {/* remove button */}
                &lt;button className="remove-btn"&gt;remove&lt;/button&gt;
            &lt;/div&gt;
            &lt;div&gt;
                {/* increase amount */}
                &lt;button className="amount-btn"&gt;
                    &lt;ChevronUp /&gt;
                &lt;/button&gt;
                {/* amount */}
                &lt;p className="amount"&gt;{amount}&lt;/p&gt;
                {/* decrease amount */}
                &lt;button className="amount-btn"&gt;
                    &lt;ChevronDown /&gt;
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/article&gt;
    );
};

export default CartItem;
</code></pre>
<h4 id="first-reducer"><a class="header" href="#first-reducer">First Reducer</a></h4>
<ul>
<li>cartSlice.js</li>
<li>Immer library</li>
</ul>
<pre><code class="language-js">const cartSlice = createSlice({
    name: 'cart',
    initialState,
    reducers: {
        clearCart: (state) =&gt; {
            state.cartItems = [];
        }
    }
});

export const { clearCart } = cartSlice.actions;
</code></pre>
<ul>
<li>create action</li>
</ul>
<pre><code class="language-js">const ACTION_TYPE = 'ACTION_TYPE';

const actionCreator = (payload) =&gt; {
    return { type: ACTION_TYPE, payload: payload };
};
</code></pre>
<ul>
<li>CartContainer.js</li>
</ul>
<pre><code class="language-js">import React from 'react';
import CartItem from './CartItem';
import { useDispatch, useSelector } from 'react-redux';

const CartContainer = () =&gt; {
    const dispatch = useDispatch();

    return (
        &lt;button
            className="btn clear-btn"
            onClick={() =&gt; {
                dispatch(clearCart());
            }}
        &gt;
            clear cart
        &lt;/button&gt;
    );
};

export default CartContainer;
</code></pre>
<h4 id="remove-increase-decrease"><a class="header" href="#remove-increase-decrease">Remove, Increase, Decrease</a></h4>
<ul>
<li>cartSlice.js</li>
</ul>
<pre><code class="language-js">import { createSlice } from '@reduxjs/toolkit';
import cartItems from '../../cartItems';

const initialState = {
    cartItems: [],
    amount: 0,
    total: 0,
    isLoading: true
};

const cartSlice = createSlice({
    name: 'cart',
    initialState,
    reducers: {
        clearCart: (state) =&gt; {
            state.cartItems = [];
        },
        removeItem: (state, action) =&gt; {
            const itemId = action.payload;
            state.cartItems = state.cartItems.filter(
                (item) =&gt; item.id !== itemId
            );
        },
        increase: (state, { payload }) =&gt; {
            const cartItem = state.cartItems.find(
                (item) =&gt; item.id === payload.id
            );
            cartItem.amount = cartItem.amount + 1;
        },
        decrease: (state, { payload }) =&gt; {
            const cartItem = state.cartItems.find(
                (item) =&gt; item.id === payload.id
            );
            cartItem.amount = cartItem.amount - 1;
        },
        calculateTotals: (state) =&gt; {
            let amount = 0;
            let total = 0;
            state.cartItems.forEach((item) =&gt; {
                amount += item.amount;
                total += item.amount * item.price;
            });
            state.amount = amount;
            state.total = total;
        }
    }
});

export const { clearCart, removeItem, increase, decrease, calculateTotals } =
    cartSlice.actions;

export default cartSlice.reducer;
</code></pre>
<ul>
<li>CartItem.js</li>
</ul>
<pre><code class="language-js">import React from 'react';
import { ChevronDown, ChevronUp } from '../icons';

import { useDispatch } from 'react-redux';
import { removeItem, increase, decrease } from '../features/cart/cartSlice';

const CartItem = ({ id, img, title, price, amount }) =&gt; {
    const dispatch = useDispatch();

    return (
        &lt;article className="cart-item"&gt;
            &lt;img src={img} alt={title} /&gt;
            &lt;div&gt;
                &lt;h4&gt;{title}&lt;/h4&gt;
                &lt;h4 className="item-price"&gt;${price}&lt;/h4&gt;
                {/* remove button */}
                &lt;button
                    className="remove-btn"
                    onClick={() =&gt; {
                        dispatch(removeItem(id));
                    }}
                &gt;
                    remove
                &lt;/button&gt;
            &lt;/div&gt;
            &lt;div&gt;
                {/* increase amount */}
                &lt;button
                    className="amount-btn"
                    onClick={() =&gt; {
                        dispatch(increase({ id }));
                    }}
                &gt;
                    &lt;ChevronUp /&gt;
                &lt;/button&gt;
                {/* amount */}
                &lt;p className="amount"&gt;{amount}&lt;/p&gt;
                {/* decrease amount */}
                &lt;button
                    className="amount-btn"
                    onClick={() =&gt; {
                        if (amount === 1) {
                            dispatch(removeItem(id));
                            return;
                        }
                        dispatch(decrease({ id }));
                    }}
                &gt;
                    &lt;ChevronDown /&gt;
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/article&gt;
    );
};

export default CartItem;
</code></pre>
<ul>
<li>App.js</li>
</ul>
<pre><code class="language-js">import { useEffect } from 'react';
import Navbar from './components/Navbar';
import CartContainer from './components/CartContainer';
import { useSelector, useDispatch } from 'react-redux';
import { calculateTotals } from './features/cart/cartSlice';

function App() {
    const { cartItems } = useSelector((state) =&gt; state.cart);
    const dispatch = useDispatch();
    useEffect(() =&gt; {
        dispatch(calculateTotals());
    }, [cartItems]);

    return (
        &lt;main&gt;
            &lt;Navbar /&gt;
            &lt;CartContainer /&gt;
        &lt;/main&gt;
    );
}

export default App;
</code></pre>
<h4 id="modal"><a class="header" href="#modal">Modal</a></h4>
<ul>
<li>create components/Modal.js</li>
</ul>
<pre><code class="language-js">const Modal = () =&gt; {
    return (
        &lt;aside className="modal-container"&gt;
            &lt;div className="modal"&gt;
                &lt;h4&gt;Remove all items from your shopping cart?&lt;/h4&gt;
                &lt;div className="btn-container"&gt;
                    &lt;button type="button" className="btn confirm-btn"&gt;
                        confirm
                    &lt;/button&gt;
                    &lt;button type="button" className="btn clear-btn"&gt;
                        cancel
                    &lt;/button&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/aside&gt;
    );
};
export default Modal;
</code></pre>
<ul>
<li>App.js</li>
</ul>
<pre><code class="language-js">return (
    &lt;main&gt;
        &lt;Modal /&gt;
        &lt;Navbar /&gt;
        &lt;CartContainer /&gt;
    &lt;/main&gt;
);
</code></pre>
<h4 id="modal-slice"><a class="header" href="#modal-slice">modal slice</a></h4>
<ul>
<li>create features/modal/modalSlice.js</li>
</ul>
<pre><code class="language-js">import { createSlice } from '@reduxjs/toolkit';
const initialState = {
    isOpen: false
};

const modalSlice = createSlice({
    name: 'modal',
    initialState,
    reducers: {
        openModal: (state, action) =&gt; {
            state.isOpen = true;
        },
        closeModal: (state, action) =&gt; {
            state.isOpen = false;
        }
    }
});

export const { openModal, closeModal } = modalSlice.actions;
export default modalSlice.reducer;
</code></pre>
<ul>
<li>App.js</li>
</ul>
<pre><code class="language-js">const { isOpen } = useSelector((state) =&gt; state.modal);

return (
    &lt;main&gt;
        {isOpen &amp;&amp; &lt;Modal /&gt;}
        &lt;Navbar /&gt;
        &lt;CartContainer /&gt;
    &lt;/main&gt;
);
</code></pre>
<h4 id="toggle-modal"><a class="header" href="#toggle-modal">toggle modal</a></h4>
<ul>
<li>CartContainer.js</li>
</ul>
<pre><code class="language-js">import { openModal } from '../features/modal/modalSlice';

return (
    &lt;button
        className="btn clear-btn"
        onClick={() =&gt; {
            dispatch(openModal());
        }}
    &gt;
        clear cart
    &lt;/button&gt;
);
</code></pre>
<ul>
<li>Modal.js</li>
</ul>
<pre><code class="language-js">import { closeModal } from '../features/modal/modalSlice';
import { useDispatch } from 'react-redux';
import { clearCart } from '../features/cart/cartSlice';

const Modal = () =&gt; {
    const dispatch = useDispatch();

    return (
        &lt;aside className="modal-container"&gt;
            &lt;div className="modal"&gt;
                &lt;h4&gt;Remove all items from your shopping cart?&lt;/h4&gt;
                &lt;div className="btn-container"&gt;
                    &lt;button
                        type="button"
                        className="btn confirm-btn"
                        onClick={() =&gt; {
                            dispatch(clearCart());
                            dispatch(closeModal());
                        }}
                    &gt;
                        confirm
                    &lt;/button&gt;
                    &lt;button
                        type="button"
                        className="btn clear-btn"
                        onClick={() =&gt; {
                            dispatch(closeModal());
                        }}
                    &gt;
                        cancel
                    &lt;/button&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/aside&gt;
    );
};
export default Modal;
</code></pre>
<h4 id="async-functionality-with-createasyncthunk"><a class="header" href="#async-functionality-with-createasyncthunk">async functionality with createAsyncThunk</a></h4>
<ul>
<li>
<p><a href="https://course-api.com/">Course API</a></p>
</li>
<li>
<p>https://course-api.com/react-useReducer-cart-project</p>
</li>
<li>
<p>cartSlice.js</p>
</li>
<li>
<p>action type</p>
</li>
<li>
<p>callback function</p>
</li>
<li>
<p>lifecycle actions</p>
</li>
</ul>
<pre><code class="language-js">import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';

const url = 'https://course-api.com/react-useReducer-cart-project';

export const getCartItems = createAsyncThunk('cart/getCartItems', () =&gt; {
    return fetch(url)
        .then((resp) =&gt; resp.json())
        .catch((err) =&gt; console.log(error));
});

const cartSlice = createSlice({
    name: 'cart',
    initialState,
    extraReducers: {
        [getCartItems.pending]: (state) =&gt; {
            state.isLoading = true;
        },
        [getCartItems.fulfilled]: (state, action) =&gt; {
            console.log(action);
            state.isLoading = false;
            state.cartItems = action.payload;
        },
        [getCartItems.rejected]: (state) =&gt; {
            state.isLoading = false;
        }
    }
});
</code></pre>
<ul>
<li>App.js</li>
</ul>
<pre><code class="language-js">import { calculateTotals, getCartItems } from './features/cart/cartSlice';

function App() {
    const { cartItems, isLoading } = useSelector((state) =&gt; state.cart);

    useEffect(() =&gt; {
        dispatch(getCartItems());
    }, []);

    if (isLoading) {
        return (
            &lt;div className="loading"&gt;
                &lt;h1&gt;Loading...&lt;/h1&gt;
            &lt;/div&gt;
        );
    }

    return (
        &lt;main&gt;
            {isOpen &amp;&amp; &lt;Modal /&gt;}
            &lt;Navbar /&gt;
            &lt;CartContainer /&gt;
        &lt;/main&gt;
    );
}

export default App;
</code></pre>
<h4 id="options"><a class="header" href="#options">Options</a></h4>
<pre><code class="language-sh">npm install axios
</code></pre>
<ul>
<li>cartSlice.js</li>
</ul>
<pre><code class="language-js">export const getCartItems = createAsyncThunk(
    'cart/getCartItems',
    async (name, thunkAPI) =&gt; {
        try {
            // console.log(name);
            // console.log(thunkAPI);
            // console.log(thunkAPI.getState());
            // thunkAPI.dispatch(openModal());
            const resp = await axios(url);

            return resp.data;
        } catch (error) {
            return thunkAPI.rejectWithValue('something went wrong');
        }
    }
);
</code></pre>
<h4 id="the-extrareducers-builder-callback-notation"><a class="header" href="#the-extrareducers-builder-callback-notation">The extraReducers “builder callback” notation</a></h4>
<p>cart/cartSlice</p>
<pre><code class="language-js">const cartSlice = createSlice({
    name: 'cart',
    initialState,
    reducers: {
        // reducers
    },
    extraReducers: (builder) =&gt; {
        builder
            .addCase(getCartItems.pending, (state) =&gt; {
                state.isLoading = true;
            })
            .addCase(getCartItems.fulfilled, (state, action) =&gt; {
                // console.log(action);
                state.isLoading = false;
                state.cartItems = action.payload;
            })
            .addCase(getCartItems.rejected, (state, action) =&gt; {
                console.log(action);
                state.isLoading = false;
            });
    }
});
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="node-i"><a class="header" href="#node-i">Node I</a></h1>
<blockquote>
<p>What is nodejs ?</p>
</blockquote>
<ul>
<li>Environment to run JS outside browser</li>
<li>Built on chromes V8 engine</li>
<li>Both Frontend and Backend can be written in javascript</li>
<li>It provides a way to build scalable and high-performance applications using JavaScript on the server-side</li>
</ul>
<blockquote>
<p>Difference b/w Browser js &amp; NodeJS</p>
</blockquote>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Browser js</th><th>nodejs</th></tr>
</thead>
<tbody>
<tr><td>Acess to browser APIs like DOM,window object</td><td>No access to browser APIs</td></tr>
<tr><td>Use to make Interactive Apps</td><td>Use to make Server side Apps</td></tr>
<tr><td>No filesystem</td><td>Has access to filesystem</td></tr>
<tr><td>Depends on users browser’s version</td><td>Depends on NodeJS version</td></tr>
<tr><td>ES6 modules</td><td>CommonJS</td></tr>
</tbody>
</table>
</div>
<h3 id="globals"><a class="header" href="#globals">Globals</a></h3>
<ul>
<li>__dirname - path to current directory</li>
<li>__filename - file name</li>
<li>require - function to use modules (CommonJS)</li>
<li>module - info about current module (file)</li>
<li>process - info about env where the program is being executed</li>
</ul>
<blockquote>
<p>What are modules in nodejs ?</p>
</blockquote>
<p>Modules in Node.js are reusable pieces of code that can
be imported and used in other parts of a program</p>
<ul>
<li>Encapsulated Code (only sahre minimum)</li>
<li>Every file in NodeJS is module by default</li>
</ul>
<h3 id="packagejson-vs-package-lockjson"><a class="header" href="#packagejson-vs-package-lockjson">package.json vs package-lock.json</a></h3>
<ul>
<li>
<p>package.json describes the project’s dependencies at a high level</p>
</li>
<li>
<p>package-lock.json provides a detailed record of the exact versions of those dependencies
that were installed. This can help prevent version conflicts and ensure consistent
behavior across different development environments.</p>
</li>
</ul>
<h3 id="modules"><a class="header" href="#modules">Modules</a></h3>
<p><strong>Example to show module export import</strong></p>
<blockquote>
<p>utils.js</p>
</blockquote>
<pre><code class="language-js">// Exporting with custom name

module.exports.name = 'johndoe';

// Exporting directly

module.exports = { name: 'johndoe', id: 3 };

// Returns an object with many properties but we are interested in exports property

console.log(module);
</code></pre>
<p><strong>Note: Whenever we import a module we execute the module</strong></p>
<blockquote>
<p>app.js</p>
</blockquote>
<pre><code class="language-js">const data = require('./utils');

// Will return all the things in exports
console.log(data);
</code></pre>
<h3 id="common-inbuilt-modules"><a class="header" href="#common-inbuilt-modules">Common inbuilt modules</a></h3>
<ul>
<li>os</li>
<li>path</li>
<li>fs</li>
<li>http</li>
</ul>
<h4 id="path-module-basics"><a class="header" href="#path-module-basics">Path module basics</a></h4>
<pre><code class="language-js">const path = require('path');

// returns platform specific path delimter
// For Windows -&gt; \
// For Linux,Mac,BSD -&gt; /
console.log(path.sep);

// Joins the path with platform specific delimeter
const filePath = path.join(`${path.sep}folder`, 'subfolder', 'test.txt');
console.log(filePath);

// Get basename [end name]
console.log(path.basename(filePath));

// Absolute path

// Returns directory of package.json of current project
console.log(__dirname);
console.log(path.resolve(__dirname, 'folder', 'subfolder', 'test.txt'));
</code></pre>
<h4 id="fs-sync-module"><a class="header" href="#fs-sync-module">fs sync module</a></h4>
<pre><code class="language-js">const { readFileSync, writeFileSync } = require('fs');
console.log('start');
const first = readFileSync('./content/first.txt', 'utf8');
const second = readFileSync('./content/second.txt', 'utf8');

writeFileSync(
    './content/result-sync.txt',
    `Here is the result : ${first}, ${second}`,
    { flag: 'a' }
);
console.log('done with this task');
console.log('starting the next one');
</code></pre>
<h4 id="fs-async-module"><a class="header" href="#fs-async-module">fs async module</a></h4>
<pre><code class="language-js">const { writeFile, readFile } = require('fs');

console.log('Start ..');

readFile('./content/first.txt', 'utf-8', (err, res) =&gt; {
    if (err) {
        console.log(err);
        return;
    }
    const first = res;
    console.log(first);
    readFile('./content/second.txt', 'utf-8', (err, res) =&gt; {
        if (err) {
            console.log(err);
            return;
        }
        const sec = res;
        console.log(sec);
        writeFile(
            './content/result-async.txt',
            `${first} ${sec}`,
            {
                flag: 'a'
            },
            (err, res) =&gt; {
                if (err) {
                    return;
                }
                console.log('done with the task');
            }
        );
    });
});

console.log('End');
</code></pre>
<h4 id="http-module"><a class="header" href="#http-module">HTTP Module</a></h4>
<p><strong>Note : Must use end connection otherwise page wull not paint</strong></p>
<pre><code class="language-js">const http = require('http');

const server = http.createServer((req, res) =&gt; {
    if (req.url === '/') {
        res.write('Home Page');
        res.end();
    } else if (req.url === '/about') {
        res.end(`
            &lt;h1&gt; About Page&lt;/h1 &gt;
        `);
    } else {
        res.end(
            `&lt;h1&gt;Page does not exists! &lt;a href="/"&gt;Go back to Home Page&lt;/a&gt;&lt;/h1&gt;`
        );
    }
});

server.listen(5000, () =&gt; {
    console.log('Server started ....');
});
</code></pre>
<h3 id="event-loop"><a class="header" href="#event-loop">Event loop</a></h3>
<p>The event loop is a mechanism in Node.js that allows it to handle multiple requests and operations
simultaneously. It continuously checks for new events or tasks in the queue and executes them one
by one. This ensures that Node.js can handle a large number of requests without blocking the main
thread, making it highly efficient and scalable.</p>
<p>JavaScript is an interpreted language, and it executes code from top to bottom. In JavaScript,
we have the call stack, callbacks, and Web APIs. When code execution starts, it adds everything
one by one to the call stack. Whenever it encounters timeouts, fetch, interval functions, or other
asynchronous operations that take some time to complete, it removes those from the call stack and
puts them into the Web API, which waits for the task to finish. After the task is finished executing,
it is pushed into the task queue (also known as the callback queue), and the event loop takes all the
tasks from the task queue and pushes them to the call stack, where they are executed.</p>
<h3 id="inbuilt-promisify-function-in-nodejs"><a class="header" href="#inbuilt-promisify-function-in-nodejs">Inbuilt promisify function in NodeJS</a></h3>
<pre><code class="language-js">NodeJS -&gt; Inbuilt function util.promisify or use .promise
</code></pre>
<h3 id="event-emitter"><a class="header" href="#event-emitter">Event Emitter</a></h3>
<p>EventEmitter is a built-in module in Node.js that allows you to
create objects that can emit and listen for events.</p>
<pre><code class="language-js">// get back the class
// if want custom extend from class
// otherwise just for emitting and handling events create instance
const EventEmitter = require('events');

const customEmitter = new EventEmitter();

// on and emit methods
// keep track of the order
// additional arguments
// built-in modules utilize it

customEmitter.on('response', (name, id) =&gt; {
    console.log(`data recieved user ${name} with id:${id}`);
});

customEmitter.on('response', () =&gt; {
    console.log('some other logic here');
});

customEmitter.emit('response', 'john', 34);
</code></pre>
<h3 id="streams"><a class="header" href="#streams">Streams</a></h3>
<blockquote>
<p>Extends emitter class</p>
</blockquote>
<ul>
<li>Read and write sequentially</li>
<li>Manipulate or read a big file</li>
</ul>
<p>They allow you to read and write data in chunks,
rather than all at once, which can be more efficient
for large amounts of data.</p>
<blockquote>
<p>Types</p>
</blockquote>
<ul>
<li>Writeable</li>
<li>Readable</li>
<li>DUpleax</li>
<li>Transform</li>
</ul>
<blockquote>
<p>Create a big file</p>
</blockquote>
<pre><code class="language-js">const { writeFileSync } = require('fs');
for (let i = 0; i &lt; 10000; i++) {
    writeFileSync('./content/big.txt', `hello world ${i}\n`, { flag: 'a' });
}
</code></pre>
<blockquote>
<p>Stream example</p>
</blockquote>
<pre><code class="language-js">const { createReadStream } = require('fs');

// default chunk size -&gt; 64kb
// highWaterMark - control size [Specify chunk size]
// Specify encoding to output in human readable
const stream = createReadStream('./content/big.txt', {
    encoding: 'utf8',
    highWaterMark: 9000
});

stream.on('data', (res) =&gt; {
    console.log(res);
});

stream.on('error', (err) =&gt; console.log(err));
</code></pre>
<blockquote>
<p>Stream HTTP</p>
</blockquote>
<pre><code class="language-js">var http = require('http');
var fs = require('fs');

http.createServer(function (req, res) {
    // const text = fs.readFileSync('./content/big.txt', 'utf8')
    // res.end(text)
    const fileStream = fs.createReadStream('./content/big.txt', 'utf8');
    fileStream.on('open', () =&gt; {
        fileStream.pipe(res);
    });
    fileStream.on('error', (err) =&gt; {
        res.end(err);
    });
}).listen(5000);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="node-ii"><a class="header" href="#node-ii">Node II</a></h1>
<p><strong>Difference b/w res.end() vs res.send()</strong></p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>res.end()</th><th>res.send()</th></tr>
</thead>
<tbody>
<tr><td>Used to end the response and send a body as response</td><td>used to send a response body</td></tr>
<tr><td>Cannot set header and status code</td><td>Automatically sets content-type header based on the data passed as an argument</td></tr>
<tr><td>Immediately terminates the connection with client</td><td>Waits for the response to be send and then terminates the connection</td></tr>
<tr><td>Cannot do this</td><td>Sets Eh-tag header which is used for cache validation</td></tr>
<tr><td>Used to end the response stream and flush any remaining data to the client synchronously. It does not return a promise.</td><td>Used to send data to the client asynchronously. It returns a promise that resolves when the data has been sent.</td></tr>
</tbody>
</table>
</div>
<h3 id="request"><a class="header" href="#request">Request</a></h3>
<p>Contains:</p>
<ul>
<li><strong>METHODS</strong></li>
<li><strong>URLS (endpoint/Resource to access)</strong></li>
<li><strong>Headers</strong></li>
<li><strong>Body(optional)</strong></li>
</ul>
<h3 id="response"><a class="header" href="#response">Response</a></h3>
<p>Contains:</p>
<ul>
<li><strong>Headers</strong></li>
<li><strong>Status code</strong></li>
<li><strong>Status message</strong></li>
<li><strong>Body(optional)</strong></li>
</ul>
<h3 id="reference"><a class="header" href="#reference">Reference</a></h3>
<ul>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status">Common HTTPCodes</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types">Common Mimetypes</a></p>
</li>
</ul>
<blockquote>
<p>What are headers in browser?</p>
</blockquote>
<p><strong>Headers contain important information such as the type of browser being used,
the language preferences of the user, the type of content being requested,
and any cookies or authentication tokens that may be required.</strong></p>
<h3 id="simple-http-server"><a class="header" href="#simple-http-server">Simple HTTP server</a></h3>
<pre><code class="language-js">const http = require('http');

const server = http.createServer((req, res) =&gt; {
    // Write header
    res.writeHead(200, { 'content-type': 'text/html' });

    // Write response body
    res.write('&lt;h1&gt;hello&lt;/h1&gt;');

    // End connection after body and response have been sent to the client
    res.end();
});

server.listen(5000, () =&gt; {
    console.log('Started!');
});
</code></pre>
<h3 id="reading-html-file"><a class="header" href="#reading-html-file">Reading HTML File</a></h3>
<pre><code class="language-js">const http = require('http');
const { readFileSync } = require('fs');

// Will be initialized only at server start and will not block
const somePage = readFileSync('path-to-html-file');

const server = http.createServer((req, res) =&gt; {
    console.log(req.url);
    // Write header
    res.writeHead(200, 'Doneman!', { 'content-type': 'text/html' });

    // Write response body
    res.write('&lt;h1&gt;hello&lt;/h1&gt;');

    // End connection after body and response have been sent to the client
    res.end();
});

server.listen(5000, () =&gt; {
    console.log('Started!');
});
</code></pre>
<h3 id="using-without-express"><a class="header" href="#using-without-express">Using without express</a></h3>
<blockquote>
<p>We need to handle all thr routing by ourselves,handle the locations of the static assets like css,js in our server etc,mention headers by ourselves.</p>
</blockquote>
<pre><code class="language-js">const http = require('http');
const { readFileSync } = require('fs');

// get all files
const homePage = readFileSync('./navbar-app/index.html');
const homeStyles = readFileSync('./navbar-app/styles.css');
const homeImage = readFileSync('./navbar-app/logo.svg');
const homeLogic = readFileSync('./navbar-app/browser-app.js');

const server = http.createServer((req, res) =&gt; {
    // console.log(req.method)
    const url = req.url;
    console.log(url);
    // home page
    if (url === '/') {
        res.writeHead(200, { 'content-type': 'text/html' });
        res.write(homePage);
        res.end();
    }
    // about page
    else if (url === '/about') {
        res.writeHead(200, { 'content-type': 'text/html' });
        res.write('&lt;h1&gt;about page&lt;/h1&gt;');
        res.end();
    }
    // styles
    else if (url === '/styles.css') {
        res.writeHead(200, { 'content-type': 'text/css' });
        res.write(homeStyles);
        res.end();
    }
    // image/logo
    else if (url === '/logo.svg') {
        res.writeHead(200, { 'content-type': 'image/svg+xml' });
        res.write(homeImage);
        res.end();
    }
    // logic
    else if (url === '/browser-app.js') {
        res.writeHead(200, { 'content-type': 'text/javascript' });
        res.write(homeLogic);
        res.end();
    }
    // 404
    else {
        res.writeHead(404, { 'content-type': 'text/html' });
        res.write('&lt;h1&gt;page not found&lt;/h1&gt;');
        res.end();
    }
});

server.listen(5000);
</code></pre>
<blockquote>
<p>Why use express js</p>
</blockquote>
<ul>
<li><strong>Provides us with many robust set of features</strong></li>
<li><strong>Handles routing</strong></li>
<li><strong>Provides us with many HTTP methods which we can use .</strong></li>
<li><strong>Provides us with middlewares.</strong></li>
</ul>
<h3 id="simple-express-app"><a class="header" href="#simple-express-app">Simple Express App</a></h3>
<pre><code class="language-js">const express = require('express');

const app = express();

// USE GET method
app.get('/', (req, res) =&gt; {
    res.status(200).send('&lt;h1&gt;hello&lt;/h1&gt;');
});

// res.all() is a method that sets up a route to handle all HTTP methods (GET, POST, PUT, DELETE, etc.) for a given path.
app.all('*', (req, res) =&gt; {
    res.status(404).send('&lt;h3&gt;Not Found&lt;/h3&gt;');
});

// Keep Listening for requests
app.listen(5000, () =&gt; {
    console.log('Listening .....');
});
</code></pre>
<h3 id="static-assests"><a class="header" href="#static-assests">Static assests</a></h3>
<ul>
<li>
<p><strong>If we do SSR we do not need to mention the index.html if our public folder has index.html as express will Automatically serve that file.</strong>
<strong>We can uncomment the lines path-to-index.</strong></p>
</li>
<li>
<p><strong>Note 1: For every <code>endpoints we must configure the corresponding methods allowed for it</code>
For example: if there is a route <code>/api/gt/gtx</code> we must define what to expect when there is
a get request,post request If there is <code>a get request we can display a html page</code> or if there
is <code>a post request we can respond back with json data</code>.</strong></p>
</li>
<li>
<p><strong>Note 2: Just keep in mind that staic assests are accesible via base root.Suppose in the
public folder we have folder css-&gt;fir.css.We can access it via &lt;domain&gt;/css/fir.css.
Just give the correct relative path in the html files.</strong></p>
</li>
</ul>
<pre><code class="language-js">const express = require('express');
const path = require('path');

const app = express();

// Make static files available by using below middleware
app.use(express.static('path-to-public-folder'));

// USE GET method
app.get('/', (req, res) =&gt; {
    res.sendFile(path.resolve(__dirname, 'path-to-index.html for this page'));
});

// res.all() is a method that sets up a route to handle all HTTP methods (GET, POST, PUT, DELETE, etc.) for a given path.
app.all('*', (req, res) =&gt; {
    res.status(404).send('&lt;h3&gt;Not Found&lt;/h3&gt;');
});

// Keep Listening for requests
app.listen(5000, () =&gt; {
    console.log('Listening .....');
});
</code></pre>
<h3 id="reading-files-and-then-sending"><a class="header" href="#reading-files-and-then-sending">Reading files and then sending</a></h3>
<pre><code class="language-js">const express = require('express');
const { readFileSync } = require('fs');

const data = readFileSync('./public/sec.html', 'utf8');
console.log(data);

const app = express();

app.use(express.static('./public'));
app.get('/', (req, res) =&gt; {
    res.send(data);
});

app.listen(5000, (req, res) =&gt; {
    console.log('Started ....');
});
</code></pre>
<h3 id="api-vs-ssr-difference"><a class="header" href="#api-vs-ssr-difference">API vs SSR difference</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>API</th><th>SSR</th></tr>
</thead>
<tbody>
<tr><td>We send data through json</td><td>We send data through templates</td></tr>
<tr><td>We use res.json()</td><td>We use res.render()</td></tr>
</tbody>
</table>
</div>
<h3 id="route-params"><a class="header" href="#route-params">Route Params</a></h3>
<pre><code class="language-js">const express = require('express');

const app = express();

app.get('/', (req, res) =&gt; {
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

// Single Route parameter
app.get('/api/v1/:productID', (req, res) =&gt; {
    // Get the route parameter (Slug)
    // Will be an object -&gt; {productID:3}
    console.log(req.params);

    return res.send('hello');
});

// Multiple Route parameters
app.get('/api/v1/:productID/review/:reviewID', (req, res) =&gt; {
    // Get the route parameter (Slug)
    // Will be an object -&gt; {productID:3,reviewID:3}
    console.log(req.params);

    return res.send('hello');
});

app.listen(5000, (req, res) =&gt; {
    console.log('Started ....');
});
</code></pre>
<h3 id="query-string"><a class="header" href="#query-string">Query String</a></h3>
<pre><code class="language-js">const express = require('express');

const app = express();

app.get('/', (req, res) =&gt; {
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

// Query String
app.get('/api/v1/query', (req, res) =&gt; {
    // on Putting-&gt; http://localhost:5000/api/v1/query?name=hello&amp;id=3
    // {name:"hello",id:3}
    console.log(req.query);

    return res.send('hello');
});

app.listen(5000, (req, res) =&gt; {
    console.log('Started ....');
});
</code></pre>
<h3 id="middlewares"><a class="header" href="#middlewares">Middlewares</a></h3>
<blockquote>
<p>What are middlewares in nodejs</p>
</blockquote>
<ul>
<li>
<p><strong>function that sits between the client and server and performs some operations on the incoming request or outgoing response.</strong></p>
</li>
<li>
<p><strong>It can modify the request/response, add new properties to them, or perform some other tasks before passing them to the next middleware</strong></p>
</li>
<li>
<p><strong>Middleware is used to handle common tasks such as authentication,</strong>
<strong>logging, error handling, and more.</strong></p>
</li>
<li>
<p><strong>handles a specific task or set of tasks during the</strong>
<strong>request-response cycle of an HTTP server</strong></p>
</li>
</ul>
<blockquote>
<p>Middleware basics</p>
</blockquote>
<pre><code class="language-js">const express = require('express');

const app = express();

// Express will pass the req,res,next to this middleware function automatically
const logger = (req, res, next) =&gt; {
    // Appending a useful value to request object
    req.user = 'johndoe';

    // Pass the control to the next middlewares
    next();
};

app.get('/', logger, (req, res) =&gt; {
    // Printing what middleware appended
    console.log(req.user);
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

app.listen(5000, (req, res) =&gt; {
    console.log('Started ....');
});
</code></pre>
<blockquote>
<p>Multi Middleware</p>
</blockquote>
<pre><code class="language-js">const express = require('express');

const app = express();

// Express will pass the req,res,next to this middleware function automatically
const logger = (req, res, next) =&gt; {
    console.log('Logger1');

    // Pass the control to the next middlewares
    next();
};

const logger2 = (req, res, next) =&gt; {
    console.log('Logger2');

    // Pass the control to the next middlewares
    next();
};

// Array is used for multi middlewares
app.get('/', [logger, logger2], (req, res) =&gt; {
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

app.listen(5000, (req, res) =&gt; {
    console.log('Started ....');
});
</code></pre>
<blockquote>
<p>All Routes Middleware</p>
</blockquote>
<pre><code class="language-js">const express = require('express');

const app = express();

const logger = (req, res, next) =&gt; {
    console.log(req.url);
    next();
};

// Will be used by all routes
app.use(logger);

app.get('/', (req, res) =&gt; {
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

app.get('/api/hello', (req, res) =&gt; {
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

app.get('/api/hello/world', (req, res) =&gt; {
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

app.all('*', (req, res) =&gt; {
    res.send('&lt;h1&gt;not found!&lt;/h1&gt;');
});

app.listen(5000, (req, res) =&gt; {
    console.log('Started ....');
});
</code></pre>
<blockquote>
<p>Route specific Middleware</p>
</blockquote>
<pre><code class="language-js">const express = require('express');

const app = express();

const logger = (req, res, next) =&gt; {
    console.log(req.url);
    next();
};

// Will be used by all routes starting with "/api"
app.use('/api', logger);

app.get('/', (req, res) =&gt; {
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

app.get('/xyz', (req, res) =&gt; {
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

// logger will be used here
app.get('/api/hello', (req, res) =&gt; {
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

// logger will be used here
app.get('/api/hello/world', (req, res) =&gt; {
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

app.all('*', (req, res) =&gt; {
    res.send('&lt;h1&gt;not found!&lt;/h1&gt;');
});

app.listen(5000, (req, res) =&gt; {
    console.log('Started ....');
});
</code></pre>
<h3 id="http-methods"><a class="header" href="#http-methods">HTTP Methods</a></h3>
<pre><code class="language-js">const express = require('express');

const app = express();

app.get('/', (req, res) =&gt; {
    res.send('&lt;h1&gt;hello&lt;/h1&gt;');
});

// parse json [Javascript/Postman type submitted data]
app.use(express.json());

// Post request specific
app.post('/api/people', (req, res) =&gt; {
    // Will print the json send from Postman type app
    console.log(req.body);
    res.status(201).json(req.body);
});

app.listen(5000, (req, res) =&gt; {
    console.log('Started ....');
});
</code></pre>
<p><strong>Note : Try using a MVC (Model View Controller to structure node projects)</strong></p>
<h3 id="express-router"><a class="header" href="#express-router">Express router</a></h3>
<p><strong>Note: Create a folder named routes</strong></p>
<blockquote>
<p>router-people.js</p>
</blockquote>
<pre><code class="language-js">const express = require('express');
const router = express.Router();

const {
    getPeople,
    createPerson,
    createPersonPostman,
    updatePerson,
    deletePerson
} = require('../controllers/people');

router.get('/', getPeople);
router.post('/', createPerson);
router.post('/postman', createPersonPostman);
router.put('/:id', updatePerson);
router.delete('/:id', deletePerson);

router.route('/').get(getPeople).post(createPerson);
router.route('/postman').post(createPersonPostman);
router.route('/:id').put(updatePerson).delete(deletePerson);

module.exports = router;
</code></pre>
<h3 id="express-controllers"><a class="header" href="#express-controllers">Express controllers</a></h3>
<p><strong>Note: Create a folder named controllers</strong></p>
<pre><code class="language-js">// No need to import anything

const createPerson = (req, res) =&gt; {
    const { name } = req.body;
    if (!name) {
        return res
            .status(400)
            .json({ success: false, msg: 'please provide name value' });
    }
    res.status(201).send({ success: true, person: name });
};

module.exports = {
    createPerson
};
</code></pre>
<blockquote>
<p>app.js</p>
</blockquote>
<pre><code class="language-js">const express = require('express');
const app = express();

const people = require('./routes/people');
const auth = require('./routes/auth');

// static assets
app.use(express.static('./methods-public'));
// parse form data
app.use(express.urlencoded({ extended: false }));
// parse json
app.use(express.json());

app.use('/api/people', people);
app.use('/login', auth);

app.listen(5000, () =&gt; {
    console.log('Server is listening on port 5000....');
});
</code></pre>
<h3 id="sending-cookies-with-expressjs"><a class="header" href="#sending-cookies-with-expressjs">Sending Cookies with expressJS</a></h3>
<pre><code class="language-js">res.cookie('name', 'john', {
    httpOnly: true,
    sameSite: 'strict',
    maxAge: 2 * 3600 * 1000
});
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="a-basic-app-with-nodejsprisma"><a class="header" href="#a-basic-app-with-nodejsprisma">A Basic App with nodejs+prisma</a></h1>
<h3 id="install-express-and-prisma"><a class="header" href="#install-express-and-prisma">Install express and prisma</a></h3>
<pre><code class="language-sh">npm i @prisma/client express dotenv nodemon
</code></pre>
<h3 id="add-to-packagejson"><a class="header" href="#add-to-packagejson">Add to package.json</a></h3>
<pre><code class="language-json">"scripts": {
    "dev": "nodemon index.js"
},
</code></pre>
<h3 id="initialize-prisma-project"><a class="header" href="#initialize-prisma-project">Initialize Prisma project</a></h3>
<pre><code class="language-sh">npx prisma init
</code></pre>
<h3 id="env-variables"><a class="header" href="#env-variables">ENV Variables</a></h3>
<pre><code>DATABASE_URL="postgresql://postgres:@localhost:5432/postdb?schema=public"
CHECKPOINT_DISABLE=1
</code></pre>
<blockquote>
<p>Documentation Links</p>
</blockquote>
<ul>
<li>
<p><a href="https://www.prisma.io/docs/orm/reference/prisma-cli-reference">cli Reference</a></p>
</li>
<li>
<p><a href="https://www.prisma.io/docs/orm/reference/prisma-client-reference">client Reference</a></p>
</li>
</ul>
<h2 id="modelschema"><a class="header" href="#modelschema">Model/Schema</a></h2>
<blockquote>
<p>prisma/schema.prisma</p>
</blockquote>
<pre><code class="language-prisma">generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User{
    id Int @id @default(autoincrement())
    email String
    posts Post[]
}

model Post{
    id Int @id @default(autoincrement())
    updatedAt DateTime @default(now())
    createdAt DateTime @updatedAt
    title String @db.VarChar(255)
    desc String @db.Text()
    author User @relation(fields: [authorId],references: [id])
    authorId Int
}
</code></pre>
<blockquote>
<p>Run migration</p>
</blockquote>
<pre><code class="language-sh">npx prisma migrate dev --name init
</code></pre>
<h2 id="controllers"><a class="header" href="#controllers">Controllers</a></h2>
<blockquote>
<p>controllers/posts.js</p>
</blockquote>
<pre><code class="language-js">const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

const createPost = async (req, res) =&gt; {
    const result = await prisma.post.create({
        data: req.body
    });
    res.json(result);
};

const updatePost = async (req, res) =&gt; {
    const result = await prisma.post.findFirst({
        where: { id: parseInt(req.params.id) }
    });

    if (result) {
        const result = await prisma.post.update({
            where: { id: parseInt(req.params.id) },
            data: req.body
        });
        return res.json(result);
    }
    return res.json({ msg: 'No Such Record!' });
};

const deletePost = async (req, res) =&gt; {
    const result = await prisma.post.findFirst({
        where: { id: parseInt(req.params.id) }
    });
    if (result) {
        const result = await prisma.post.delete({
            where: { id: parseInt(req.params.id) }
        });
        return res.json(result);
    }
    return res.json({ msg: 'No Such Record!' });
};

const getAllPost = async (req, res) =&gt; {
    const result = await prisma.post.findMany();
    res.json(result);
};

const getPost = async (req, res) =&gt; {
    console.log(req.params.id);
    const result = await prisma.post.findMany({
        where: { id: parseInt(req.params.id) }
    });
    res.json(result);
};

module.exports = { createPost, updatePost, deletePost, getAllPost, getPost };
</code></pre>
<h2 id="routes"><a class="header" href="#routes">Routes</a></h2>
<blockquote>
<p>routes/posts.js</p>
</blockquote>
<pre><code class="language-js">const {
    getPost,
    getAllPost,
    createPost,
    updatePost,
    deletePost
} = require('../controllers/post');

const express = require('express');
const router = express.Router();

// Get all post
router.get('/', getAllPost);

// Get post by id [with path parameter]
router.get('/:id', getPost);

// Create post
router.post('/', createPost);

// Update post
router.put('/:id', updatePost);

// Delete post
router.delete('/:id', deletePost);

module.exports = router;
</code></pre>
<h2 id="app"><a class="header" href="#app">App</a></h2>
<blockquote>
<p>index.js</p>
</blockquote>
<pre><code class="language-js">const express = require('express');
const dotenv = require('dotenv');
const post = require('./routes/post');

dotenv.config();
const app = express();

app.use(express.json());
app.use('/api/v1/post', post);

app.listen(5000, () =&gt; {
    console.log('hello');
});
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="graphql-basics-with-apolloserver-and-nodejs"><a class="header" href="#graphql-basics-with-apolloserver-and-nodejs">GraphQL Basics with Apolloserver and nodeJS</a></h1>
<h3 id="install-dependencies"><a class="header" href="#install-dependencies">Install Dependencies</a></h3>
<pre><code class="language-sh">npm i @apollo/server graphql nodemon
</code></pre>
<h3 id="add-to-packagejson-1"><a class="header" href="#add-to-packagejson-1">Add to package.json</a></h3>
<pre><code class="language-json">"scripts": {
    "dev": "nodemon index.js"
},
</code></pre>
<h3 id="basic-apolloserver-with-hello-query"><a class="header" href="#basic-apolloserver-with-hello-query">Basic Apolloserver with hello query</a></h3>
<pre><code class="language-js">const { ApolloServer } = require('@apollo/server');
const { startStandaloneServer } = require('@apollo/server/standalone');

// Type Definations
const typeDefs = `#graphql
    type Query{
    hello:String!
    }
`;

// Function to call for queries and mutations
const resolvers = {
    Query: {
        hello: () =&gt; 'hello'
    }
};

// Start Apollo Server
const run = async () =&gt; {
    const server = new ApolloServer({ typeDefs, resolvers });
    const { url } = await startStandaloneServer(server, {
        listen: { port: 4000 }
    });
    return url;
};

run()
    .then((url) =&gt; {
        console.log(`Started Server at ${url}`);
    })
    .catch((err) =&gt; {
        console.log(err);
    });
</code></pre>
<h3 id="basics-of-queries-and-mutations"><a class="header" href="#basics-of-queries-and-mutations">Basics of queries and mutations</a></h3>
<pre><code class="language-js">const { ApolloServer } = require('@apollo/server');
const { startStandaloneServer } = require('@apollo/server/standalone');

// Type Definations [Schema]
const typeDefs = `#graphql

    # Normal Types
    type Errors{
    msg:String!
    code:Int!
    }

    type RegisterResponse{
    email:String
    password:String
    errors:[Errors]
    }

    type User{
    email:String
    password:String
    }

    # Input Type
    input UserInfo{
    email:String
    password:String
    }

    # Query Type [Used for quering,filtering,fetching]
    type Query{
    hello:String!
    getall:[User]
    }

    # Mutation type [Used for updating,creating,deleting]
    type Mutation{
    # Normal Way of taking input/arguments
    # register(email:String!,password:String!):RegisterResponse

    # Taking input/arguments using objects
    register(userinfo:UserInfo):RegisterResponse
    }

`;

// Function to call for queries and mutations
const resolvers = {
    Query: {
        hello: () =&gt; 'hello',
        getall: () =&gt; {
            return [{ email: 'asd', password: 'dsa' }];
        }
    },
    Mutation: {
        register: () =&gt; {
            return {
                email: 'xyz',
                password: 'xuz',
                errors: [{ msg: 'hello', code: 201 }]
            };
        }
    }
};

// Start Apollo Server
const run = async () =&gt; {
    const server = new ApolloServer({ typeDefs, resolvers });
    const { url } = await startStandaloneServer(server, {
        listen: { port: 4000 }
    });
    return url;
};

run()
    .then((url) =&gt; {
        console.log(`Started Server at ${url}`);
    })
    .catch((err) =&gt; {
        console.log(err);
    });
</code></pre>
<h3 id="resolver-arguments"><a class="header" href="#resolver-arguments">Resolver arguments</a></h3>
<blockquote>
<p>In Apollo GraphQL each resolver has access to 4 args which are as follows:</p>
</blockquote>
<ul>
<li>parent : Parent object value of the previous resolver.</li>
<li>args : Arguments passed to this resolver</li>
<li>context : A global value accesible to all resolvers.A custom object each resolver can read from/write to.</li>
<li>info : Parsed GraphQL query , mutation , subscription string [AST of the incoming request]</li>
</ul>
<pre><code class="language-js">const { ApolloServer } = require('@apollo/server');
const { startStandaloneServer } = require('@apollo/server/standalone');

// Type Definations [Schema]
const typeDefs = `#graphql

    # Normal Types
    type Errors{
    msg:String!
    code:Int!
    }

    type RegisterResponse{
    email:String
    password:String
    errors:[Errors]
    }

    type User{
    email:String
    password:String
    }

    # Input Type
    input UserInfo{
    email:String
    password:String
    }

    # Query Type [Used for quering,filtering,fetching]
    type Query{
    hello:String!
    getall:[User]
    }

    # Mutation type [Used for updating,creating,deleting]
    type Mutation{
    # Normal Way of taking input/arguments
    # register(email:String!,password:String!):RegisterResponse

    # Taking input/arguments using objects
    register(userinfo:UserInfo):RegisterResponse
    }

`;

// Function to call for queries and mutations
const resolvers = {
    User: {
        // We can have resolver for email too i.e. what to do when we see email [PARENT]
        email: (parent) =&gt; {
            console.log(parent);
            return parent.email.toUpperCase();
        }
    },
    Query: {
        hello: () =&gt; 'hello',
        getall: () =&gt; {
            return [{ email: 'asd', password: 'dsa' }];
        }
    },
    Mutation: {
        // Resolvers fn can be async
        register: async (parent, args, ctx, info) =&gt; {
            console.log(info); // [info]
            console.log(args); // [args]
            return {
                email: 'xyz',
                password: 'xuz',
                errors: [{ msg: 'hello', code: 201 }]
            };
        }
    }
};

// Start Apollo Server
const run = async () =&gt; {
    const server = new ApolloServer({ typeDefs, resolvers });
    const { url } = await startStandaloneServer(server, {
        listen: { port: 4000 },
        // Passing context [CONTEXT]
        context: async ({ req, res }) =&gt; {
            return { name: 'asd', id: '1' };
        }
    });
    return url;
};

run()
    .then((url) =&gt; {
        console.log(`Started Server at ${url}`);
    })
    .catch((err) =&gt; {
        console.log(err);
    });
</code></pre>
<h3 id="fragments-and-aliases"><a class="header" href="#fragments-and-aliases">Fragments and aliases</a></h3>
<pre><code class="language-gql">{
Userl: user(id: 1) {

...userFields

}

User2: user(id: 2) {
...userFields

}

i

fragment userFields on Person {
name
email

}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="typescript"><a class="header" href="#typescript">Typescript</a></h1>
<h2 id="typescript-basics"><a class="header" href="#typescript-basics">Typescript Basics</a></h2>
<h3 id="compiling"><a class="header" href="#compiling">Compiling</a></h3>
<pre><code class="language-sh">tsc &lt;name_of_file&gt;
</code></pre>
<h3 id="variables"><a class="header" href="#variables">Variables</a></h3>
<pre><code class="language-ts">// Explicit type defination

// Number
const a: Number = 5.45;

// Objects
interface User {
    name: String;
    id?: Number; // Optional Field
}

const obj: User = {
    name: 'asda'
};

// Adding the id field later
obj.id = 2;
</code></pre>
<h3 id="functions"><a class="header" href="#functions">Functions</a></h3>
<pre><code class="language-ts">type AddFunc = (x: number, y: number) =&gt; number;

const add1: AddFunc = (x: number, y: number) =&gt; {
    return x + y;
};

const add2 = (obj: { a: number; b: number }) =&gt; {
    return obj.a + obj.b;
};
</code></pre>
<h3 id="unions"><a class="header" href="#unions">Unions</a></h3>
<pre><code class="language-ts">// Unions Types
const fn = (x: string | number) =&gt; x;

console.log(fn('sad'));
console.log(fn(11));

interface Cat {
    purr: string;
}

interface Dog {
    bark: string;
}

type dog_cat = (Cat &amp; Dog) | number;

let obj: dog_cat = {
    purr: 'purr',
    bark: 'bark'
};

obj = 5;
</code></pre>
<h3 id="casting"><a class="header" href="#casting">Casting</a></h3>
<pre><code class="language-ts">// Use &lt;&gt; angular brackets
let a = 5;
console.log(&lt;number&gt;a);

// Use "as" keyword for casting
console.log(a as number);
</code></pre>
<h3 id="any"><a class="header" href="#any">Any</a></h3>
<pre><code class="language-ts">// Input any data-type and return data as any datatype
const fn = (x: any): any =&gt; x;
</code></pre>
<h2 id="typescript-nodejs"><a class="header" href="#typescript-nodejs">Typescript NodeJS</a></h2>
<h3 id="install-dependencies-1"><a class="header" href="#install-dependencies-1">Install Dependencies</a></h3>
<pre><code class="language-sh">npm init -y
npm i typescript --save-dev
npm i @types/node --save-dev
npm i nodemon ts-node --save-dev
npx tsc --init
</code></pre>
<h3 id="note"><a class="header" href="#note">Note</a></h3>
<ul>
<li><strong>Files with cts must be imported with cjs [es5 using files exporting using module.exports]</strong></li>
<li><strong>Files with ts must be imported with js [es6 using files]</strong></li>
</ul>
<blockquote>
<p>package.json</p>
</blockquote>
<pre><code class="language-json">"type": "module",
"scripts": {
    "build": "tsc",
    "start": "tsc --watch &amp; node --watch dist/index.js"
},
</code></pre>
<blockquote>
<p>tsconfig.json</p>
</blockquote>
<pre><code class="language-json">{
    "compilerOptions": {
        "module": "NodeNext", // NodeNext (ES6), Commonjs (ES5)
        "moduleResolution": "NodeNext",
        "esModuleInterop": true,
        "target": "ES5", // Javascript version our ts code will be compiled to
        "sourceMap": true,
        "outDir": "dist",
        "rootDir": "src"
    },
    "include": ["src/**/*"]
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="nodejs--apollo-graphql--typescript--postgressql"><a class="header" href="#nodejs--apollo-graphql--typescript--postgressql">NodeJS + Apollo GraphQL + Typescript + PostgresSQL</a></h1>
<h3 id="install-dependencies-2"><a class="header" href="#install-dependencies-2">Install Dependencies</a></h3>
<pre><code class="language-sh">npm init -y
npm i typescript @types/node --save-dev
npm i @apollo/server graphql dotenv @types/dotenv
npm i nodemailer @types/nodemailer
touch tsconfig.json
npx prisma init
</code></pre>
<p>** Add the following to below files : **</p>
<blockquote>
<p>tsconfig.json</p>
</blockquote>
<pre><code class="language-json">{
    "compilerOptions": {
        "module": "NodeNext", // NodeNext (ES6), Commonjs (ES5)
        "moduleResolution": "NodeNext",
        "esModuleInterop": true,
        "target": "ES5", // Javascript version our ts code will be compiled to
        "sourceMap": true,
        "outDir": "dist",
        "rootDir": "src"
    },
    "include": ["src/**/*"]
}
</code></pre>
<blockquote>
<p>package.json</p>
</blockquote>
<pre><code class="language-json">"type": "module",
"scripts": {
    "build": "tsc",
    "start": "tsc --watch &amp; node --watch dist/index.js"
},
</code></pre>
<blockquote>
<p>prisma/schema.prisma</p>
</blockquote>
<pre><code class="language-prisma">// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User{
    id Int @id @default(autoincrement())
    name String
    email String
    password String
    posts Post[]
}

model Post{
    id Int @id @default(autoincrement())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    title String
    desc String
    author User @relation(fields: [authorid], references:[id])
    authorid Int
}
</code></pre>
<blockquote>
<p>Run migrations</p>
</blockquote>
<pre><code class="language-sh">npx prisma migrate dev --name init
</code></pre>
<h3 id="main-app"><a class="header" href="#main-app">Main App</a></h3>
<blockquote>
<p>src/index.ts</p>
</blockquote>
<pre><code class="language-ts">import { ApolloServer } from '@apollo/server';
import { startStandaloneServer } from '@apollo/server/standalone';
import { config } from 'dotenv';
import { typeDefs } from './schema.js';
import { resolvers } from './resolvers.js';

config();

const run = async () =&gt; {
    const server = new ApolloServer({ typeDefs, resolvers });
    const { url } = await startStandaloneServer(server, {
        listen: {
            port: 4000
        }
    });
    return url;
};

run()
    .then((url) =&gt; {
        console.log(`Started Server at ${url}`);
    })
    .catch((err) =&gt; {
        console.log(err);
    });
</code></pre>
<blockquote>
<p>src/schema.ts</p>
</blockquote>
<pre><code class="language-ts">export const typeDefs = `#graphql
    type User{
        id:ID
        name:String
        email:String
    }

    type Post{
        id:ID
        createdAt : String
        updatedAt : String
        title: String
        desc: String
        authorid:ID

    }

    type Query{
        getalluser:[User]
        getuserbyid(id:ID):User
        getallposts:[Post]
        getpostbyauthor(id:ID):[Post]
        getpostbyid(id:ID):Post
    }

    type resp  {
        err:Error
        user:User
    }

    type Error{
        msg:String!
    }

    input registerinfo{
        name:String!
        email:String!
        password:String!
    }

    input logininfo{
        email:String!
        password:String!
    }

    input createpostinfo{
        authorid:ID!
        title:String!
        desc:String!
    }

    input updatepostinfo{
        postid:ID!
        title:String
        desc:String
    }

    input resetpass{
        id:ID!
        email:String!
        password:String!
    }


    type Mutation{
        register(userinfo:registerinfo):resp
        login(logininfo:logininfo):resp
        createpost(info:createpostinfo):Post
        updatepost(upinfo:updatepostinfo):Post
        deletepost(id:ID):Post
        sendforgetpassmail(email:String!):Boolean
        resetpassword(info:resetpass):resp
    }

`;
</code></pre>
<blockquote>
<p>src/resolvers.ts</p>
</blockquote>
<pre><code class="language-ts">import { PrismaClient } from '@prisma/client';
import nodemailer from 'nodemailer';

const prisma = new PrismaClient();

export const resolvers = {
    Query: {
        getalluser: async () =&gt; {
            const data = await prisma.user.findMany({
                select: {
                    id: true,
                    name: true,
                    email: true
                }
            });
            return data;
        },
        getuserbyid: async (_, { id }) =&gt; {
            const data = await prisma.user.findFirst({
                select: {
                    id: true,
                    name: true,
                    email: true
                },
                where: {
                    id: parseInt(id)
                }
            });
            return data;
        },
        getallposts: async () =&gt; {
            const data = await prisma.post.findMany({
                select: {
                    id: true,
                    createdAt: true,
                    updatedAt: true,
                    title: true,
                    desc: true,
                    authorid: true
                }
            });
            return data;
        },
        getpostbyauthor: async (_, { id }) =&gt; {
            const data = await prisma.post.findMany({
                select: {
                    id: true,
                    createdAt: true,
                    updatedAt: true,
                    title: true,
                    desc: true,
                    authorid: true
                },
                where: {
                    authorid: parseInt(id)
                }
            });
            return data;
        },
        getpostbyid: async (_, { id }) =&gt; {
            const data = await prisma.post.findFirst({
                select: {
                    id: true,
                    createdAt: true,
                    updatedAt: true,
                    title: true,
                    desc: true,
                    authorid: true
                },

                where: { id: parseInt(id) }
            });
            return data;
        }
    },
    Mutation: {
        register: async (_, { userinfo: { name, email, password } }) =&gt; {
            // Check user exist
            const finduser = await prisma.user.findFirst({
                select: {
                    id: true,
                    name: true,
                    email: true
                },
                where: { email: email }
            });
            if (finduser) {
                return {
                    user: null,
                    err: {
                        msg: 'Email exists! Please use a different email address!'
                    }
                };
            } else {
                const user = await prisma.user.create({
                    data: {
                        email,
                        name,
                        password
                    }
                });
                return {
                    user: {
                        id: user.id,
                        name: user.name,
                        email: user.email
                    },
                    err: null
                };
            }
        },
        login: async (_, { logininfo: { email, password } }) =&gt; {
            // Check user exist
            const finduser = await prisma.user.findFirst({
                select: {
                    id: true,
                    name: true,
                    email: true
                },
                where: { email: email, password: password }
            });
            if (!finduser) {
                return {
                    user: null,
                    err: {
                        msg: 'Please enter correct email and password!'
                    }
                };
            } else {
                return {
                    user: {
                        id: finduser.id,
                        name: finduser.name,
                        email: finduser.email
                    },
                    err: null
                };
            }
        },
        createpost: async (_, { info: { authorid, title, desc } }) =&gt; {
            const createpost = await prisma.post.create({
                data: {
                    title,
                    desc,
                    authorid: parseInt(authorid)
                }
            });
            return {
                id: createpost.id,
                createdAt: createpost.createdAt,
                updatedAt: createpost.updatedAt,
                title: createpost.title,
                desc: createpost.desc,
                authorid: createpost.authorid
            };
        },
        updatepost: async (_, { upinfo: { postid, title, desc } }) =&gt; {
            const updatepost = await prisma.post.update({
                where: {
                    id: parseInt(postid)
                },
                data: {
                    title,
                    desc
                }
            });

            return {
                id: updatepost.id,
                createdAt: updatepost.createdAt,
                updatedAt: updatepost.updatedAt,
                title: updatepost.title,
                desc: updatepost.desc,
                authorid: updatepost.authorid
            };
        },
        deletepost: async (_, { id }) =&gt; {
            const updatepost = await prisma.post.delete({
                where: {
                    id: parseInt(id)
                }
            });

            return {
                id: updatepost.id,
                createdAt: updatepost.createdAt,
                updatedAt: updatepost.updatedAt,
                title: updatepost.title,
                desc: updatepost.desc,
                authorid: updatepost.authorid
            };
        },
        sendforgetpassmail: async (_, { email }) =&gt; {
            // Only needed if you don't have a real mail account for testing
            // let testAccount = await nodemailer.createTestAccount();
            // console.log(testAccount);

            // Future -&gt; Check if user exists and then only send mail

            let user = 'q3oqwlgga4verudl@ethereal.email';
            let pass = 'RHXPUjDXYjnAGsG98e';

            // create reusable transporter object using the default SMTP transport
            let transporter = nodemailer.createTransport({
                host: 'smtp.ethereal.email',
                port: 587,
                secure: false, // true for 465, false for other ports
                auth: {
                    user: user, // generated ethereal user
                    pass: pass // generated ethereal password
                }
            });

            // send mail with defined transport object
            let info = await transporter.sendMail({
                from: `${user}`, // sender address
                to: 'bar@example.com, baz@example.com', // list of receivers
                subject: 'Hello ✔', // Subject line
                text: 'Hello world?', // plain text body
                html: '&lt;b&gt;Hello world?&lt;/b&gt;', // html body
                attachments: [
                    {
                        filename: 'hello.json',
                        content: JSON.stringify({
                            name: 'Hello World!'
                        })
                    }
                ]
            });
            console.log('Message sent: %s', info.messageId);

            // Preview only available when sending through an Ethereal account
            console.log('Preview URL: %s', nodemailer.getTestMessageUrl(info));

            return true;
        },
        resetpassword: async (_, { info: { email, password, id } }) =&gt; {
            const finduser = await prisma.user.update({
                where: {
                    email,
                    id: parseInt(id)
                },
                data: {
                    password
                }
            });
            return {
                user: {
                    id: finduser.id,
                    name: finduser.name,
                    email: finduser.email
                },
                err: null
            };
        }
    }
};
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="sql"><a class="header" href="#sql">SQL</a></h1>
<ul>
<li>Domain Specific (Can be used in RDBMS only)</li>
<li>Declarative Language (We have to mention just what to do not how to do)</li>
</ul>
<h2 id="types-of-sql-commands"><a class="header" href="#types-of-sql-commands">Types of SQL commands</a></h2>
<ul>
<li>DDL (Works with schema/structure) : CREATE,ALTER,DROP</li>
<li>DML (Works with data inside the database schema) : INSERT,UPDATE,DELETE,SELECT</li>
<li>DCL (Works with authorization purposes) : GRANT , REVOKE</li>
<li>TCL (Transcation realated) : COMMIT , ROLLBACK , SAVEPOINTS</li>
<li>DQL (Data Query Language) : SELECT</li>
</ul>
<h3 id="create-table"><a class="header" href="#create-table">CREATE table</a></h3>
<p>Link : https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-create-table/</p>
<pre><code class="language-sql">CREATE TABLE [IF NOT EXISTS] table_name (
   column1 datatype(length) column_contraint,
   column2 datatype(length) column_contraint,
   column3 datatype(length) column_contraint,
   table_constraints
);

</code></pre>
<h3 id="insert-into-table"><a class="header" href="#insert-into-table">INSERT into table</a></h3>
<p>Link : https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-insert/</p>
<pre><code class="language-sql">
INSERT INTO table_name(column1, column2, …)
VALUES (value1, value2, …);
</code></pre>
<h3 id="alter-table"><a class="header" href="#alter-table">ALTER TABLE</a></h3>
<p>Link : https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-alter-table/</p>
<pre><code class="language-sql">ALTER TABLE table_name action;
</code></pre>
<h3 id="update"><a class="header" href="#update">UPDATE</a></h3>
<p>Link : https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-update/</p>
<pre><code class="language-sql">UPDATE table_name
SET column1 = value1,
    column2 = value2,
    ...
WHERE condition;
</code></pre>
<h3 id="difference-bw-alter-and-update"><a class="header" href="#difference-bw-alter-and-update">Difference b/w ALTER and UPDATE</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>ALTER</th><th>UPDATE</th></tr>
</thead>
<tbody>
<tr><td>DDL</td><td>DML</td></tr>
<tr><td>Works with structure schema</td><td>Works with change in data</td></tr>
<tr><td>Example : Renaming a column,Changing datatype of a column,droping a column</td><td>Update a value inside the column.</td></tr>
<tr><td>No condition</td><td>Can give condition with where clause</td></tr>
</tbody>
</table>
</div>
<h3 id="delete"><a class="header" href="#delete">DELETE</a></h3>
<p>Link : https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-delete/</p>
<pre><code class="language-sql">DELETE FROM table_name
WHERE condition;
</code></pre>
<h3 id="drop"><a class="header" href="#drop">DROP</a></h3>
<p>Link : https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-drop-table/</p>
<pre><code class="language-sql">DROP TABLE [IF EXISTS] table_name
[CASCADE | RESTRICT];
</code></pre>
<h3 id="truncate"><a class="header" href="#truncate">TRUNCATE</a></h3>
<p>Link : https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-truncate-table/</p>
<pre><code class="language-sql">TRUNCATE TABLE table_name;
</code></pre>
<h3 id="difference-bw-deletedroptruncate"><a class="header" href="#difference-bw-deletedroptruncate">Difference b/w DELETE,DROP,TRUNCATE</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>DELETE</th><th>DROP</th><th>TRUNCATE</th></tr>
</thead>
<tbody>
<tr><td>DML</td><td>DDL</td><td>DDL</td></tr>
<tr><td>Deletes only rows row</td><td>Deletes every row+schema</td><td>Deletes only rows</td></tr>
<tr><td>Deletes rows one by one (can give where clause)</td><td>-</td><td>Deletes rows in one go</td></tr>
<tr><td>Slower, Rollback possible if done before commit as it maintains logs</td><td>-</td><td>Faster, Rollback not possible as it maintains no logs</td></tr>
</tbody>
</table>
</div>
<h3 id="constraints"><a class="header" href="#constraints">Constraints</a></h3>
<ul>
<li><code>UNIQUE</code> (For unique values)</li>
<li><code>NOT NULL</code> (non-empty values)</li>
<li><code>PRIMARY KEY</code> (Unique + not null values)</li>
<li><code>FOREIGN KEY</code> (Maintains Referential Integrity)</li>
<li><code>CHECK</code> (Suppose we want to check the age of person during registration process in a website before inserting into the table)</li>
<li><code>DEFAULT</code> (default values if we do not give any values)</li>
</ul>
<h2 id="architectures-in-database"><a class="header" href="#architectures-in-database">Architectures in Database</a></h2>
<h3 id="1-tier-architecture"><a class="header" href="#1-tier-architecture">1 tier architecture</a></h3>
<ul>
<li>Only database layer</li>
<li>Example : MS Office,Paint,Photoshop</li>
</ul>
<h3 id="2-tier-architecture"><a class="header" href="#2-tier-architecture">2 tier architecture</a></h3>
<ul>
<li>Client layer &amp; database layer</li>
<li>Not scalable,not secure</li>
<li>Heavy load on database layer</li>
<li>Example : Suppose we go to a bank to create an account,we fill the form then give the accountant the form
and then accountant from his/her client machine will register our details or in this case data is pushed
to the database layer.</li>
</ul>
<h3 id="3-tier-architecture"><a class="header" href="#3-tier-architecture">3 tier architecture</a></h3>
<ul>
<li>Client layer , Application/Business layer , &amp; database layer</li>
<li>scalable,secure</li>
<li>Example : Suppose we we use the official bank mobile app (acts as an interface) to create an account ,then all the details will
first go to the Application/Business layer where the details will be processed and then data is pushed into the database layer.</li>
</ul>
<h2 id="different-keys"><a class="header" href="#different-keys">Different Keys</a></h2>
<h3 id="candidate-keys"><a class="header" href="#candidate-keys">Candidate keys</a></h3>
<p><strong>Set of keys/attributes which have the potential of being the primary key (Uniqe + can be null)</strong></p>
<p>Example : voter id, social security number, phone number can be the candidates for being primary keys</p>
<h3 id="primary-keys"><a class="header" href="#primary-keys">Primary keys</a></h3>
<p>Used to uniquely identify tuples in a table (Unique + not null)</p>
<p><b> Note : There can only be one primary key per table.</b></p>
<h3 id="foreign-keys"><a class="header" href="#foreign-keys">Foreign keys</a></h3>
<p>It is an attribute or set of attribute which references the primary key of same or another table.
Primarily Used for maintaining referential integrity.</p>
<p>Link : https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-foreign-key/</p>
<pre><code class="language-sql">[CONSTRAINT fk_name]
   FOREIGN KEY(fk_columns)
   REFERENCES parent_table(parent_key_columns)
   [ON DELETE delete_action]
   [ON UPDATE update_action]
</code></pre>
<p><b>Parent Table (Referenced Table)</b></p>
<ul>
<li>Insert : No violation</li>
<li>Update and Delete : May cause violation</li>
</ul>
<p><b>Child Table (Referencing Table)</b></p>
<ul>
<li>Insert : May cause Violation</li>
<li>Delete : No violation</li>
<li>Update : May cause violation</li>
</ul>
<p><b>PostgreSQL supports the following actions:</b></p>
<ul>
<li>SET NULL</li>
<li>SET DEFAULT</li>
<li>RESTRICT</li>
<li>NO ACTION</li>
<li>CASCADE</li>
</ul>
<p><b> Note : There can only be more than one foreign key per table.</b></p>
<h3 id="difference-between-restrict-and-no-action"><a class="header" href="#difference-between-restrict-and-no-action">Difference between RESTRICT and NO ACTION</a></h3>
<p>RESTRICT blocks updates that would violate the referential integrity of the constraint, while NO ACTION allows updates to proceed without enforcing the constraint.</p>
<h3 id="super-key"><a class="header" href="#super-key">Super Key</a></h3>
<p>Supeset of any candidate key (all possible values to uniquely identify two tuples in a table)</p>
<p>Formula : 2^n-k-(2^n-commonsets) , k no of candiate keys</p>
<h3 id="difference-bw-nested-subqueries--correlated-subqueries"><a class="header" href="#difference-bw-nested-subqueries--correlated-subqueries">Difference b/w Nested Subqueries , Correlated Subqueries</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Nested</th><th>Correlated</th></tr>
</thead>
<tbody>
<tr><td>Inner query runs first once and acts as a result for the outer query</td><td>Outer query runs first and for each outer query inner query runs multiple times</td></tr>
<tr><td>Example : IN , NOT IN</td><td>Example : EXISTS , NOT EXISTS</td></tr>
<tr><td>Bottom up approach</td><td>Top Down approach</td></tr>
</tbody>
</table>
</div>
<h3 id="common-things-to-do"><a class="header" href="#common-things-to-do">Common things to do</a></h3>
<ul>
<li>Aggreagte Functions</li>
<li>Nested,Correlated [Subqueries]</li>
<li>GROUP BY</li>
<li>HAVING</li>
<li>IN , NOT IN</li>
<li>EXISTS , NOT EXISTS</li>
</ul>
<h3 id="varchar-vs-varchar2"><a class="header" href="#varchar-vs-varchar2">Varchar vs Varchar2</a></h3>
<ul>
<li>Varchar is ANSI standard</li>
<li>Varchar2 is Oracles standard</li>
</ul>
<h3 id="acid"><a class="header" href="#acid">ACID</a></h3>
<ul>
<li>Atomicity : Either all changes are performed or none of them.</li>
<li>Consistency : Data is consistent after and before the transcation.</li>
<li>Isolation : Transcation takes place concurrently in an isolated manner.</li>
<li>Durability: After a transcation completes successfuly all the data changes persists even after the events of system failure</li>
</ul>
<h3 id="joins"><a class="header" href="#joins">Joins</a></h3>
<ul>
<li>Cross Join : Cartesian prodocut of 2 tables (combinations of rows of 2 tables).</li>
<li>Self Join : Joininig a table with itself.</li>
<li>Natural Join/Inner Join : Returns records matching in both the tables.</li>
<li>Left Outer Join : Returns the common records in both the tables as well as records not in right table but in left.Fills the columns not in right table with null.</li>
<li>Right Outer Join : Returns the common records in both the tables as well as records not in left table but in right.Fills the columns not in left table with null.</li>
</ul>
<blockquote>
<p>Alternate way of inner join</p>
</blockquote>
<pre><code>select
  pt.patient_id,
  pt.first_name,
  pt.last_name,
  doc.specialty
from
  patients as pt,
  doctors as doc,
  admissions as adm
where
  pt.patient_id = adm.patient_id
  AND adm.attending_doctor_id = doc.doctor_id
  AND adm.diagnosis='Epilepsy'
  AND doc.first_name='Lisa'
</code></pre>
<blockquote>
<p>Inner Joins Syntax</p>
</blockquote>
<pre><code>SELECT
  p.patient_id,
  p.first_name AS patient_first_name,
  p.last_name AS patient_last_name,
  ph.specialty AS attending_doctor_specialty
FROM patients p
  JOIN admissions a ON a.patient_id = p.patient_id
  JOIN doctors ph ON ph.doctor_id = a.attending_doctor_id
WHERE
  ph.first_name = 'Lisa' and
  a.diagnosis = 'Epilepsy'
</code></pre>
<p>Link : https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-joins/</p>
<h3 id="sql-cheatsheet"><a class="header" href="#sql-cheatsheet">SQL Cheatsheet</a></h3>
<hr>
<h2 id="table-operations"><a class="header" href="#table-operations">Table Operations</a></h2>
<blockquote>
<p>Create</p>
</blockquote>
<pre><code class="language-sql">CREATE TABLE products (
    code INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    prod_name VARCHAR(255) NOT NULL,
    price NUMERIC(10,2) NOT NULL,
    release_date TIMESTAMP WITHOUT TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

--  DEFAULT NOW()
--  DEFAULT CURRENT_TIMESTAMP

-- TIMESTAMP WITHOUT TIME ZONE
-- TIMESTAMP

-- Composite primary key
CREATE TABLE products (
    code INT GENERATED ALWAYS AS IDENTITY,
    prod_name VARCHAR(255) NOT NULL,
    CONSTRAINT pk_prod PRIMARY KEY (code, prod_name)
);
</code></pre>
<p>Note: <code>GENERATED ALWAYS AS IDENTITY</code> auto-generates values, no manual insert allowed</p>
<blockquote>
<p>Drop / Truncate</p>
</blockquote>
<pre><code class="language-sql">DROP TABLE products;
TRUNCATE TABLE products;
</code></pre>
<blockquote>
<p>Copy Table</p>
</blockquote>
<pre><code class="language-sql">CREATE TABLE prod_bkp AS (SELECT * FROM products WHERE 1=2);  -- structure only
CREATE TABLE prod_bkp AS (SELECT * FROM products);            -- structure + data
</code></pre>
<hr>
<h2 id="crud-operations"><a class="header" href="#crud-operations">CRUD Operations</a></h2>
<blockquote>
<p>Insert</p>
</blockquote>
<pre><code class="language-sql">INSERT INTO products(prod_name, price, release_date)
VALUES ('name-1', 12.23, to_date('31-10-2025','dd-mm-yyyy'));

INSERT INTO products(prod_name, price, release_date)
VALUES ('name-2', 15.23, to_timestamp('31-12-2025 13:08:07','dd-mm-yyyy hh24:mi:ss'));
</code></pre>
<blockquote>
<p>Update</p>
</blockquote>
<pre><code class="language-sql">UPDATE products SET prod_name='updated-1', price=51.23 WHERE code=1;
</code></pre>
<p>Note: Without <code>WHERE</code>, all rows will be updated</p>
<blockquote>
<p>Delete</p>
</blockquote>
<pre><code class="language-sql">DELETE FROM products WHERE code=1;
</code></pre>
<p>Note: Without <code>WHERE</code>, all rows will be deleted</p>
<hr>
<h2 id="alter-operations"><a class="header" href="#alter-operations">Alter Operations</a></h2>
<pre><code class="language-sql">ALTER TABLE products RENAME TO test1;                             -- rename table
ALTER TABLE test1 RENAME COLUMN price TO prize;                   -- rename column
ALTER TABLE test1 ALTER COLUMN prize TYPE FLOAT;                  -- change data type
ALTER TABLE test1 ALTER COLUMN prize SET NOT NULL;                -- add NOT NULL
ALTER TABLE test1 ALTER COLUMN prize DROP NOT NULL;               -- drop NOT NULL
ALTER TABLE products ADD CONSTRAINT uq_name UNIQUE (prod_name);   -- add constraint
ALTER TABLE products DROP CONSTRAINT uq_name;                     -- drop constraint
</code></pre>
<p>Note: PostgreSQL columns are nullable by default</p>
<hr>
<h2 id="constraints-1"><a class="header" href="#constraints-1">Constraints</a></h2>
<blockquote>
<p>PRIMARY KEY</p>
</blockquote>
<pre><code class="language-sql">-- Inline
CREATE TABLE products (
    id INT PRIMARY KEY
);

-- Named
CREATE TABLE products (
    id INT,
    code INT,
    CONSTRAINT pk_products PRIMARY KEY (id, code)
);
</code></pre>
<blockquote>
<p>FOREIGN KEY</p>
</blockquote>
<pre><code class="language-sql">-- Inline
CREATE TABLE orders (
    id INT PRIMARY KEY,
    product_id INT REFERENCES products(id)
);

-- Named with ON DELETE
CREATE TABLE orders (
    id INT PRIMARY KEY,
    product_id INT,
    CONSTRAINT fk_product FOREIGN KEY (product_id) REFERENCES products(id) ON DELETE CASCADE
);
</code></pre>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Option</th><th>Meaning</th></tr>
</thead>
<tbody>
<tr><td><code>CASCADE</code></td><td>Delete child rows</td></tr>
<tr><td><code>SET NULL</code></td><td>Set child column to NULL</td></tr>
<tr><td><code>SET DEFAULT</code></td><td>Set child column to default value</td></tr>
<tr><td><code>RESTRICT</code></td><td>Prevent deletion if child exists</td></tr>
<tr><td><code>NO ACTION</code></td><td>Same as RESTRICT (default)</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>NOT NULL</p>
</blockquote>
<pre><code class="language-sql">CREATE TABLE products (
    prod_name VARCHAR(255) NOT NULL
);
</code></pre>
<blockquote>
<p>UNIQUE</p>
</blockquote>
<pre><code class="language-sql">-- Inline
CREATE TABLE users (
    email VARCHAR(255) UNIQUE
);

-- Named
CREATE TABLE users (
    email VARCHAR(255),
    CONSTRAINT uq_email UNIQUE (email)
);
</code></pre>
<blockquote>
<p>CHECK</p>
</blockquote>
<pre><code class="language-sql">-- Inline
CREATE TABLE products (
    price NUMERIC(10,2) CHECK (price &gt; 0)
);

-- Named
CREATE TABLE products (
    price NUMERIC(10,2),
    CONSTRAINT chk_price CHECK (price &gt; 0)
);
</code></pre>
<blockquote>
<p>DEFAULT</p>
</blockquote>
<pre><code class="language-sql">CREATE TABLE products (
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    status VARCHAR(20) DEFAULT 'active'
);
</code></pre>
<hr>
<h2 id="filtering--pattern-matching"><a class="header" href="#filtering--pattern-matching">Filtering &amp; Pattern Matching</a></h2>
<blockquote>
<p>LIKE / ILIKE</p>
</blockquote>
<pre><code class="language-sql">SELECT * FROM products WHERE prod_name LIKE '%name%';       -- case-sensitive
SELECT * FROM products WHERE prod_name ILIKE '%NAME%';      -- case-insensitive
SELECT * FROM products WHERE prod_name NOT LIKE '%name%';
</code></pre>
<p>Note: <code>%</code> = 0 or more characters, <code>_</code> = single character</p>
<blockquote>
<p>Regex Matching</p>
</blockquote>
<pre><code class="language-sql">SELECT * FROM products WHERE prod_name ~ '^name';    -- case-sensitive
SELECT * FROM products WHERE prod_name ~* '^NAME';   -- case-insensitive
SELECT * FROM products WHERE prod_name !~ '^name';   -- NOT match
</code></pre>
<blockquote>
<p>BETWEEN / IN / NULL</p>
</blockquote>
<pre><code class="language-sql">SELECT * FROM products WHERE price BETWEEN 10 AND 50;
SELECT * FROM products WHERE prod_name IN ('name-1', 'name-2');
SELECT * FROM products WHERE prod_name NOT IN ('name-1', 'name-2');
SELECT * FROM products WHERE release_date IS NULL;
SELECT * FROM products WHERE release_date IS NOT NULL;
</code></pre>
<blockquote>
<p>LOWER / UPPER</p>
</blockquote>
<pre><code class="language-sql">SELECT LOWER(prod_name), UPPER(prod_name) FROM products;
SELECT * FROM products WHERE LOWER(prod_name) = 'name-1';
</code></pre>
<hr>
<h2 id="date-operations"><a class="header" href="#date-operations">Date Operations</a></h2>
<blockquote>
<p>Insert with Date</p>
</blockquote>
<pre><code class="language-sql">INSERT INTO products(prod_name, price, release_date)
VALUES ('name-1', 12.23, to_date('31-10-2025','dd-mm-yyyy'));

INSERT INTO products(prod_name, price, release_date)
VALUES ('name-2', 15.23, to_timestamp('31-12-2025 13:08:07','dd-mm-yyyy hh24:mi:ss'));
</code></pre>
<blockquote>
<p>Filter by Date</p>
</blockquote>
<pre><code class="language-sql">SELECT * FROM products WHERE release_date BETWEEN '2025-01-01' AND '2025-12-31';
SELECT * FROM products WHERE EXTRACT(YEAR FROM release_date) = 2025;
SELECT * FROM products WHERE to_char(release_date, 'yyyy') = '2025';
</code></pre>
<blockquote>
<p>Index</p>
</blockquote>
<pre><code class="language-sql">CREATE INDEX contacts_name
ON contacts(name);
</code></pre>
<blockquote>
<p>Case statements</p>
</blockquote>
<pre><code class="language-sql">SELECT product_name,
CASE
  WHEN price &lt; 10 THEN 'Low price product'
  WHEN price &gt; 50 THEN 'High price product'
ELSE
  'Normal product'
END
FROM products;
</code></pre>
<blockquote>
<p>Orders</p>
</blockquote>
<p>“Friendly Jaguars Wear Green Hats, Serve Delicious Orange Lunches”</p>
<p>FROM
JOIN / ON
WHERE
GROUP BY
HAVING
SELECT
DISTINCT
ORDER BY
LIMIT / OFFSET</p>
<p>Note:</p>
<ul>
<li>cannot drop a table which is being referred(used) by other table.</li>
<li>First drop the child table which refers other tables</li>
</ul>
<blockquote>
<p>Group By</p>
</blockquote>
<ul>
<li>can only have agg func</li>
<li>only columns inside group by</li>
</ul>
<p>If a query contains an aggregate function, then every column in SELECT must be either</p>
<ul>
<li>Aggregated (MAX, SUM, COUNT, …), or</li>
<li>Listed in GROUP BY</li>
</ul>
<p>Note : add conditions join to also include null values</p>
<blockquote>
<p>Case Study</p>
</blockquote>
<p>Below is sales data:</p>
<pre><code class="language-sql">drop table if exists products;
create table products
(
	id				    int generated always as identity primary key,
	name			    varchar(100),
	price			    float,
	release_date 	date
);
insert into products
values(default,'iPhone 15', 800, to_date('22-08-2023','dd-mm-yyyy'));
insert into products
values(default,'Macbook Pro', 2100, to_date('12-10-2022','dd-mm-yyyy'));
insert into products
values(default,'Apple Watch 9', 550, to_date('04-09-2022','dd-mm-yyyy'));
insert into products
values(default,'iPad', 400, to_date('25-08-2020','dd-mm-yyyy'));
insert into products
values(default,'AirPods', 420, to_date('30-03-2024','dd-mm-yyyy'));

drop table if exists customers;
create table customers
(
    id         int generated always as identity primary key,
    name       varchar(100),
    email      varchar(30)
);
insert into customers values(default,'Meghan Harley', 'mharley@demo.com');
insert into customers values(default,'Rosa Chan', 'rchan@demo.com');
insert into customers values(default,'Logan Short', 'lshort@demo.com');
insert into customers values(default,'Zaria Duke', 'zduke@demo.com');

drop table if exists employees;
create table employees
(
    id         int generated always as identity primary key,
    name       varchar(100)
);
insert into employees values(default,'Nina Kumari');
insert into employees values(default,'Abrar Khan');
insert into employees values(default,'Irene Costa');

drop table if exists sales_order;
create table sales_order
(
	order_id		  int generated always as identity primary key,
	order_date	  date,
	quantity		  int,
	prod_id			  int references products(id),
	status			  varchar(20),
	customer_id		int references customers(id),
	emp_id			  int,
	constraint fk_so_emp foreign key (emp_id) references employees(id)
);
insert into sales_order
values(default,to_date('01-01-2024','dd-mm-yyyy'),2,1,'Completed',1,1);
insert into sales_order
values(default,to_date('01-01-2024','dd-mm-yyyy'),3,1,'Pending',2,2);
insert into sales_order
values(default,to_date('02-01-2024','dd-mm-yyyy'),3,2,'Completed',3,2);
insert into sales_order
values(default,to_date('03-01-2024','dd-mm-yyyy'),3,3,'Completed',3,2);
insert into sales_order
values(default,to_date('04-01-2024','dd-mm-yyyy'),1,1,'Completed',3,2);
insert into sales_order
values(default,to_date('04-01-2024','dd-mm-yyyy'),1,3,'completed',2,1);
insert into sales_order
values(default,to_date('04-01-2024','dd-mm-yyyy'),1,2,'On Hold',2,1);
insert into sales_order
values(default,to_date('05-01-2024','dd-mm-yyyy'),4,2,'Rejected',1,2);
insert into sales_order
values(default,to_date('06-01-2024','dd-mm-yyyy'),5,5,'Completed',1,2);
insert into sales_order
values(default,to_date('06-01-2024','dd-mm-yyyy'),1,1,'Cancelled',1,1);
insert into sales_order
values(default,to_date('06-01-2024','dd-mm-yyyy'),1,1,'Pending',1,1);

SELECT * FROM products;
SELECT * FROM customers;
SELECT * FROM employees;
SELECT * FROM sales_order;

select distinct status from sales_order;
</code></pre>
<ol>
<li>Identify the total no of products sold</li>
</ol>
<pre><code class="language-sql">select sum(quantity) as total_products_sold from sales_order;
</code></pre>
<ol start="2">
<li>Other than Completed, display the available delivery status’s</li>
</ol>
<pre><code class="language-sql">select distinct(status) from sales_order where status NOT ILIKE 'completed';
</code></pre>
<ol start="3">
<li>Display the order id, order_date and product_name for all the completed orders.</li>
</ol>
<pre><code class="language-sql">select
  *
from
  sales_order so
  inner join products p on p.id = so.prod_id
where
  status ilike 'completed';
</code></pre>
<ol start="4">
<li>Sort the above query to show the earliest orders at the top. Also, display the customer who purchased these orders.</li>
</ol>
<pre><code class="language-sql">select
  so.order_id,
  so.order_date,
  p.name as product,
  c.name as customer
from
  sales_order so
  join products p on p.id = so.prod_id
  join customers c on c.id = so.customer_id
where
  lower(so.status) = 'completed'
order by
  so.order_date;
</code></pre>
<ol start="5">
<li>Display the total no of orders corresponding to each delivery status</li>
</ol>
<p>Note: Every column in SELECT must be either</p>
<p>in the GROUP BY, or</p>
<p>inside an aggregate function (MAX, SUM, AVG, etc.)</p>
<pre><code class="language-sql">select status,count(*) from sales_order group by status;
</code></pre>
<ol start="6">
<li>How many orders are still not completed for orders purchasing more than 1 item?</li>
</ol>
<pre><code class="language-sql">select
  count(*)
from
  sales_order
where
  status ilike 'completed'
  and quantity &gt; 1;
</code></pre>
<ol start="7">
<li>Find the total number of orders corresponding to each delivery status by ignoring the case in the delivery status.</li>
</ol>
<pre><code class="language-sql">select
  count(*),
  lower(status)
from
  sales_order
group by
  lower(status)
order by
  count desc;
</code></pre>
<ol start="8">
<li>Write a query to identify the total products purchased by each customer</li>
</ol>
<pre><code class="language-sql">select
  c.name,
  sum(so.quantity)
from
  sales_order so
  inner join customers c on c.id = so.customer_id
group by
  c.name;
</code></pre>
<ol start="9">
<li>Display the total sales and average sales done for each day.</li>
</ol>
<pre><code class="language-sql">select
  sum(p.price * so.quantity) as total_sale,
  avg(quantity * p.price) as avg_sales,
  order_date
from
  sales_order so
  inner join products p on so.prod_id = p.id
group by
  order_date
order by
  total_sale desc
</code></pre>
<ol start="10">
<li>Display the customer name, employee name, and total sale amount of all orders which are either on hold or pending.</li>
</ol>
<pre><code class="language-sql">select
  c.name as customer_name,
  e.name as employee_name,
  sum(p.price * so.quantity) as total_sales
from
  sales_order so
  inner join customers c on c.id = so.customer_id
  inner join employees e on e.id = so.emp_id
  inner join products p on p.id = so.prod_id
where
  status = 'On Hold'
  or status = 'Pending'
group by
  e.name,
  c.name;
</code></pre>
<ol start="11">
<li>Fetch all the orders which were neither completed/pending or were handled by the employee Abrar. Display employee name aswell</li>
</ol>
<pre><code class="language-sql">select
  e.name,
  so.*
from
  sales_order so
  inner join employees e on so.emp_id = e.id
where
  lower(so.status) not in ('complete', 'pending')
  or e.name ilike 'Abrar';
</code></pre>
<ol start="12">
<li>Fetch the orders which cost more than 2000 but did not include the MacBook Pro. Print the total sale amount as well.</li>
</ol>
<pre><code class="language-sql">select
  (p.price * so.quantity) as price,p.name
from
  sales_order so
  inner join products p on p.id = so.prod_id
where
  p.name not ilike '%macbook%'
</code></pre>
<ol start="13">
<li>Identify the customers who have not purchased any product yet.</li>
</ol>
<pre><code class="language-sql">select * from customers where customers.id not in (select sales_order.customer_id from sales_order);
</code></pre>
<ol start="14">
<li>Write a query to identify the total products purchased by each customer.
Return all customers irrespective of whether they have made a purchase or not.
Sort the result with the highest no of orders at the top.</li>
</ol>
<pre><code class="language-sql">select
  c.name,
  coalesce(sum(so.quantity),0) as qty
from
  customers c
  left join sales_order so on c.id = so.customer_id
group by
  c.name
order by
  qty desc;
</code></pre>
<ol start="15">
<li>Corresponding to each employee, display the total sales they made of
all the completed orders. Display total sales as 0 if an employee made no sales yet.</li>
</ol>
<pre><code class="language-sql">select
  e.name,
  coalesce(sum(p.price * so.quantity), 0) as total_sale
from
  sales_order so
  inner join products p on p.id = so.prod_id
  right join employees e on e.id = so.emp_id
  and lower(so.status) = 'completed'
group by
  e.name
order by
  total_sale desc;
</code></pre>
<ol start="16">
<li>Re-write the above query to display the total sales made by each employee
corresponding to each customer. If an employee has not served a customer
yet then display “-” under the customer.</li>
</ol>
<pre><code class="language-sql">select
  coalesce(sum(so.quantity * p.price), 0) as total_sales,
  coalesce(c.name, '-') as customer_name,
  e.name as emp_name
from
  sales_order so
  inner join products p on p.id = so.prod_id
  inner join customers c on c.id = so.customer_id
  right join employees e on e.id = so.emp_id and lower(so.status) = 'completed'
group by
  e.name,
  c.name
order by
  total_sales desc;
</code></pre>
<ol start="17">
<li>Re-write the above query to display only those records where the total sales are above 1000.</li>
</ol>
<pre><code class="language-sql">select
  coalesce(sum(so.quantity * p.price), 0) as total_sales,
  coalesce(c.name, '-') as customer_name,
  e.name as emp_name
from
  sales_order so
  inner join products p on p.id = so.prod_id
  inner join customers c on c.id = so.customer_id
  right join employees e on e.id = so.emp_id
  and lower(so.status) = 'completed'
group by
  e.name,
  c.name
having
  sum(so.quantity * p.price) &gt; 1000
order by
  total_sales desc;
</code></pre>
<ol start="18">
<li>Identify employees who have served more than 2 customers.</li>
</ol>
<pre><code class="language-sql">select
  e.name,
  count(distinct (c.name)) as customer_served
from
  employees e
  inner join sales_order so on so.emp_id = e.id
  inner join customers c on c.id = so.customer_id
group by
  e.name
having
  count(distinct (c.name)) &gt; 2;
</code></pre>
<ol start="19">
<li>Identify the customers who have purchased more than 5 products</li>
</ol>
<pre><code class="language-sql">select c.name,sum(so.quantity) as qty
from customers c
inner join sales_order so on so.customer_id=c.id
group by c.name
  having sum(so.quantity)&gt;5;
</code></pre>
<ol start="20">
<li>Identify customers whose average purchase cost exceeds the average sale of all the orders.</li>
</ol>
<pre><code class="language-sql">select c.name,avg(so.quantity*p.price) as avg_cost
from customers c
inner join sales_order so on so.customer_id=c.id
inner join products p on p.id=so.prod_id
group by c.name
having (avg(so.quantity*p.price))&gt;(
  select avg(p.price*so.quantity)
  from sales_order so
  inner join products p on p.id=so.prod_id
)
</code></pre>
<h1 id="sql-window-functions"><a class="header" href="#sql-window-functions">SQL Window Functions</a></h1>
<h2 id="1-what-is-a-window-function"><a class="header" href="#1-what-is-a-window-function">1. What Is a Window Function?</a></h2>
<p>A <strong>window function</strong> performs calculations across a set of rows that are <strong>logically related to the current row</strong>, while <strong>preserving individual rows</strong> in the result set.</p>
<h3 id="key-characteristics"><a class="header" href="#key-characteristics">Key Characteristics</a></h3>
<ul>
<li>Rows are <strong>not collapsed</strong> (unlike <code>GROUP BY</code>)</li>
<li>Row-level detail is retained</li>
<li>Results are computed over a logical <strong>window of rows</strong></li>
</ul>
<h3 id="conceptual-difference"><a class="header" href="#conceptual-difference">Conceptual Difference</a></h3>
<ul>
<li><code>GROUP BY</code> → aggregates and <strong>reduces rows</strong></li>
<li>Window functions → <strong>retain rows</strong> and add computed columns</li>
</ul>
<hr>
<h2 id="2-general-syntax"><a class="header" href="#2-general-syntax">2. General Syntax</a></h2>
<pre><code class="language-sql">window_function(expression)
OVER (
  PARTITION BY partition_column
  ORDER BY order_column
)
</code></pre>
<h3 id="clauses-explained"><a class="header" href="#clauses-explained">Clauses Explained</a></h3>
<ul>
<li>
<p><strong>PARTITION BY</strong>
Divides rows into logical groups (similar to <code>GROUP BY</code>, but without collapsing rows)</p>
</li>
<li>
<p><strong>ORDER BY</strong>
Defines row ordering within each partition</p>
</li>
</ul>
<hr>
<h2 id="3-sample-table-employees2"><a class="header" href="#3-sample-table-employees2">3. Sample Table: <code>employees2</code></a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>emp_name</th><th>department</th><th>salary</th></tr>
</thead>
<tbody>
<tr><td>Alice</td><td>IT</td><td>90000</td></tr>
<tr><td>Bob</td><td>IT</td><td>80000</td></tr>
<tr><td>Carol</td><td>IT</td><td>80000</td></tr>
<tr><td>David</td><td>HR</td><td>70000</td></tr>
<tr><td>Eva</td><td>HR</td><td>65000</td></tr>
<tr><td>Frank</td><td>Sales</td><td>60000</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="4-row_number"><a class="header" href="#4-row_number">4. ROW_NUMBER()</a></h2>
<h3 id="definition"><a class="header" href="#definition">Definition</a></h3>
<p>Assigns a <strong>unique sequential number</strong> to each row within a partition based on the specified order.</p>
<ul>
<li>No two rows share the same number</li>
<li>Ties are broken arbitrarily unless further ordering is specified</li>
</ul>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<pre><code class="language-sql">SELECT
  emp_name,
  department,
  salary,
  ROW_NUMBER() OVER (
    PARTITION BY department
    ORDER BY salary DESC
  ) AS row_num
FROM employees2;
</code></pre>
<h3 id="behavior-it-department"><a class="header" href="#behavior-it-department">Behavior (IT Department)</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>emp_name</th><th>salary</th><th>row_num</th></tr>
</thead>
<tbody>
<tr><td>Alice</td><td>90000</td><td>1</td></tr>
<tr><td>Bob</td><td>80000</td><td>2</td></tr>
<tr><td>Carol</td><td>80000</td><td>3</td></tr>
</tbody>
</table>
</div>
<h3 id="common-use-cases"><a class="header" href="#common-use-cases">Common Use Cases</a></h3>
<ul>
<li>Selecting a single top row per group</li>
<li>Deduplication</li>
</ul>
<hr>
<h2 id="5-rank"><a class="header" href="#5-rank">5. RANK()</a></h2>
<h3 id="definition-1"><a class="header" href="#definition-1">Definition</a></h3>
<p>Assigns the same rank to rows with equal values and <strong>leaves gaps</strong> in the ranking sequence.</p>
<h3 id="example-1"><a class="header" href="#example-1">Example</a></h3>
<pre><code class="language-sql">SELECT
  emp_name,
  department,
  salary,
  RANK() OVER (
    PARTITION BY department
    ORDER BY salary DESC
  ) AS rank
FROM employees2;
</code></pre>
<h3 id="behavior-it-department-1"><a class="header" href="#behavior-it-department-1">Behavior (IT Department)</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>emp_name</th><th>salary</th><th>rank</th></tr>
</thead>
<tbody>
<tr><td>Alice</td><td>90000</td><td>1</td></tr>
<tr><td>Bob</td><td>80000</td><td>2</td></tr>
<tr><td>Carol</td><td>80000</td><td>2</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>The next rank would be <strong>4</strong> (rank 3 is skipped).</p>
</blockquote>
<h3 id="use-cases"><a class="header" href="#use-cases">Use Cases</a></h3>
<ul>
<li>Competition-style ranking</li>
<li>Reports where rank gaps are meaningful</li>
</ul>
<hr>
<h2 id="6-dense_rank"><a class="header" href="#6-dense_rank">6. DENSE_RANK()</a></h2>
<h3 id="definition-2"><a class="header" href="#definition-2">Definition</a></h3>
<p>Assigns the same rank to tied rows <strong>without gaps</strong> in the ranking sequence.</p>
<h3 id="example-2"><a class="header" href="#example-2">Example</a></h3>
<pre><code class="language-sql">SELECT
  emp_name,
  department,
  salary,
  DENSE_RANK() OVER (
    PARTITION BY department
    ORDER BY salary DESC
  ) AS dense_rank
FROM employees2;
</code></pre>
<h3 id="behavior-it-department-2"><a class="header" href="#behavior-it-department-2">Behavior (IT Department)</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>emp_name</th><th>salary</th><th>dense_rank</th></tr>
</thead>
<tbody>
<tr><td>Alice</td><td>90000</td><td>1</td></tr>
<tr><td>Bob</td><td>80000</td><td>2</td></tr>
<tr><td>Carol</td><td>80000</td><td>2</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>The next rank would be <strong>3</strong>.</p>
</blockquote>
<h3 id="use-cases-1"><a class="header" href="#use-cases-1">Use Cases</a></h3>
<ul>
<li>Finding Nth highest values</li>
<li>Rank reporting without gaps</li>
</ul>
<hr>
<h2 id="7-lead"><a class="header" href="#7-lead">7. LEAD()</a></h2>
<h3 id="definition-3"><a class="header" href="#definition-3">Definition</a></h3>
<p>Returns a value from a <strong>subsequent row</strong> within the same partition.</p>
<h3 id="example-3"><a class="header" href="#example-3">Example</a></h3>
<pre><code class="language-sql">SELECT
  emp_name,
  department,
  salary,
  LEAD(salary) OVER (
    PARTITION BY department
    ORDER BY salary DESC
  ) AS next_salary
FROM employees2;
</code></pre>
<h3 id="behavior-it-department-3"><a class="header" href="#behavior-it-department-3">Behavior (IT Department)</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>emp_name</th><th>salary</th><th>next_salary</th></tr>
</thead>
<tbody>
<tr><td>Alice</td><td>90000</td><td>80000</td></tr>
<tr><td>Bob</td><td>80000</td><td>80000</td></tr>
<tr><td>Carol</td><td>80000</td><td>NULL</td></tr>
</tbody>
</table>
</div>
<h3 id="use-cases-2"><a class="header" href="#use-cases-2">Use Cases</a></h3>
<ul>
<li>Row-to-row comparison</li>
<li>Trend analysis</li>
</ul>
<hr>
<h2 id="8-lag"><a class="header" href="#8-lag">8. LAG()</a></h2>
<h3 id="definition-4"><a class="header" href="#definition-4">Definition</a></h3>
<p>Returns a value from a <strong>previous row</strong> within the same partition.</p>
<h3 id="example-4"><a class="header" href="#example-4">Example</a></h3>
<pre><code class="language-sql">SELECT
  emp_name,
  department,
  salary,
  LAG(salary, 1, NULL) OVER (
    PARTITION BY department
    ORDER BY salary DESC
  ) AS previous_salary
FROM employees2;
</code></pre>
<h3 id="behavior-it-department-4"><a class="header" href="#behavior-it-department-4">Behavior (IT Department)</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>emp_name</th><th>salary</th><th>previous_salary</th></tr>
</thead>
<tbody>
<tr><td>Alice</td><td>90000</td><td>NULL</td></tr>
<tr><td>Bob</td><td>80000</td><td>90000</td></tr>
<tr><td>Carol</td><td>80000</td><td>80000</td></tr>
</tbody>
</table>
</div>
<h3 id="use-cases-3"><a class="header" href="#use-cases-3">Use Cases</a></h3>
<ul>
<li>Change detection</li>
<li>Sequential comparisons</li>
</ul>
<hr>
<h2 id="9-common-practical-queries"><a class="header" href="#9-common-practical-queries">9. Common Practical Queries</a></h2>
<h3 id="highest-paid-employee-per-department"><a class="header" href="#highest-paid-employee-per-department">Highest-Paid Employee per Department</a></h3>
<pre><code class="language-sql">SELECT emp_name, department, salary
FROM (
  SELECT
    emp_name,
    department,
    salary,
    RANK() OVER (PARTITION BY department ORDER BY salary DESC) AS r
  FROM employees2
) t
WHERE r = 1;
</code></pre>
<hr>
<h3 id="second-highest-salary-per-department"><a class="header" href="#second-highest-salary-per-department">Second-Highest Salary per Department</a></h3>
<pre><code class="language-sql">SELECT emp_name, department, salary
FROM (
  SELECT
    emp_name,
    department,
    salary,
    DENSE_RANK() OVER (PARTITION BY department ORDER BY salary DESC) AS r
  FROM employees2
) t
WHERE r = 2;
</code></pre>
<hr>
<h2 id="10-ranking-function-comparison"><a class="header" href="#10-ranking-function-comparison">10. Ranking Function Comparison</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Function</th><th>Preserves Rows</th><th>Handles Ties</th><th>Ranking Gaps</th><th>Typical Use</th></tr>
</thead>
<tbody>
<tr><td>ROW_NUMBER</td><td>Yes</td><td>No</td><td>No</td><td>Pick one row</td></tr>
<tr><td>RANK</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Competitive ranking</td></tr>
<tr><td>DENSE_RANK</td><td>Yes</td><td>Yes</td><td>No</td><td>Nth highest</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="11-first_value"><a class="header" href="#11-first_value">11. FIRST_VALUE()</a></h2>
<h3 id="definition-5"><a class="header" href="#definition-5">Definition</a></h3>
<p>Returns the <strong>first value</strong> in the ordered window frame for each partition.</p>
<h3 id="example-5"><a class="header" href="#example-5">Example</a></h3>
<pre><code class="language-sql">SELECT
  emp_name,
  department,
  salary,
  FIRST_VALUE(salary) OVER (
    PARTITION BY department
    ORDER BY salary DESC
  ) AS highest_salary_in_dept
FROM employees2;
</code></pre>
<h3 id="behavior-it-department-5"><a class="header" href="#behavior-it-department-5">Behavior (IT Department)</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>emp_name</th><th>salary</th><th>highest_salary_in_dept</th></tr>
</thead>
<tbody>
<tr><td>Alice</td><td>90000</td><td>90000</td></tr>
<tr><td>Bob</td><td>80000</td><td>90000</td></tr>
<tr><td>Carol</td><td>80000</td><td>90000</td></tr>
</tbody>
</table>
</div>
<h3 id="use-case"><a class="header" href="#use-case">Use Case</a></h3>
<ul>
<li>Comparing each row against the group’s maximum value</li>
</ul>
<hr>
<h2 id="12-last_value"><a class="header" href="#12-last_value">12. LAST_VALUE()</a></h2>
<h3 id="definition-6"><a class="header" href="#definition-6">Definition</a></h3>
<p>Returns the <strong>last value in the window frame</strong>.</p>
<p>⚠️ <strong>Important</strong>
<code>LAST_VALUE()</code> is <strong>frame-sensitive</strong>.
By default, many databases use:</p>
<pre><code class="language-sql">RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
</code></pre>
<p>This often causes <code>LAST_VALUE()</code> to return the <strong>current row’s value</strong> instead of the actual last value.</p>
<hr>
<h3 id="incorrect-default-frame"><a class="header" href="#incorrect-default-frame">Incorrect (Default Frame)</a></h3>
<pre><code class="language-sql">LAST_VALUE(salary) OVER (
  PARTITION BY department
  ORDER BY salary DESC
)
</code></pre>
<hr>
<h3 id="correct-usage-explicit-frame"><a class="header" href="#correct-usage-explicit-frame">Correct Usage (Explicit Frame)</a></h3>
<pre><code class="language-sql">SELECT
  emp_name,
  department,
  salary,
  LAST_VALUE(salary) OVER (
    PARTITION BY department
    ORDER BY salary DESC
    ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
  ) AS lowest_salary_in_dept
FROM employees2;
</code></pre>
<h3 id="behavior-it-department-6"><a class="header" href="#behavior-it-department-6">Behavior (IT Department)</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>emp_name</th><th>salary</th><th>lowest_salary_in_dept</th></tr>
</thead>
<tbody>
<tr><td>Alice</td><td>90000</td><td>80000</td></tr>
<tr><td>Bob</td><td>80000</td><td>80000</td></tr>
<tr><td>Carol</td><td>80000</td><td>80000</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="13-nth_value"><a class="header" href="#13-nth_value">13. NTH_VALUE()</a></h2>
<h3 id="definition-7"><a class="header" href="#definition-7">Definition</a></h3>
<p>Returns the value from the <strong>N-th row</strong> in the ordered window frame.</p>
<p>Like <code>LAST_VALUE</code>, this function <strong>requires an explicit frame</strong>.</p>
<h3 id="example-second-highest-salary-per-department"><a class="header" href="#example-second-highest-salary-per-department">Example: Second-Highest Salary per Department</a></h3>
<pre><code class="language-sql">SELECT
  emp_name,
  department,
  salary,
  NTH_VALUE(salary, 2) OVER (
    PARTITION BY department
    ORDER BY salary DESC
    ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
  ) AS second_highest_salary
FROM employees2;
</code></pre>
<h3 id="behavior-it-department-7"><a class="header" href="#behavior-it-department-7">Behavior (IT Department)</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>emp_name</th><th>salary</th><th>second_highest_salary</th></tr>
</thead>
<tbody>
<tr><td>Alice</td><td>90000</td><td>80000</td></tr>
<tr><td>Bob</td><td>80000</td><td>80000</td></tr>
<tr><td>Carol</td><td>80000</td><td>80000</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="14-value-function-comparison"><a class="header" href="#14-value-function-comparison">14. Value Function Comparison</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Function</th><th>Returns</th><th>Frame-Sensitive</th><th>Typical Use</th></tr>
</thead>
<tbody>
<tr><td>FIRST_VALUE</td><td>First value</td><td>No (safe by default)</td><td>Max / earliest</td></tr>
<tr><td>LAST_VALUE</td><td>Last value</td><td>Yes</td><td>Min / latest</td></tr>
<tr><td>NTH_VALUE</td><td>Nth value</td><td>Yes</td><td>Nth highest / lowest</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="15-key-rules-to-remember"><a class="header" href="#15-key-rules-to-remember">15. Key Rules to Remember</a></h2>
<ol>
<li>
<p><code>FIRST_VALUE()</code> is usually safe without specifying a custom frame.</p>
</li>
<li>
<p><code>LAST_VALUE()</code> and <code>NTH_VALUE()</code> <strong>require an explicit frame</strong>:</p>
<pre><code class="language-sql">ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
</code></pre>
</li>
<li>
<p>Window functions <strong>do not reduce rows</strong>.</p>
</li>
<li>
<p>Execution order:
Window functions run after aggregation but before sorting and limiting</p>
<pre><code>FROM → WHERE → GROUP BY → HAVING → WINDOW FUNCTIONS → ORDER BY
</code></pre>
</li>
</ol>
<blockquote>
<p>Window Function</p>
</blockquote>
<p>A window function calculates something using nearby rows, but still shows every row.</p>
<p>It does not combine rows into one</p>
<p>Each row keeps its identity</p>
<p>The calculation “looks at” other related rows</p>
<p>In one line</p>
<p>Window function = calculate using other rows without losing the current row</p>
<blockquote>
<p>Window Frame</p>
</blockquote>
<p>A window frame decides which rows a window function is allowed to look at for the current row.</p>
<p>It limits the rows inside a partition</p>
<p>It changes how far backward or forward the function can see</p>
<p>In one line</p>
<p>Window frame = how many rows the window function can see</p>
<blockquote>
<p>CTE</p>
</blockquote>
<p>CTE (Common Table Expression) is a temporary named result set that you can use inside a query.</p>
<pre><code class="language-sql">WITH dept_avg AS (
    SELECT department, AVG(salary) AS avg_salary
    FROM employees
    GROUP BY department
),
high_paid AS (
    SELECT emp_name, department, salary
    FROM employees
    WHERE salary &gt; 70000
)
SELECT h.emp_name, h.department, d.avg_salary
FROM high_paid h
JOIN dept_avg d
ON h.department = d.department;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="sql-alchemy"><a class="header" href="#sql-alchemy">SQL Alchemy</a></h1>
<h2 id="install-2"><a class="header" href="#install-2">Install</a></h2>
<pre><code class="language-sh">pip install virtualenv
mkdir sqlalc
cd sqlalc
python -m venv env
source ./env/bin/activate.fish
pip install sqlalchemy asyncio aiosqlite
</code></pre>
<h2 id="sql-alchemy-core"><a class="header" href="#sql-alchemy-core">SQL Alchemy Core</a></h2>
<blockquote>
<p>It is a Low level API which give us more control over the
queries we write. It provides us with the feature of writing raw sql queries.</p>
</blockquote>
<h4 id="connecting-with-a-database"><a class="header" href="#connecting-with-a-database">Connecting with a database</a></h4>
<pre><code class="language-py">from sqlalchemy import create_engine, text

# Initialize engine
DB_URL = "sqlite:///test.db"
engine = create_engine(DB_URL, echo=True)

# Establish connection with the database
with engine.connect() as conn:
    # Execute raw sql query
    statement = text("select 100+200;")
    res = conn.execute(statement)
    print(res.all())
</code></pre>
<h4 id="defining-schema-of-db"><a class="header" href="#defining-schema-of-db">Defining schema of db</a></h4>
<p>In SQLAlchemy Core, the metadata object is used to define the structure of
the database tables and their relationships. It is a container for
all the table definitions and provides a way to introspect the database schema.</p>
<pre><code class="language-py">from sqlalchemy import ForeignKey, MetaData, String, Table, Column, Integer, Text


# MetaData object
meta_obj = MetaData()

### Users Table

"""
Users Table
    - id (pk)
    - name (str)
    - fullname (str)
    - email (str)
"""

user_schema = [
    Column("id", Integer, primary_key=True),
    Column("name", String(30), nullable=False),
    Column("fullname", String(50), nullable=False),
    Column("email", String(30), nullable=False),
]
user_table = Table("users", meta_obj, *user_schema)

### Comments Table

"""
Comments Table
    - id (pk)
    - comment (str)
    - user_id (int,fk refrencing the id in user table)
"""

comments_schema = [
    Column("id", Integer, primary_key=True),
    Column("comment", Text, nullable=False),
    Column("user_id", Integer, ForeignKey("users.id")),
]
comments_table = Table("comments", meta_obj, *comments_schema)
</code></pre>
<h4 id="creating-tables"><a class="header" href="#creating-tables">Creating Tables</a></h4>
<pre><code class="language-py">from connect import engine
from tables import meta_obj


# Create all the tables
meta_obj.create_all(bind=engine)
</code></pre>
<h4 id="inserting-data"><a class="header" href="#inserting-data">Inserting Data</a></h4>
<pre><code class="language-py">from sqlalchemy import insert
from connect import engine
from tables import user_table


with engine.connect() as conn:
    # Insert Single Data
    user = {"name": "John", "fullname": "John Doe", "email": "john@doe.com"}
    statement = insert(user_table).values(**user)
    conn.execute(statement)
    conn.commit()

    # Insert Multiple Data
    users = [
        {"name": "Jake", "fullname": "Jake Doe", "email": "jake@doe.com"},
        {"name": "Joe", "fullname": "Joe Smith", "email": "joe@smith.com"},
    ]

    statement = insert(user_table)
    conn.execute(statement, users)
    conn.commit()
</code></pre>
<h4 id="selecting-data"><a class="header" href="#selecting-data">Selecting Data</a></h4>
<pre><code class="language-py">from sqlalchemy import select
from tables import user_table
from connect import engine


with engine.connect() as conn:
    # Simple select statement
    statement = select(user_table)
    res = conn.execute(statement)
    print(res.all())

    # Select statement with where clause
    statement = select(user_table).where(user_table.c.id == 3)
    res = conn.execute(statement)

    # For priting all rows
    for row in res:
        print(row)
</code></pre>
<h4 id="updating-data"><a class="header" href="#updating-data">Updating Data</a></h4>
<pre><code class="language-py">from sqlalchemy import update
from tables import user_table
from connect import engine


with engine.connect() as conn:
    # Updated Data
    statement = update(user_table).where(user_table.c.id == 1).values(name="Updated")
    conn.execute(statement)
    conn.commit()
</code></pre>
<h4 id="deleting-data"><a class="header" href="#deleting-data">Deleting Data</a></h4>
<pre><code class="language-py">from sqlalchemy import delete
from tables import user_table
from connect import engine


with engine.connect() as conn:
    # Delete data
    statement = delete(user_table).where(user_table.c.id == 1)
    conn.execute(statement)
    conn.commit()
</code></pre>
<h2 id="sqlalchemy-orm"><a class="header" href="#sqlalchemy-orm">SQLAlchemy ORM</a></h2>
<blockquote>
<p>It is a high level API to interact with the database. Here we can define python classes which directly maps to db tables,
providing us a more pythonic way to interact with the database.</p>
</blockquote>
<p>An Object-Relational Mapping (ORM) is a tool or software library that allows programmers to
interact with databases using an object-oriented programming language, rather than writing
SQL queries directly.</p>
<p><strong>Advantages of ORMs</strong>:</p>
<ul>
<li>Simplified database access: ORMs provide a simple and intuitive way to interact with databases, allowing developers to focus on their application logic instead of writing complex SQL queries.</li>
<li>Improved productivity: ORMs reduce the amount of boilerplate code required to perform common database operations, such as creating, reading, updating, and deleting records.</li>
<li>Consistency: ORMs provide a consistent interface for working with different types of databases, making it easier to switch between them or use multiple databases in the same application.</li>
<li>Type safety: ORMs can provide type safety, which means that the compiler can check for errors at compile time instead of runtime, reducing the risk of runtime errors.</li>
<li>Abstraction: ORMs abstract away the underlying database implementation, making it easier to write database-agnostic code.</li>
</ul>
<p><strong>Disadvantages of ORMs</strong>:</p>
<ul>
<li>Performance overhead: ORMs can introduce performance overhead due to the additional layer of abstraction between the application and the database.</li>
<li>Limited query capabilities: ORMs may not support all SQL queries or features, limiting the flexibility of the developer when working with complex data.</li>
<li>Learning curve: ORMs can have a steep learning curve, especially for developers who are new to object-relational mapping.</li>
<li>Complexity: ORMs can add complexity to the application, making it harder to debug and maintain.</li>
<li>Lazy loading: ORMs often use lazy loading to fetch related data only when it’s needed, but this can result in multiple round trips to the database, leading to performance issues.</li>
</ul>
<h4 id="connecting-with-a-database-1"><a class="header" href="#connecting-with-a-database-1">Connecting with a database</a></h4>
<pre><code class="language-py">from sqlalchemy import create_engine, text

# Initialize engine
DB_URL = "sqlite:///test.db"
engine = create_engine(DB_URL, echo=True)

# Establish connection with the database
with engine.connect() as conn:
    # Execute raw sql query
    statement = text("select 1+1;")
    res = conn.execute(statement)
    print(res.all())
</code></pre>
<h4 id="defining-schema-of-db-1"><a class="header" href="#defining-schema-of-db-1">Defining schema of db</a></h4>
<pre><code class="language-py">from sqlalchemy import ForeignKey, Integer, String, Text
from sqlalchemy.orm import DeclarativeBase, Mapped, mapped_column, relationship


# Base class
class Base(DeclarativeBase):
    pass


# Users Table


class Users(Base):
    """
    User Table
        - id (pk)
        - name (str)
        - fullname (str)
        - email (str)
    """

    __tablename__ = "users"
    id: Mapped[int] = mapped_column("id", Integer, primary_key=True)
    name: Mapped[str] = mapped_column("name", String(30), nullable=False)
    fullname: Mapped[str] = mapped_column("fullname", String(50), nullable=False)
    email: Mapped[str] = mapped_column("email", String(30), nullable=False)
    comments: Mapped[list["Comments"]] = relationship(
        back_populates="user", cascade="delete,all"
    )

    # def __repr__(self):
    #     return f"Username: {self.fullname} Email: {self.email}"


# Comments Table


class Comments(Base):
    """
    Comment Table
        - id (pk)
        - comment (str)
        - user_id (int,fk referencing the id in user table)
    """

    __tablename__ = "comments"
    id: Mapped[int] = mapped_column("id", Integer, primary_key=True)
    comment: Mapped[str] = mapped_column("comment", Text, nullable=False)
    user_id: Mapped[int] = mapped_column("user_id", Integer, ForeignKey("users.id"))
    user: Mapped[Users] = relationship(back_populates="comments", cascade="delete,all")

    # def __repr__(self):
    #     return f"Comment: {self.comment} Comment By: {self.user.fullname}"
</code></pre>
<h4 id="creating-tables-1"><a class="header" href="#creating-tables-1">Creating Tables</a></h4>
<pre><code class="language-py">from connect import engine
from tables import Base


Base.metadata.create_all(bind=engine)
</code></pre>
<h4 id="inserting-into-table"><a class="header" href="#inserting-into-table">Inserting into Table</a></h4>
<pre><code class="language-py">from sqlalchemy.orm import Session
from tables import Users, Comments
from connect import engine


# Session object
session = Session(bind=engine)


# Insert users
user1 = Users(
    name="John",
    fullname="John Doe",
    email="john@doe.com",
    # comments=[Comments(comment="hello"), Comments(comment="hey there")],
)

# Adding Single User
session.add(user1)
session.commit()


# Adding Multiple User
user2 = Users(
    name="Jake",
    fullname="Jake Smith",
    email="jake@smith.com",
    # comments=[Comments(comment="hello2"), Comments(comment="hey there2")],
)
user3 = Users(
    name="Joe",
    fullname="Joe Smith",
    email="joe@smith.com",
    # comments=[Comments(comment="hello3"), Comments(comment="hey there3")],
)

session.add_all([user2, user3])
session.commit()


# Add a smaple comment
comment1 = Comments(comment="hello world", user_id=1)
session.add(comment1)
session.commit()
</code></pre>
<h4 id="selecting"><a class="header" href="#selecting">Selecting</a></h4>
<pre><code class="language-py">from sqlalchemy import and_, select
from sqlalchemy.orm import Session
from connect import engine
from tables import Users


# Session object
session = Session(bind=engine)


# With ORM

## Simple select statement
res = session.query(Users)

## Simple select with where clause and session execute
statement = select(Users).where(Users.name.in_(["Jake", "Joe"]))
res = session.execute(statement)
print(res.all())

# filter vs filter_by

## Select with filter_by [Takes dict like kwargs keyword arguments for and arguments]
statement = select(Users).filter_by(name="John", id=1)
res = session.execute(statement)
print(res.all())

## Select with filter [for and/or arguments]
statement = select(Users).filter(and_(Users.name == "John", Users.id == 1))
res = session.execute(statement)

## scalar vs one
# + scalar will not raise exception if no rows present
# + one will raise exception if no rows present

## Getting user comment using scalars [can be derefrenced using dot]
for i in res.scalars():
    for comment in i.comments:
        print(comment.comment)
</code></pre>
<h4 id="joining"><a class="header" href="#joining">Joining</a></h4>
<pre><code class="language-py">from sqlalchemy.orm import Session
from connect import engine
from tables import Users, Comments
from sqlalchemy import select

session = Session(bind=engine)

# Left Join
statement = select(Users).join(Comments, Users.id == Comments.user_id)
rs = session.execute(statement)
print(rs.all())
</code></pre>
<h4 id="updating"><a class="header" href="#updating">Updating</a></h4>
<pre><code class="language-py">from sqlalchemy import select
from sqlalchemy.orm import Session
from connect import engine
from tables import Users

session = Session(bind=engine)

# Return None if no results found
res = session.query(Users).filter(Users.id == 1).first()

if res:
    res.name = "newname"
    res.fullname = "New Name"
    session.commit()
</code></pre>
<h4 id="deleting"><a class="header" href="#deleting">Deleting</a></h4>
<pre><code class="language-py">from sqlalchemy import select
from sqlalchemy.orm import Session
from connect import engine
from tables import Users

session = Session(bind=engine)

# Return None if no results found
res = session.query(Users).filter(Users.id == 1).first()

if res:
    session.delete(res)
    session.commit()
</code></pre>
<h2 id="sql-alchemy-coreorm-asyncio"><a class="header" href="#sql-alchemy-coreorm-asyncio">SQL Alchemy [core+orm] asyncio</a></h2>
<h4 id="core"><a class="header" href="#core">Core</a></h4>
<pre><code class="language-py">from sqlalchemy.ext.asyncio import create_async_engine
import asyncio
from sqlalchemy import Integer, MetaData, Table, Column, Text, insert
from sqlalchemy.sql import select


meta_obj = MetaData()
user_table = Table(
    "users",
    meta_obj,
    Column("id", Integer, primary_key=True),
    Column("name", Text, nullable=True),
)


async def main():
    DB_URL = "sqlite+aiosqlite:///test.db"
    engine = create_async_engine(DB_URL, echo=True)

    # can use begin -&gt; auto-commit ater transaction
    async with engine.begin() as conn:
        # Create db

        # meta_obj.create_all(bind=engine) [OLD]

        # [NEW]
        await conn.run_sync(meta_obj.create_all)

        # Insert Data
        statement = insert(user_table).values(name="John Doe")
        await conn.execute(statement)

        # Select Data
        statement = select(user_table)
        res = await conn.execute(statement)
        print(res.all())

    await engine.dispose()


asyncio.run(main())
</code></pre>
<h1 id="note-1"><a class="header" href="#note-1">Note:</a></h1>
<p>In SQLAlchemy, the term “expire on commit” refers to a configuration option for a session object
that determines whether or not the state of objects loaded from the database will be set to
“expired” when a transaction is committed. When an object’s state is expired, it means that any
changes made to the object during the transaction will be discarded, and the next time the object is
accessed, its state will be reloaded from the database.</p>
<h4 id="orm"><a class="header" href="#orm">ORM</a></h4>
<pre><code class="language-py">from sqlalchemy import Integer, Text, select
from sqlalchemy.ext.asyncio import create_async_engine, async_sessionmaker, AsyncSession
import asyncio
from sqlalchemy.orm import DeclarativeBase, Mapped, mapped_column


class Base(DeclarativeBase):
    pass


class Users(Base):
    __tablename__ = "users"
    id: Mapped[int] = mapped_column("id", Integer, primary_key=True)
    name: Mapped[str] = mapped_column("name", Text, nullable=False)


async def insert_data(sessmaker: async_sessionmaker[AsyncSession]):
    async with sessmaker() as session:
        newuser = Users(name="John Doe")
        session.add(newuser)
        await session.commit()


async def insert_data(sessmaker: async_sessionmaker[AsyncSession]):
    async with sessmaker() as session:
        st = select(Users).filter(Users.name == "John Doe")
        res = await session.execute(st)
        ans = res.scalars().first()

        if ans:
            print(ans.name)


async def main():
    # Initialize engine
    DB_URL = "sqlite+aiosqlite:///test.db"
    engine = create_async_engine(DB_URL, echo=True)

    # Session maker
    # session=Session(bind=engine) [OLD]

    # New
    session = async_sessionmaker(bind=engine, expire_on_commit=False)

    async with engine.begin() as conn:
        # Create db
        await conn.run_sync(Base.metadata.create_all)

    async with engine.connect() as conn:
        # Insert Data
        # await insert_data(session)

        # Select Data
        await insert_data(session)


asyncio.run(main())
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="redis"><a class="header" href="#redis">Redis</a></h1>
<blockquote>
<p>Redis is a memory-based database that is commonly used for caching purposes.
When we have a value that takes a long time to compute, we can cache it in Redis and
retrieve it quickly when we need it. This can significantly improve the performance
of our application by reducing the time it takes to compute the value.</p>
</blockquote>
<h3 id="key-value-pair"><a class="header" href="#key-value-pair">Key Value pair</a></h3>
<pre><code class="language-sh"># Set/Update key value
set name john

# Will return 1 if exists or 0 if not exists and will print the name if exists
get name

# Will return 1 if exists or 0 if not exists and will delete the key if exists
del name

# List all
keys *

# Delete all
flushall

# Get time to live
ttl name

# Set expiry time
EXPIRE name 10

# set with expiry time
setex name 10 john
</code></pre>
<h3 id="lists"><a class="header" href="#lists">Lists</a></h3>
<pre><code class="language-sh"># Push from the left and right
lpush arr john johnny
rpush arr hello hello2

# List all
range arr 0 -1

# Remove from left and right
lpop arr
rpop arr

# delete list
del arr
</code></pre>
<h3 id="sets-store-unique-values"><a class="header" href="#sets-store-unique-values">Sets [store unique values]</a></h3>
<pre><code class="language-sh"># Add to set
SADD hobbies "hello" 1 2

# List all members
SMEMBERS hobbies

# Remove members
SREM hobbies "hello"
</code></pre>
<h3 id="hashes-key-value-pair-inside-of-a-key-value"><a class="header" href="#hashes-key-value-pair-inside-of-a-key-value">Hashes [key value pair inside of a key value]</a></h3>
<p><strong>No nesting allowed.Imagine a JSON object we cannot have json inside json.</strong></p>
<pre><code class="language-sh">
# Set an attribute to hashset person
HSET person name john

# Get a single attribute from hashset person
HGET person name

# Getall attributes from hashset person
HGETALL person

# delete hashset attribute
HDEL person name

# delete hashset
DEL person
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="fastapi"><a class="header" href="#fastapi">FastAPI</a></h1>
<h3 id="install-dependencies-3"><a class="header" href="#install-dependencies-3">Install dependencies</a></h3>
<pre><code class="language-sh">pip install fastapi uvicorn sqlalchemy strawberry-graphql[debug-server] asyncio python-dotenv asyncpg
</code></pre>
<h2 id="a-simple-crud-app-using-sqlalchemy-coreasyncpgfastapi"><a class="header" href="#a-simple-crud-app-using-sqlalchemy-coreasyncpgfastapi">A simple crud app using sqlalchemy core,asyncpg,fastapi</a></h2>
<p>.env</p>
<pre><code>DB_URL=postgresql+asyncpg://postgres:@localhost/fastdb
</code></pre>
<blockquote>
<p>main.py</p>
</blockquote>
<pre><code class="language-py">import uvicorn
from fastapi import FastAPI
from sqlalchemy import delete, insert, select, update
from connectdb import engine
from tables import user_table, post_table
from schema import Post, PostBody, updateBody
from connectdb import engine


app = FastAPI()


@app.get("/post", response_model=list[Post])
async def get_all_posts():
    async with engine.connect() as conn:
        st = select(post_table)
        res = await conn.execute(st)
        data = res.scalars()
        return data


@app.get("/post/{id}", response_model=Post)
async def get_post_by_id(id: int):
    async with engine.connect() as conn:
        st = select(post_table).filter_by(id=id)
        res = await conn.execute(st)
        data = res.scalars()
        return data


@app.post("/post")
async def create_post(bd: PostBody):
    async with engine.connect() as conn:
        st = insert(post_table).values(
            title=bd.title, description=bd.description, author_id=bd.aid
        )
        await conn.execute(st)
        await conn.commit()
        return bd


@app.put("/post/{id}")
async def update_post(id: int, bd: updateBody):
    async with engine.connect() as conn:
        st = (
            update(post_table)
            .where(post_table.c.id == id)
            .values(title=bd.title, description=bd.description)
        )
        await conn.execute(st)
        await conn.commit()
        return bd


@app.delete("/post/{id}")
async def delete_post(id: int):
    async with engine.connect() as conn:
        st = delete(post_table).where(post_table.c.id == id)
        await conn.execute(st)
        await conn.commit()
    return {"msg": "Deleted!"}


@app.get("/")
async def hello():
    return {"msg": "hello_world"}


if __name__ == "__main__":
    uvicorn.run("main:app", reload=True, log_level="info", workers=4, port=5000)
</code></pre>
<blockquote>
<p>connectdb.py</p>
</blockquote>
<pre><code class="language-py">from sqlalchemy.ext.asyncio import create_async_engine
import asyncio
from tables import meta_obj
from dotenv import load_dotenv
import os


# Load ENV variables
load_dotenv()

# Engine
engine = create_async_engine(os.getenv("DB_URL"), echo=True)


# Create DB
async def main():
    async with engine.begin() as conn:
        await conn.run_sync(meta_obj.create_all)
        print("Connected to DB...")
    await engine.dispose()


asyncio.run(main())
</code></pre>
<blockquote>
<p>schema.py</p>
</blockquote>
<pre><code class="language-py">from pydantic import BaseModel
from datetime import datetime


class Post(BaseModel):
    id: int
    title: str
    description: str
    createdAt: datetime
    updatedAt: datetime
    author_id: int

    class Config:
        orm_mode = True


class PostBody(BaseModel):
    aid: int
    title: str
    description: str


class updateBody(BaseModel):
    title: str
    description: str
</code></pre>
<blockquote>
<p>tables.py</p>
</blockquote>
<pre><code class="language-py">from sqlalchemy import (
    MetaData,
    Column,
    Table,
    Integer,
    String,
    Text,
    ForeignKey,
    DateTime,
)
from datetime import datetime

meta_obj = MetaData()


# Users table
"""
Users Table
    - id (pk)
    - email (str)
    - password (str)
"""

args = [
    Column("id", Integer, primary_key=True),
    Column("email", String(50), unique=True, nullable=False),
    Column("password", String(50), nullable=False),
]
user_table = Table("users", meta_obj, *args)

# Post table
"""
Posts Table
    - id (pk)
    - title (str)
    - description (str)
    - createdAt(datetime)
    - updatedAt(datetime)
    - author_id (int,fk refrencing the id in user table)
"""

args = [
    Column("id", Integer, primary_key=True),
    Column("title", Text, unique=True, nullable=False),
    Column("description", Text, nullable=False),
    Column("createdAt", DateTime, default=datetime.utcnow),
    Column("updatedAt", DateTime, onupdate=datetime.utcnow),
    Column("author_id", Integer, ForeignKey("users.id")),
]
post_table = Table("posts", meta_obj, *args)
</code></pre>
<h2 id="a-simple-crud-app-using-sqlalchemy-ormasyncpgfastapi"><a class="header" href="#a-simple-crud-app-using-sqlalchemy-ormasyncpgfastapi">A simple crud app using sqlalchemy orm,asyncpg,fastapi</a></h2>
<p>.env</p>
<pre><code>DB_URL=postgresql+asyncpg://postgres:@localhost/fastdb
</code></pre>
<blockquote>
<p>main.py</p>
</blockquote>
<pre><code class="language-py">import uvicorn
from fastapi import FastAPI
from sqlalchemy import delete, insert, select, update
from connectdb import engine
from connectdb import sess
from schema import Post, PostBody, updateBody
from connectdb import engine
from crud import get_all, create_, update_, delete_


app = FastAPI()


@app.get("/post", response_model=list[Post])
async def get_all_posts():
    data = await get_all(sess)
    return data


@app.get("/post/{id}", response_model=Post)
async def get_post_by_id(id: int):
    pass


@app.post("/post", response_model=Post)
async def create_post(bd: PostBody):
    data = await create_(sess, bd)
    return data


@app.put("/post/{id}")
async def update_post(id: int, bd: updateBody):
    data = await update_(sess, bd, id)
    return data


@app.delete("/post/{id}")
async def delete_post(id: int):
    data = await delete_(sess, id)
    return data


@app.get("/")
async def hello():
    return {"msg": "hello_world"}


if __name__ == "__main__":
    uvicorn.run("main:app", reload=True, log_level="info", workers=4, port=5000)
</code></pre>
<blockquote>
<p>connectdb.py</p>
</blockquote>
<pre><code class="language-py">from sqlalchemy import text, create_engine
from sqlalchemy.ext.asyncio import create_async_engine, async_sessionmaker
import asyncio
from tables import Base
from dotenv import load_dotenv
import os


# Load ENV variables
load_dotenv()

# Engine
engine = create_async_engine(os.getenv("DB_URL"), echo=True)
sess = async_sessionmaker(bind=engine, expire_on_commit=False)


# Create DB
async def main():
    async with engine.begin() as conn:
        await conn.run_sync(Base.metadata.create_all)
        print("Connected to DB...")
    await engine.dispose()


asyncio.run(main())
</code></pre>
<blockquote>
<p>tables.py</p>
</blockquote>
<pre><code class="language-py">from sqlalchemy import (
    Integer,
    String,
    Text,
    ForeignKey,
    DateTime,
)
from datetime import datetime
from sqlalchemy.orm import Mapped, mapped_column, DeclarativeBase, relationship


class Base(DeclarativeBase):
    pass


# Users table
"""
Users Table
    - id (pk)
    - email (str)
    - password (str)
"""


class User(Base):
    __tablename__ = "users"
    id: Mapped[int] = mapped_column("id", Integer, primary_key=True)
    email: Mapped[str] = mapped_column("email", String(50), nullable=False)
    password: Mapped[str] = mapped_column("password", String(50), nullable=False)
    posts: Mapped[list["Post"]] = relationship(
        "Post", back_populates="user", cascade="delete,all"
    )


# Post table
"""
Posts Table
    - id (pk)
    - title (str)
    - description (str)
    - createdAt(datetime)
    - updatedAt(datetime)
    - author_id (int,fk refrencing the id in user table)
"""


class Post(Base):
    __tablename__ = "posts"
    id: Mapped[int] = mapped_column("id", Integer, primary_key=True)
    title: Mapped[str] = mapped_column("title", Text, nullable=False)
    description: Mapped[str] = mapped_column("description", Text, nullable=False)
    createdAt: Mapped[DateTime] = mapped_column(
        "createdAt", DateTime, default=datetime.utcnow
    )
    updatedAt: Mapped[DateTime] = mapped_column(
        "updatedAt", DateTime, onupdate=datetime.utcnow, nullable=True
    )
    user_id: Mapped[int] = mapped_column(
        "user_id", Integer, ForeignKey("users.id"), nullable=False
    )
    user: Mapped[User] = relationship(
        "User", back_populates="posts", cascade="delete,all"
    )
</code></pre>
<blockquote>
<p>schema.py</p>
</blockquote>
<pre><code class="language-py">from pydantic import BaseModel
from datetime import datetime


class Post(BaseModel):
    id: int
    title: str
    description: str
    createdAt: datetime
    user_id: int

    class Config:
        orm_mode = True


class PostBody(BaseModel):
    aid: int
    title: str
    description: str


class updateBody(BaseModel):
    title: str
    description: str
</code></pre>
<blockquote>
<p>crud.py</p>
</blockquote>
<pre><code class="language-py">from sqlalchemy import delete, update
from sqlalchemy.ext.asyncio import AsyncSession, async_sessionmaker
from sqlalchemy.sql import select
from tables import User, Post


async def get_all(sessmaker: async_sessionmaker[AsyncSession]):
    async with sessmaker() as session:
        st = select(Post)
        res = await session.execute(st)
        return res


async def get_by_id(sessmaker: async_sessionmaker[AsyncSession]):
    async with sessmaker() as session:
        pass


async def create_(sessmaker: async_sessionmaker[AsyncSession], data):
    async with sessmaker() as session:
        newpost = Post(title=data.title, description=data.description)
        newpost.user_id = data.aid

        session.add(newpost)
        await session.commit()
        print(newpost)
        return newpost


async def update_(sessmaker: async_sessionmaker[AsyncSession], data, id):
    async with sessmaker() as session:
        st = select(Post).where(Post.id == id)
        res = await session.execute(st)
        final_data = res.scalar()
        if final_data:
            if data.title:
                final_data.title = data.title
            if data.description:
                final_data.description = data.description
            await session.commit()
        return final_data


async def delete_(sessmaker: async_sessionmaker[AsyncSession], id):
    async with sessmaker() as session:
        print(id)
        st = delete(Post).where(Post.id == id)
        res = await session.execute(st)
        await session.commit()
        return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="react-hooks-1"><a class="header" href="#react-hooks-1">React Hooks</a></h1>
<p><strong>Basic Hooks</strong></p>
<h2 id="usestate-1"><a class="header" href="#usestate-1">useState</a></h2>
<p><strong>Note : State updates are not immediate.</strong></p>
<blockquote>
<p>Problem</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { useState } from 'react';

const App = () =&gt; {
    const [count, setCount] = useState(0);

    const handleClick = () =&gt; {
        // You may think on every click the value will increase by
        // 3. But it will not because the setCount function is still
        // using the old values of count.In react we need to use the
        // updater function in useState to grab the latest value.

        setCount(count + 1);
        setCount(count + 1);
        setCount(count + 1);
    };

    return (
        &lt;&gt;
            &lt;div&gt;
                &lt;h3&gt;{count}&lt;/h3&gt;
                &lt;button type="button" onClick={handleClick}&gt;
                    Increase
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>Fix</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { useState } from 'react';

const App = () =&gt; {
    const [count, setCount] = useState(0);

    const handleClick = () =&gt; {
        // You may think on every click the value will increase by
        // 3. But it will not because the setCount function is still
        // using the old values of count.In react we need to use the
        // updater function in useState to grab the latest value.

        setCount((prev) =&gt; prev + 1);
        setCount((prev) =&gt; prev + 1);
        setCount((prev) =&gt; prev + 1);
    };

    return (
        &lt;&gt;
            &lt;div&gt;
                &lt;h3&gt;{count}&lt;/h3&gt;
                &lt;button type="button" onClick={handleClick}&gt;
                    Increase
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>Dynamic object Keys form</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { useState } from 'react';

const App = () =&gt; {
    const [data, setData] = useState({ name: '', email: '' });
    const handleChange = (e) =&gt; {
        setData((data) =&gt; {
            return { ...data, [e.target.name]: e.target.value };
        });
    };
    return (
        &lt;div&gt;
            &lt;input
                type="text"
                name="name"
                value={data.name}
                onChange={handleChange}
            /&gt;
            &lt;input
                type="text"
                name="email"
                value={data.email}
                onChange={handleChange}
            /&gt;
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<h2 id="useeffect-1"><a class="header" href="#useeffect-1">useEffect</a></h2>
<p><strong>Component Mount/Unmount</strong></p>
<ul>
<li>useEffect gets triggered after the page/component in which it is in is rendered.</li>
<li>useEffect cleanup function gets triggered after the component which it is in is unmounted.</li>
</ul>
<blockquote>
<p>App.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { useState } from 'react';
import Hello from './Hello';

const App = () =&gt; {
    const [showhello, setShowhello] = useState(false);
    return (
        &lt;&gt;
            {console.log('App rendered!')}
            {showhello ? &lt;Hello /&gt; : ''}
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setShowhello(!showhello);
                }}
            &gt;
                CLick
            &lt;/button&gt;
            &lt;div&gt;
                &lt;h3&gt;App&lt;/h3&gt;
            &lt;/div&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>Hello.jsx</p>
</blockquote>
<pre><code class="language-js">import React, { useEffect } from 'react';

const Hello = () =&gt; {
    useEffect(() =&gt; {
        console.log(
            'Hello component useEffect is triggered after page has re-rendered!'
        );
        return () =&gt; {
            console.log('Unmounted hello!');
        };
    });

    return (
        &lt;&gt;
            {console.log('Render hello!')}
            &lt;h3&gt;hello&lt;/h3&gt;
        &lt;/&gt;
    );
};

export default Hello;
</code></pre>
<p><strong>Event Listeners in useEffect</strong></p>
<p>Use of cleanup functions.</p>
<ul>
<li>Must cancel the previous event Listeners,otherwise when the component gets
re-rendered we are going to have multiple event-listeners.</li>
</ul>
<blockquote>
<p>App.jsx [Problem and Fix 1]</p>
</blockquote>
<pre><code class="language-js">import React, { useEffect } from 'react';
import { useState } from 'react';
import Hello from './Hello';

const App = () =&gt; {
    const [count, setCount] = useState(0);
    useEffect(() =&gt; {
        // Main
        console.log(
            'This will run after we have painted the DOM with the below JSX'
        );

        // Cleanup [Apprender-&gt;cleanup(if any)-&gt;Trigger useEffect main]
        return () =&gt; {
            console.log('This will run to cancel previous useEffects if any!');
        };
    });
    return (
        &lt;&gt;
            {console.log('App rendered!')}
            {count}
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setCount((prev) =&gt; prev + 1);
                }}
            &gt;
                Click
            &lt;/button&gt;
            &lt;div&gt;
                &lt;h3&gt;App&lt;/h3&gt;
            &lt;/div&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>App.jsx [Problem and Fix 2]</p>
</blockquote>
<pre><code class="language-js">import React, { useEffect } from 'react';
import { useState } from 'react';

const App = () =&gt; {
    const [count, setCount] = useState(0);
    useEffect(() =&gt; {
        // Main
        const fn = () =&gt; {
            console.log('Mouse moved!');
        };

        window.addEventListener('mousemove', fn);

        // Cleanup [Apprender-&gt;cleanup(if any)-&gt;Trigger useEffect main]
        // Going tosave the refrence of function fn of previous useEffect as fn get re-created from scratch
        return () =&gt; {
            window.removeEventListener('mousemove', fn);
        };
    });
    return (
        &lt;&gt;
            {console.log('App rendered!')}
            {count}
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setCount((prev) =&gt; prev + 1);
                }}
            &gt;
                Click
            &lt;/button&gt;
            &lt;div&gt;
                &lt;h3&gt;App&lt;/h3&gt;
            &lt;/div&gt;
        &lt;/&gt;
    );
};

export default App;
</code></pre>
<p><strong>Fetch Function with useEffect using custom hooks</strong></p>
<p>Some note :</p>
<ul>
<li>Custom Hooks can have any arbitary name. Good Convention is
to give the “use” prefix to make the developer understand its
a hook.It is not a mandatory thing.</li>
</ul>
<ul>
<li>UseEffect only runs after dom is painted</li>
<li>Use Dependency array wisely.Below by adding count useEffect is triggerd when value of count changes.</li>
<li>2 phases for a custom default value return phase and value return phase</li>
</ul>
<blockquote>
<p>App.jsx</p>
</blockquote>
<pre><code class="language-js">import React, { useState } from 'react';
import customhook from './customhook';

const App = () =&gt; {
    const [count, setCount] = useState(0);
    const { data, isLoading, isErr } = customhook(count);

    if (isLoading) {
        console.log('Loading renderd!');
        return &lt;div&gt;Loading....&lt;/div&gt;;
    }
    if (isErr) {
        return &lt;div&gt;Error....&lt;/div&gt;;
    }

    return (
        &lt;div&gt;
            {console.log('App renderd!')}
            &lt;h3&gt;Count : {count}&lt;/h3&gt;
            &lt;div&gt;
                &lt;button
                    type="button"
                    onClick={() =&gt; {
                        setCount((prev) =&gt; prev + 1);
                    }}
                &gt;
                    Click
                &lt;/button&gt;
            &lt;/div&gt;
            {data}
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>customhook.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { useEffect } from 'react';
import { useState } from 'react';

const customhook = (count) =&gt; {
    const [result, setResult] = useState({
        data: [],
        isLoading: true,
        isErr: false
    });

    useEffect(() =&gt; {
        const fetchData = async () =&gt; {
            console.log('customhook effect triggered!');

            try {
                const data = await fetch(
                    `http://numbersapi.com/${count}/trivia`
                );
                const res = await data.text();
                setResult((data) =&gt; {
                    return {
                        ...data,
                        isLoading: false,
                        isErr: false,
                        data: res
                    };
                });
            } catch (err) {
                setResult((data) =&gt; {
                    return {
                        ...data,
                        isLoading: false,
                        isErr: true
                    };
                });
            }
        };
        fetchData();
    }, [count]);

    console.log('customhook renderd!');
    return result;
};

export default customhook;
</code></pre>
<h2 id="useref-1"><a class="header" href="#useref-1">useRef</a></h2>
<blockquote>
<p>Does not trigger re-render and persist the value across multiple re-renders</p>
</blockquote>
<ul>
<li>Keep track of times component re-renderd</li>
<li>Used in forms</li>
</ul>
<p>Note: on adding fetchData function in the above codes Dependency array
,it will cause and infinte loop.We can use useRef to strore the reference
of the function , so on re-render the function does not gets created from
scratch.</p>
<blockquote>
<p>Fix liniting errors</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import { useRef } from 'react';
import { useEffect } from 'react';
import { useState } from 'react';

const customhook = (count) =&gt; {
    const [result, setResult] = useState({
        data: [],
        isLoading: true,
        isErr: false
    });

    // An object with current variable
    // Get created with the first ct value during initial render , so thats wht ct is passed as an argument
    // Can be done with useState too but a function must be returned from a function, state is initialized during first render.

    const fetchData = useRef(async (ct) =&gt; {
        console.log('customhook effect triggered!');

        try {
            const data = await fetch(`http://numbersapi.com/${ct}/trivia`);
            const res = await data.text();
            setResult((data) =&gt; {
                return {
                    ...data,
                    isLoading: false,
                    isErr: false,
                    data: res
                };
            });
        } catch (err) {
            setResult((data) =&gt; {
                return {
                    ...data,
                    isLoading: false,
                    isErr: true
                };
            });
        }
    });

    useEffect(() =&gt; {
        // fetchData();
        fetchData.current(count);
    }, [fetchData.current, count]);

    console.log('customhook renderd!');
    return result;
};

export default customhook;
</code></pre>
<blockquote>
<p>Form example</p>
</blockquote>
<pre><code class="language-js">import React, { useRef } from 'react';

const App = () =&gt; {
    const rf = useRef(null);
    return (
        &lt;div&gt;
            &lt;input
                type="text"
                name="name"
                ref={rf}
                onChange={() =&gt; {
                    console.log(rf.current.value);
                }}
            /&gt;
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<p><strong>Performance Hooks</strong></p>
<h2 id="reactmemo-1"><a class="header" href="#reactmemo-1">React.memo</a></h2>
<p>In react a child component will re-render if its parent component re-renders,
even if the child components props have not changed.So this can lead to
performace degradation if we have many child components in our app,so
to fix it we can use Reacts memo to tell the component only to re-render when
its props change.But when child component re-renders parent does not re-render,but
the childs child component re-renders.</p>
<h3 id="a-problem-where-child-component-re-renders-even-if-its-props-dont-change-beacuse-its-parent-component-re-renders"><a class="header" href="#a-problem-where-child-component-re-renders-even-if-its-props-dont-change-beacuse-its-parent-component-re-renders">A problem where child component re-renders even if its props dont change beacuse its parent component re-renders</a></h3>
<blockquote>
<p>Problem</p>
</blockquote>
<blockquote>
<p>App.jsx</p>
</blockquote>
<pre><code class="language-js">import React, { useState } from 'react';
import List from './List';

const data = [
    { id: 1, name: 'Jack' },
    { id: 2, name: 'Joe' }
];

const App = () =&gt; {
    const [count, setCount] = useState(0);
    return (
        &lt;div&gt;
            &lt;h3&gt;Count : {count}&lt;/h3&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setCount((prev) =&gt; prev + 1);
                }}
            &gt;
                Click
            &lt;/button&gt;
            &lt;List people={data} /&gt;
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>List.jsx</p>
</blockquote>
<pre><code class="language-js">import React from 'react';
import Person from './Person';
const List = ({ people }) =&gt; {
    return (
        &lt;div&gt;
            {people.map((person) =&gt; {
                return &lt;Person key={person.id} {...person} /&gt;;
            })}
        &lt;/div&gt;
    );
};
export default List;
</code></pre>
<blockquote>
<p>Person.jsx</p>
</blockquote>
<pre><code class="language-js">const Person = ({ name }) =&gt; {
    return (
        &lt;div&gt;
            &lt;h4&gt;{name}&lt;/h4&gt;
        &lt;/div&gt;
    );
};
export default Person;
</code></pre>
<blockquote>
<p>Fix</p>
</blockquote>
<p>Move the counter to a seperate component.So that component becomes
a child component of App.jsx when attached to App.jsx.So when counter
renders then the counter and all its child component of counter will re-renders
not app.jsx.</p>
<h3 id="add-reactmemo-will-only-re-render-a-component-if-its-props-have-changed"><a class="header" href="#add-reactmemo-will-only-re-render-a-component-if-its-props-have-changed">Add react.memo() will only re-render a component if its props have changed</a></h3>
<pre><code class="language-js">import React, { useState } from 'react';
import Person from './Person';
const List = ({ people }) =&gt; {
    return (
        &lt;div&gt;
            {people.map((person) =&gt; {
                return &lt;Person key={person.id} {...person} /&gt;;
            })}
        &lt;/div&gt;
    );
};
export default React.memo(List);
</code></pre>
<h2 id="usecallback-1"><a class="header" href="#usecallback-1">useCallback</a></h2>
<blockquote>
<p>Cache a functions reference so that its does not gets created from scratch and its
refrence change</p>
</blockquote>
<p>Tip : Either use Dependency array or set state updater function if want to use latest value of a state.</p>
<blockquote>
<p>App.jsx</p>
</blockquote>
<pre><code class="language-js">import React, { useCallback, useState } from 'react';
import List from './List';

const data = [
    { id: 1, name: 'Jack' },
    { id: 2, name: 'Joe' },
    { id: 3, name: 'Jay' },
    { id: 4, name: 'Jase' }
];

const App = () =&gt; {
    const [count, setCount] = useState(0);
    const [res, setRes] = useState(data);

    const removePerson = useCallback(
        (id) =&gt; {
            // Still going to use the value of res it was first created on initial render
            const data = res.filter((p) =&gt; p.id != id);
            setRes(data);

            // Way 1
            // setRes((prev) =&gt; {
            //     return prev.filter((p) =&gt; p.id != id);
            // });

            // Way 2
        },
        [res]
    );

    return (
        &lt;div&gt;
            &lt;h3&gt;Count : {count}&lt;/h3&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setCount((prev) =&gt; prev + 1);
                }}
            &gt;
                Click
            &lt;/button&gt;
            &lt;List people={res} removePerson={removePerson} /&gt;
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<blockquote>
<p>List.jsx</p>
</blockquote>
<pre><code class="language-js">import React, { useState } from 'react';
import Person from './Person';
const List = ({ people, removePerson }) =&gt; {
    return (
        &lt;div&gt;
            {people.map((person) =&gt; {
                return (
                    &lt;Person
                        key={person.id}
                        {...person}
                        removePerson={removePerson}
                    /&gt;
                );
            })}
        &lt;/div&gt;
    );
};
export default React.memo(List);
</code></pre>
<blockquote>
<p>Person.jsx</p>
</blockquote>
<pre><code class="language-js">const Person = ({ name, id, removePerson }) =&gt; {
    return (
        &lt;div&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    removePerson(id);
                }}
            &gt;
                Remove
            &lt;/button&gt;
            &lt;h4&gt;{name}&lt;/h4&gt;
        &lt;/div&gt;
    );
};
export default Person;
</code></pre>
<h2 id="usememo-1"><a class="header" href="#usememo-1">useMemo</a></h2>
<blockquote>
<p>Cache a single value which takes a long time to compute</p>
</blockquote>
<pre><code class="language-js">import React, { useMemo, useState } from 'react';
import { slow } from './slowfunc';

const data = [
    { id: 1, name: 'Jack' },
    { id: 2, name: 'Joe' },
    { id: 3, name: 'Jay' },
    { id: 4, name: 'Jase' }
];

const App = () =&gt; {
    const [count, setCount] = useState(0);

    // Will be run only on first reder

    const val = useMemo(() =&gt; slow(), []);
    console.log(val);

    return (
        &lt;div&gt;
            &lt;h3&gt;Count : {count}&lt;/h3&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setCount((prev) =&gt; prev + 1);
                }}
            &gt;
                Click
            &lt;/button&gt;
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<p><strong>Useful Hooks</strong></p>
<h2 id="usecontext-context-api"><a class="header" href="#usecontext-context-api">useContext (Context API)</a></h2>
<blockquote>
<p>main.jsx</p>
</blockquote>
<pre><code class="language-js">import React, { createContext } from 'react';
import ReactDOM from 'react-dom/client';
import App from './App.jsx';
import { BrowserRouter } from 'react-router-dom';

export const userctx = createContext(null);
ReactDOM.createRoot(document.getElementById('root')).render(
    &lt;userctx.Provider value={{ name: 'sdas', id: 1 }}&gt;
        &lt;BrowserRouter&gt;
            &lt;App /&gt;
        &lt;/BrowserRouter&gt;
    &lt;/userctx.Provider&gt;
);
</code></pre>
<blockquote>
<p>About.jsx</p>
</blockquote>
<pre><code class="language-js">import React, { useContext } from 'react';
import { userctx } from '../main';

const About = () =&gt; {
    const val = useContext(userctx);
    console.log(val);
    return &lt;div&gt;About&lt;/div&gt;;
};

export default About;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="react-typescript"><a class="header" href="#react-typescript">React Typescript</a></h1>
<p>use React.FC to declare component type</p>
<h3 id="props"><a class="header" href="#props">Props</a></h3>
<p>Use interface</p>
<h3 id="hooks"><a class="header" href="#hooks">Hooks</a></h3>
<p>Types are declared using &lt;&gt;</p>
<h3 id="render-props"><a class="header" href="#render-props">Render props</a></h3>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="18_next_js_14"><a href="#18_next_js_14" class="header">18_next_JS_14</a></h1>
<h3 id="nextjs-14"><a class="header" href="#nextjs-14">NextJS 14</a></h3>
<h2 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h2>
<p><a href="https://nextjs.org/docs/getting-started/installation">NextJS</a></p>
<h3 id="create-app"><a class="header" href="#create-app">Create APP</a></h3>
<pre><code class="language-sh">npx create-next-app@latest
</code></pre>
<h2 id="folder-structure-1"><a class="header" href="#folder-structure-1">Folder Structure</a></h2>
<ul>
<li>app folder - where we will spend most of our time
<ul>
<li>setup routes, layouts, loading states, etc</li>
</ul>
</li>
<li>node_modules - project dependencies</li>
<li>public - static assets</li>
<li>.gitignore - sets which will be ignored by source control</li>
<li>bunch of config files (will discuss as we go)</li>
<li>in package.json look scripts</li>
<li>‘npm run dev’ to spin up the project on http://localhost:3000</li>
</ul>
<h2 id="home-page"><a class="header" href="#home-page">Home Page</a></h2>
<ul>
<li>
<p>page.js in the root of app folder</p>
</li>
<li>
<p>represents root of our application
‘/’ local domain or production domain</p>
</li>
<li>
<p>react component (server component)</p>
</li>
<li>
<p>bunch of css classes (will discuss Tailwind in few lectures)</p>
</li>
<li>
<p>export component as default</p>
</li>
<li>
<p>file name “page” has a special meaning</p>
</li>
<li>
<p>snippets extension</p>
<p>app/page.js</p>
</li>
</ul>
<pre><code class="language-js">const HomePage = () =&gt; {
    return (
        &lt;div&gt;
            &lt;h1 className="text-7xl"&gt;HomePage&lt;/h1&gt;
        &lt;/div&gt;
    );
};
export default HomePage;
</code></pre>
<h2 id="create-pages-in-nextjs"><a class="header" href="#create-pages-in-nextjs">Create Pages in Next.js</a></h2>
<ul>
<li>in the app folder create a folder with the page.js file
<ul>
<li>about/page.js</li>
<li>contact/page.js</li>
</ul>
</li>
<li>can have .js .jsx .tsx extension</li>
</ul>
<p>app/about/page.js</p>
<pre><code class="language-js">const AboutPage = () =&gt; {
    return (
        &lt;div&gt;
            &lt;h1 className="text-7xl"&gt;AboutPage&lt;/h1&gt;
        &lt;/div&gt;
    );
};
export default AboutPage;
</code></pre>
<h2 id="link-component"><a class="header" href="#link-component">Link Component</a></h2>
<ul>
<li>navigate around the project</li>
<li>import Link from ‘next/link’
home page</li>
</ul>
<pre><code class="language-js">import Link from 'next/link';

const HomePage = () =&gt; {
    return (
        &lt;div&gt;
            &lt;h1 className="text-7xl"&gt;HomePage&lt;/h1&gt;
            &lt;Link href="/about" className="text-2xl"&gt;
                about page
            &lt;/Link&gt;
        &lt;/div&gt;
    );
};
export default HomePage;
</code></pre>
<h2 id="nested-routes"><a class="header" href="#nested-routes">Nested Routes</a></h2>
<ul>
<li>app/about/info/page.js</li>
<li>if no page.js in a segment will result in 404</li>
</ul>
<pre><code class="language-js">const AboutInfoPage = () =&gt; {
    return &lt;h1 className="text-7xl"&gt;AboutInfoPage&lt;/h1&gt;;
};
export default AboutInfoPage;
</code></pre>
<h2 id="tailwind-and-daisyui"><a class="header" href="#tailwind-and-daisyui">Tailwind and DaisyUI</a></h2>
<p>Tailwind Site : https://tailwindcss.com/docs/installation
DaisyUI Site : https://daisyui.com/components/</p>
<ul>
<li>
<p>both videos optional</p>
</li>
<li>
<p>remove extra code in globals.css</p>
</li>
<li>
<p>install daisyui</p>
</li>
<li>
<p>install tailwindcss typography plugin</p>
</li>
<li>
<p>configure tailwind</p>
</li>
</ul>
<pre><code class="language-sh">npm i -D daisyui@latest
npm i @tailwindcss/typography
</code></pre>
<p>tailwind.config.js</p>
<pre><code class="language-js">/** @type {import('tailwindcss').Config} */
module.exports = {
  ...
  plugins: [require('@tailwindcss/typography'), require('daisyui')]
};

</code></pre>
<h2 id="layouts-and-templates"><a class="header" href="#layouts-and-templates">Layouts and Templates</a></h2>
<ul>
<li>
<p>layout.js</p>
</li>
<li>
<p>template.js</p>
<p>Layout is a component which wraps other pages and layouts. Allow to share UI. Even when the route changes, layout DOES NOT re-render. Can fetch data but can’t pass it down to children. Templates are the same but they re-render.</p>
</li>
<li>
<p>the top-most layout is called the Root Layout. This required layout is shared across all pages in an application. Root layouts must contain html and body tags.</p>
</li>
<li>
<p>any route segment can optionally define its own Layout. These layouts will be shared across all pages in that segment.</p>
</li>
<li>
<p>layouts in a route are nested by default. Each parent layout wraps child layouts below it using the React children prop.</p>
</li>
</ul>
<pre><code class="language-js">import { Inter } from 'next/font/google';
import './globals.css';

const inter = Inter({ subsets: ['latin'] });

export const metadata = {
    title: 'Next.js Tutorial',
    description: 'Build awesome stuff with Next.js!'
};

export default function RootLayout({ children }) {
    return (
        &lt;html lang="en"&gt;
            &lt;body className={inter.className}&gt;{children}&lt;/body&gt;
        &lt;/html&gt;
    );
}
</code></pre>
<h2 id="challenge---navbar"><a class="header" href="#challenge---navbar">Challenge - Navbar</a></h2>
<ul>
<li>in the root create components folder</li>
<li>create Navbar.jsx component</li>
<li>import Link component</li>
<li>setup a list of links (to existing pages)</li>
<li>iterate over the list</li>
<li>render Navbar in the app/layout.js</li>
<li>setup the same layout for all pages (hint: wrap children prop)</li>
</ul>
<h2 id="setup-navbar"><a class="header" href="#setup-navbar">Setup Navbar</a></h2>
<p>components/Navbar</p>
<pre><code class="language-js">import Link from 'next/link';
import React from 'react';

const Navbar = () =&gt; {
    const links = [
        { name: 'client', href: '/client' },
        { name: 'drinks', href: '/drinks' },
        { name: 'tasks', href: '/tasks' },
        { name: 'query', href: '/query' }
    ];
    return (
        &lt;nav className="bg-base-300 py-4"&gt;
            &lt;div className="navbar px-8 max-w-6xl mx-auto flex-col sm:flex-row"&gt;
                &lt;ul className="menu menu-horizontal md:ml-8"&gt;
                    &lt;li&gt;
                        &lt;Link href={`/`}&gt;Home Page&lt;/Link&gt;
                    &lt;/li&gt;
                    {links.map(({ name, href }) =&gt; {
                        return (
                            &lt;li&gt;
                                &lt;Link href={`${href}`}&gt;{name}&lt;/Link&gt;
                            &lt;/li&gt;
                        );
                    })}
                &lt;/ul&gt;
            &lt;/div&gt;
        &lt;/nav&gt;
    );
};

export default Navbar;
</code></pre>
<p>app/layout</p>
<pre><code class="language-js">import type { Metadata } from 'next';
import { Inter } from 'next/font/google';
import './globals.css';
import Navbar from '@/components/Navbar';

const inter = Inter({ subsets: ['latin'] });

export const metadata: Metadata = {
    title: 'Create Next App',
    description: 'Generated by create next app'
};

export default function RootLayout({
    children
}: Readonly&lt;{
    children: React.ReactNode;
}&gt;) {
    return (
        &lt;html lang="en"&gt;
            &lt;body className={inter.className}&gt;
                &lt;Navbar /&gt;
                &lt;main className="px-8 py-20 max-w-6xl mx-auto"&gt;{children}&lt;/main&gt;
            &lt;/body&gt;
        &lt;/html&gt;
    );
}
</code></pre>
<h2 id="server-components-vs-client-components"><a class="header" href="#server-components-vs-client-components">Server Components VS Client Components</a></h2>
<ul>
<li>
<p><a href="https://nextjs.org/docs/app/building-your-application/rendering/server-components">Server Components</a></p>
</li>
<li>
<p><a href="https://nextjs.org/docs/app/building-your-application/rendering/client-components">Client Components</a></p>
</li>
<li>
<p>BY DEFAULT, NEXT.JS USES SERVER COMPONENTS !!!!</p>
</li>
<li>
<p>To use Client Components, you can add the React “use client” directive</p>
</li>
</ul>
<h3 id="server-components"><a class="header" href="#server-components">Server Components</a></h3>
<p>Benefits :</p>
<ul>
<li>data fetching</li>
<li>security</li>
<li>caching</li>
<li>bundle size</li>
</ul>
<p>Data Fetching: Server Components allow you to move data fetching to the server, closer to your data source. This can improve performance by reducing time it takes to fetch data needed for rendering, and the amount of requests the client needs to make.
Security: Server Components allow you to keep sensitive data and logic on the server, such as tokens and API keys, without the risk of exposing them to the client.
Caching: By rendering on the server, the result can be cached and reused on subsequent requests and across users. This can improve performance and reduce cost by reducing the amount of rendering and data fetching done on each request.
Bundle Sizes: Server Components allow you to keep large dependencies that previously would impact the client JavaScript bundle size on the server. This is beneficial for users with slower internet or less powerful devices, as the client does not have to download, parse and execute any JavaScript for Server Components.
Initial Page Load and First Contentful Paint (FCP): On the server, we can generate HTML to allow users to view the page immediately, without waiting for the client to download, parse and execute the JavaScript needed to render the page.
Search Engine Optimization and Social Network Shareability: The rendered HTML can be used by search engine bots to index your pages and social network bots to generate social card previews for your pages.
Streaming: Server Components allow you to split the rendering work into chunks and stream them to the client as they become ready. This allows the user to see parts of the page earlier without having to wait for the entire page to be rendered on the server.</p>
<h3 id="client-components"><a class="header" href="#client-components">Client Components</a></h3>
<p>Benefits :</p>
<ul>
<li>Interactivity: Client Components can use state, effects, and event listeners, meaning they can provide immediate feedback to the user and update the UI.</li>
<li>Browser APIs: Client Components have access to browser APIs, like geolocation or localStorage, allowing you to build UI for specific use cases.</li>
</ul>
<h2 id="challenge---setup-counter"><a class="header" href="#challenge---setup-counter">Challenge - Setup Counter</a></h2>
<ul>
<li>setup our home page (no restrictions)</li>
<li>setup a simple counter in app/client/page.js</li>
</ul>
<h3 id="counter--client-component"><a class="header" href="#counter--client-component">Counter ( Client Component)</a></h3>
<pre><code class="language-js">import React, { useState } from 'react';

const ClientPage = () =&gt; {
    const [count, setCount] = useState(0);
    return (
        &lt;div&gt;
            &lt;h3&gt;ClientPage&lt;/h3&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    setCount((c) =&gt; c + 1);
                }}
            &gt;
                {count}
            &lt;/button&gt;
        &lt;/div&gt;
    );
};

export default ClientPage;
</code></pre>
<h2 id="challenge---fetch-data-in-drinks-page"><a class="header" href="#challenge---fetch-data-in-drinks-page">Challenge - Fetch Data in Drinks Page</a></h2>
<ul>
<li>setup logic</li>
<li>visit the page</li>
<li>look for log in the terminal 😀</li>
</ul>
<p>app/drinks/page.js</p>
<pre><code class="language-js">const url = 'https://www.thecocktaildb.com/api/json/v1/1/search.php?f=a';

const DrinksPage = async () =&gt; {
    const response = await fetch(url);
    const data = await response.json();
    console.log(data);
    return (
        &lt;div&gt;
            &lt;h1 className="text-7xl"&gt;DrinksPage&lt;/h1&gt;
        &lt;/div&gt;
    );
};
export default DrinksPage;
</code></pre>
<h2 id="loading-component"><a class="header" href="#loading-component">Loading Component</a></h2>
<p>The special file loading.js helps you create meaningful Loading UI with React Suspense. With this convention, you can show an instant loading state from the server while the content of a route segment loads. The new content is automatically swapped in once rendering is complete.</p>
<ul>
<li>drinks/loading.js</li>
</ul>
<pre><code class="language-js">const loading = () =&gt; {
    return &lt;span className="loading"&gt;&lt;/span&gt;;
};
export default loading;
</code></pre>
<ul>
<li>refactor drinks page</li>
</ul>
<pre><code class="language-js">import React from 'react';

const url = 'https://www.thecocktaildb.com/api/json/v1/1/search.php?f=a';
const fetchData = async () =&gt; {
    await new Promise((res, _) =&gt; {
        setTimeout(() =&gt; {
            res('Done!');
        }, 1000);
    });
    const resp = await fetch(url);
    // throw error
    if (!resp.ok) {
        throw new Error('Failed to fetch drinks...');
    }
    const data = await resp.json();
    return data;
};

const DrinksPage = async () =&gt; {
    const data = await fetchData();
    console.log(data);

    return &lt;div&gt;DrinksPage&lt;/div&gt;;
};

export default DrinksPage;
</code></pre>
<h2 id="error-component"><a class="header" href="#error-component">Error Component</a></h2>
<p>The error.js file convention allows you to gracefully handle unexpected runtime errors in nested routes.</p>
<ul>
<li>drinks/error.js</li>
<li>‘use client’</li>
</ul>
<pre><code class="language-js">'use client';
const error = (err: any) =&gt; {
    return &lt;div&gt;there was an error... {err.error.message}&lt;/div&gt;;
};
export default error;
</code></pre>
<h2 id="nested-layouts"><a class="header" href="#nested-layouts">Nested Layouts</a></h2>
<ul>
<li>
<p>create app/drinks/layout.js</p>
</li>
<li>
<p>UI will be applied to app/drinks - segment</p>
</li>
<li>
<p>don’t forget about the “children”</p>
</li>
<li>
<p>we can fetch data in the layout but…
at the moment can’t pass data down to children (pages) 😞</p>
<p>layout.js</p>
</li>
</ul>
<pre><code class="language-js">export default function DrinksLayout({ children }) {
    return (
        &lt;div className="max-w-xl "&gt;
            &lt;div className="mockup-code mb-8"&gt;
                &lt;pre data-prefix="$"&gt;
                    &lt;code&gt;npx create-next-app@latest nextjs-tutorial&lt;/code&gt;
                &lt;/pre&gt;
            &lt;/div&gt;
            {children}
        &lt;/div&gt;
    );
}
</code></pre>
<h2 id="dynamic-routes-1"><a class="header" href="#dynamic-routes-1">Dynamic Routes</a></h2>
<ul>
<li>app/drinks/[id]/page.js</li>
</ul>
<pre><code class="language-js">const page = ({ params }) =&gt; {
    console.log(params);

    return (
        &lt;div&gt;
            &lt;h1 className="text-7xl"&gt;{params.id}&lt;/h1&gt;
        &lt;/div&gt;
    );
};
export default page;
</code></pre>
<h2 id="challenge---drinks-list"><a class="header" href="#challenge---drinks-list">Challenge - Drinks List</a></h2>
<ul>
<li>render a list of drinks</li>
<li>each item is a link to a drink[id] page</li>
</ul>
<h2 id="drinks-list"><a class="header" href="#drinks-list">Drinks List</a></h2>
<ul>
<li>create components/DrinksList.jsx</li>
<li>render in drinks/page and pass the drinks down</li>
<li>iterate over the drinks and return links</li>
</ul>
<p>DrinksList.jsx</p>
<pre><code class="language-js">import Link from 'next/link';

const DrinksList = ({ drinks }) =&gt; {
    return (
        &lt;ul className="menu menu-vertical pl-0"&gt;
            {drinks.map((drink) =&gt; (
                &lt;li key={drink.idDrink}&gt;
                    &lt;Link
                        href={`/drinks/${drink.idDrink}`}
                        className="text-xl font-medium"
                    &gt;
                        {drink.strDrink}
                    &lt;/Link&gt;
                &lt;/li&gt;
            ))}
        &lt;/ul&gt;
    );
};
export default DrinksList;
</code></pre>
<p>app/drinks/page.js</p>
<pre><code class="language-js">const url = 'https://www.thecocktaildb.com/api/json/v1/1/search.php?f=a';
import DrinksList from '@/components/DrinksList';
const fetchDrinks = async () =&gt; {
    // just for demo purposes
    await new Promise((resolve) =&gt; setTimeout(resolve, 1000));
    const response = await fetch(url);

    if (!response.ok) {
        throw new Error('Failed to fetch drinks...');
    }
    const data = await response.json();
    return data;
};

const DrinksPage = async () =&gt; {
    const data = await fetchDrinks();

    return (
        &lt;div&gt;
            &lt;DrinksList drinks={data.drinks} /&gt;
        &lt;/div&gt;
    );
};
export default DrinksPage;
</code></pre>
<h2 id="challenge---render-single-drink"><a class="header" href="#challenge---render-single-drink">Challenge - Render Single Drink</a></h2>
<ul>
<li>in drinks/[id], fetch and render drink title</li>
<li>hint:params object</li>
</ul>
<pre><code class="language-js">const url = 'https://www.thecocktaildb.com/api/json/v1/1/lookup.php?i=';
</code></pre>
<h2 id="render-single-drink"><a class="header" href="#render-single-drink">Render Single Drink</a></h2>
<p>drinks/[id]/page.js</p>
<pre><code class="language-js">import Link from 'next/link';
const url = 'https://www.thecocktaildb.com/api/json/v1/1/lookup.php?i=';

const getSingleDrink = async (id) =&gt; {
    const res = await fetch(`${url}${id}`);

    if (!res.ok) {
        throw new Error('Failed to fetch drink...');
    }
    return res.json();
};

const SingleDrink = async ({ params }) =&gt; {
    const data = await getSingleDrink(params.id);
    const title = data?.drinks[0]?.strDrink;
    const imgSrc = data?.drinks[0]?.strDrinkThumb;
    return (
        &lt;div&gt;
            &lt;Link href="/drinks" className="btn btn-primary mt-8 mb-12"&gt;
                back to drinks
            &lt;/Link&gt;
            &lt;h1 className="text-4xl mb-8"&gt;{title}&lt;/h1&gt;
        &lt;/div&gt;
    );
};
export default SingleDrink;
</code></pre>
<h2 id="next-image-component"><a class="header" href="#next-image-component">Next Image Component</a></h2>
<ul>
<li>get random image from pexels site
<a href="https://www.pexels.com/photo/red-glass-with-garnished-beverage-2842876/">Random Drink</a></li>
</ul>
<p>The Next.js Image component extends the HTML <img> element with features for automatic image optimization:</p>
<ul>
<li>Size Optimization: Automatically serve correctly sized images for each device, using modern image formats like WebP and AVIF.</li>
<li>Visual Stability: Prevent layout shift automatically when images are loading.</li>
<li>Faster Page Loads: Images are only loaded when they enter the viewport using native browser lazy loading, with optional blur-up placeholders.</li>
<li>Asset Flexibility: On-demand image resizing, even for images stored on remote servers</li>
</ul>
<p>drinks[id]/page.js</p>
<pre><code class="language-js">import Link from 'next/link';
const url = 'https://www.thecocktaildb.com/api/json/v1/1/lookup.php?i=';

import drinkImg from './drink.jpg';
import Image from 'next/image';

const SingleDrink = async ({ params }) =&gt; {
    const data = await getSingleDrink(params.id);
    const title = data?.drinks[0]?.strDrink;
    const imgSrc = data?.drinks[0]?.strDrinkThumb;
    return (
        &lt;div&gt;
            &lt;Link href="/drinks" className="btn btn-primary mt-8 mb-12"&gt;
                back to drinks
            &lt;/Link&gt;
            {/* &lt;img src={imgSrc} alt='' /&gt; */}
            &lt;Image src={drinkImg} className="w-48 h-48 rounded" alt="" /&gt;
            &lt;h1 className="text-4xl mb-8"&gt;{title}&lt;/h1&gt;
        &lt;/div&gt;
    );
};
export default SingleDrink;
</code></pre>
<h2 id="remote-images"><a class="header" href="#remote-images">Remote Images</a></h2>
<ul>
<li>
<p>To use a remote image, the src property should be a URL string.</p>
</li>
<li>
<p>Since Next.js does not have access to remote files during the build process, you’ll need to provide the width, height and optional blurDataURL props manually.</p>
</li>
<li>
<p>The width and height attributes are used to infer the correct aspect ratio of image and avoid layout shift from the image loading in. The width and height do not determine the rendered size of the image file.</p>
</li>
<li>
<p>To safely allow optimizing images, define a list of supported URL patterns in next.config.js. Be as specific as possible to prevent malicious usage.</p>
</li>
<li>
<p>restart dev server</p>
</li>
<li>
<p>priority property to prioritize the image for loading</p>
</li>
</ul>
<pre><code class="language-js">const SingleDrink = async ({ params }) =&gt; {
    const data = await getSingleDrink(params.id);
    const title = data?.drinks[0]?.strDrink;
    const imgSrc = data?.drinks[0]?.strDrinkThumb;
    return (
        &lt;div&gt;
            &lt;Link href="/drinks" className="btn btn-primary mt-8 mb-12"&gt;
                back to drinks
            &lt;/Link&gt;
            {/* &lt;img src={imgSrc} alt='' /&gt; */}
            {/* &lt;Image src={drinkImg} className='w-48 h-48 rounded' alt='' /&gt; */}
            &lt;Image
                src={imgSrc}
                width={300}
                height={300}
                className="w-48 h-48 rounded shadow-lg mb-4"
                priority
                alt=""
            /&gt;
            &lt;h1 className="text-4xl mb-8"&gt;{title}&lt;/h1&gt;
        &lt;/div&gt;
    );
};
export default SingleDrink;
</code></pre>
<pre><code class="language-js">** @type {import('next').NextConfig} */
const nextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'www.thecocktaildb.com',
        port: '',
        pathname: '/images/**',
      },
    ],
  },
};

module.exports = nextConfig;
</code></pre>
<h2 id="remote-images---responsive"><a class="header" href="#remote-images---responsive">Remote Images - Responsive</a></h2>
<ul>
<li>
<p>The fill prop allows your image to be sized by its parent element</p>
</li>
<li>
<p>sizes property helps the browser select the most appropriate image size to load based on the user’s device and screen size, improving website performance and user experience.</p>
<p>DrinksList.jsx</p>
</li>
</ul>
<pre><code class="language-js">import Image from 'next/image';
import Link from 'next/link';

const DrinksList = ({ drinks }) =&gt; {
    return (
        &lt;ul className="grid sm:grid-cols-2 gap-6 mt-6"&gt;
            {drinks.map((drink) =&gt; (
                &lt;li key={drink.idDrink}&gt;
                    &lt;Link
                        href={`/drinks/${drink.idDrink}`}
                        className="text-xl font-medium"
                    &gt;
                        &lt;div className="relative h-48 mb-4"&gt;
                            &lt;Image
                                src={drink.strDrinkThumb}
                                fill
                                sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw"
                                alt={drink.strDrink}
                                className="rounded-md object-cover"
                            /&gt;
                        &lt;/div&gt;
                        {drink.strDrink}
                    &lt;/Link&gt;
                &lt;/li&gt;
            ))}
        &lt;/ul&gt;
    );
};
export default DrinksList;
</code></pre>
<h2 id="more-routing"><a class="header" href="#more-routing">More Routing</a></h2>
<ul>
<li>
<p>Private Folders
_folder</p>
</li>
<li>
<p>Route Groups
(dashboard)</p>
</li>
<li>
<p>Dynamic Routes</p>
<ul>
<li>[…folder] - Catch-all route segment</li>
<li>[[…folder]] Optional catch-all route segment (used by Clerk)</li>
</ul>
</li>
<li>
<p>create test folder app/_css</p>
</li>
<li>
<p>create app/(dashboard)/auth</p>
<ul>
<li>the url is just ‘/auth’</li>
</ul>
</li>
<li>
<p>create app/(dashboard)/auth/[sign-in]</p>
</li>
</ul>
<pre><code class="language-js">const SignInPage = ({ params }) =&gt; {
    console.log(params);
    return &lt;div&gt;SignInPage&lt;/div&gt;;
};
export default SignInPage;
</code></pre>
<ul>
<li>create app/(dashboard)/auth/[…sign-in]</li>
<li>create app/(dashboard)/auth/[[…sign-in]]</li>
</ul>
<h2 id="prisma"><a class="header" href="#prisma">Prisma</a></h2>
<ul>
<li>install prisma vs-code extension</li>
</ul>
<p><a href="https://www.prisma.io/docs/concepts/database-connectors/sqlite">Prisma sqlite</a></p>
<p>Prisma ORM is a database toolkit that simplifies database access in web applications. It allows developers to interact with databases using a type-safe and auto-generated API, making database operations easier and more secure.</p>
<ul>
<li>Prisma server: A standalone infrastructure component sitting on top of your database.</li>
<li>Prisma client: An auto-generated library that connects to the Prisma server and lets you read, write and stream data in your database. It is used for data access in your applications.</li>
</ul>
<pre><code class="language-sh">npm install prisma --save-dev
npm install @prisma/client
</code></pre>
<pre><code class="language-sh">npx prisma init
</code></pre>
<p>This creates a new prisma directory with your Prisma schema file and configures SQLite as your database. You’re now ready to model your data and create your database with some tables.</p>
<pre><code class="language-prisma">generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}
</code></pre>
<ul>
<li>ADD .ENV TO .GITIGNORE !!!!</li>
</ul>
<p>.env</p>
<pre><code class="language-js">DATABASE_URL = 'file:./dev.db';
</code></pre>
<h2 id="setup-instance"><a class="header" href="#setup-instance">Setup Instance</a></h2>
<p>In development, the command next dev clears Node.js cache on run. This in turn initializes a new PrismaClient instance each time due to hot reloading that creates a connection to the database. This can quickly exhaust the database connections as each PrismaClient instance holds its own connection pool.</p>
<p>(Prisma Instance)[https://www.prisma.io/docs/guides/other/troubleshooting-orm/help-articles/nextjs-prisma-client-dev-practices#solution]</p>
<ul>
<li>create utils/db.ts</li>
</ul>
<pre><code class="language-js">import { PrismaClient } from '@prisma/client';

const prismaClientSingleton = () =&gt; {
  return new PrismaClient();
};

type PrismaClientSingleton = ReturnType&lt;typeof prismaClientSingleton&gt;;

const globalForPrisma = globalThis as unknown as {
  prisma: PrismaClientSingleton | undefined;
};

const prisma = globalForPrisma.prisma ?? prismaClientSingleton();

export default prisma;

if (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;
</code></pre>
<h2 id="create-model"><a class="header" href="#create-model">Create Model</a></h2>
<pre><code class="language-prisma">model Task {
  id String @id @default(uuid())
  content String
  createdAt DateTime @default(now())
  completed Boolean @default(false)
}
</code></pre>
<ul>
<li>safely applies and tracks changes to the database structure.</li>
</ul>
<pre><code class="language-sh">npx prisma migrate dev
</code></pre>
<h3 id="prisma-model"><a class="header" href="#prisma-model">Prisma Model</a></h3>
<p>The Prisma model provided is a representation of a Task entity in the context of a database schema. Here’s a detailed description of each component within this model:</p>
<p>model Task { … }: This is the definition of the Task model. In Prisma, a model represents a table in the database. It serves as a blueprint for the records that will be stored in the corresponding table, defining the structure and behavior of the data.</p>
<p>id String @id @default(uuid()): This line defines a field named id of type String which is marked with @id, signifying that this field is the primary key of the model. The @default(uuid()) directive indicates that the default value for this field will be a UUID (Universally Unique Identifier) generated by Prisma.</p>
<p>content String: This line declares a field named content of type String. This field will store textual data, presumably the details or description of the task.</p>
<p>createdAt DateTime @default(now()): This field is named createdAt and is of type DateTime. It has a default value set to the current timestamp at the time of record creation, indicated by the @default(now()) directive.</p>
<p>completed Boolean @default(false): Lastly, the completed field is of type Boolean and is used to indicate whether the task has been completed. It defaults to false, meaning when a new task record is created, it is considered incomplete by default.</p>
<p>In Prisma, the term “model” refers to an abstraction that maps to a table in your database. Prisma models are defined in the Prisma schema, which is a declarative representation of your database’s structure. Each model in the Prisma schema corresponds to a table in the database, and each field within a model corresponds to a column in that table. This schema plays a central role in Prisma’s features, such as type-safe database access and migrations.</p>
<h2 id="prisma-example"><a class="header" href="#prisma-example">Prisma Example</a></h2>
<ul>
<li>remove query</li>
<li>fix the links the navbar</li>
</ul>
<pre><code class="language-js">import prisma from '@/utils/db';

const prismaHandlers = async () =&gt; {
    await prisma.task.create({
        data: {
            content: 'wake up'
        }
    });
    const allTasks = await prisma.task.findMany({
        orderBy: {
            createdAt: 'desc'
        }
    });

    return allTasks;
};

const Prisma = async () =&gt; {
    const tasks = await prismaHandlers();
    return (
        &lt;div&gt;
            &lt;h1 className="text-3xl font-medium mb-4"&gt;Prisma Example &lt;/h1&gt;
            {tasks.map((task) =&gt; {
                return (
                    &lt;h2 key={task.id} className="text-xl py-2"&gt;
                        😬 {task.content}
                    &lt;/h2&gt;
                );
            })}
        &lt;/div&gt;
    );
};
export default Prisma;
</code></pre>
<h2 id="optional---prisma-crud"><a class="header" href="#optional---prisma-crud">Optional - Prisma Crud</a></h2>
<p><a href="https://www.prisma.io/docs/concepts/components/prisma-client/crud">Prisma Docs</a></p>
<ul>
<li>Create Single Record</li>
</ul>
<pre><code class="language-js">const task = await prisma.task.create({
    data: {
        content: 'some task'
    }
});
</code></pre>
<ul>
<li>Get All Records</li>
</ul>
<pre><code class="language-js">const tasks = await prisma.task.findMany();
</code></pre>
<ul>
<li>Get record by ID or unique identifier</li>
</ul>
<pre><code class="language-js">// By unique identifier
const user = await prisma.user.findUnique({
    where: {
        email: 'elsa@prisma.io'
    }
});

// By ID
const task = await prisma.task.findUnique({
    where: {
        id: id
    }
});
</code></pre>
<ul>
<li>Update Record</li>
</ul>
<pre><code class="language-js">const updateTask = await prisma.task.update({
    where: {
        id: id
    },
    data: {
        content: 'updated task'
    }
});
</code></pre>
<ul>
<li>Update or create records</li>
</ul>
<pre><code class="language-js">const upsertTask = await prisma.task.upsert({
    where: {
        id: id
    },
    update: {
        content: 'some value'
    },
    create: {
        content: 'some value'
    }
});
</code></pre>
<ul>
<li>Delete a single record</li>
</ul>
<pre><code class="language-js">const deleteTask = await prisma.task.delete({
    where: {
        id: id
    }
});
</code></pre>
<h2 id="challenge---display-tasks"><a class="header" href="#challenge---display-tasks">Challenge - Display Tasks</a></h2>
<ul>
<li>create TaskForm, TaskList, DeleteForm components</li>
<li>render them in tasks page</li>
<li>in TaskList render all tasks</li>
<li>also display editBtn and DeleteForm</li>
<li>editBtn - link to single task page</li>
<li>reference the complete project</li>
</ul>
<p>tasks/page.js</p>
<pre><code class="language-js">import TaskForm from '@/components/TaskForm';
import TaskList from '@/components/TaskList';

const TasksPage = () =&gt; {
    return (
        &lt;div className="max-w-lg"&gt;
            &lt;TaskForm /&gt;
            &lt;TaskList /&gt;
        &lt;/div&gt;
    );
};
export default TasksPage;
</code></pre>
<p>components/TaskList</p>
<pre><code class="language-js">import prisma from '@/utils/db';
import Link from 'next/link';
import DeleteForm from './DeleteForm';

const TaskList = async () =&gt; {
    const tasks = await prisma.task.findMany({
        orderBy: {
            createdAt: 'desc'
        }
    });
    if (tasks.length === 0)
        return &lt;h2 className="mt-8 font-medium text-lg"&gt;No tasks to show&lt;/h2&gt;;
    return (
        &lt;ul className="mt-8"&gt;
            {tasks.map((task) =&gt; (
                &lt;li
                    key={task.id}
                    className="flex justify-between items-center px-6 py-4 mb-4 border border-base-300 rounded-lg shadow-lg"
                &gt;
                    &lt;h2
                        className={`text-lg capitalize ${
                            task.completed ? 'line-through' : null
                        }`}
                    &gt;
                        {task.content}
                    &lt;/h2&gt;
                    &lt;div className="flex gap-6 items-center"&gt;
                        &lt;Link
                            href={`/tasks/${task.id}`}
                            className="btn btn-accent btn-xs"
                        &gt;
                            edit
                        &lt;/Link&gt;
                        &lt;DeleteForm id={task.id} /&gt;
                    &lt;/div&gt;
                &lt;/li&gt;
            ))}
        &lt;/ul&gt;
    );
};
export default TaskList;
</code></pre>
<h2 id="server-actions"><a class="header" href="#server-actions">Server Actions</a></h2>
<ul>
<li>
<p>asynchronous server functions that can be called directly from your components.</p>
</li>
<li>
<p>typical setup for server state mutations (create, update, delete)</p>
<ul>
<li>endpoint on the server (api route on Next.js)</li>
<li>make request from the front-end
<ul>
<li>setup form, handle submission etc</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Next.js server actions allow you to mutate server state directly from within a React component by defining server-side logic alongside client-side interactions.</p>
</li>
</ul>
<p>Rules :</p>
<ul>
<li>must be async</li>
<li>add ‘use server’ in function body
<ul>
<li>use only in React Server Component</li>
</ul>
</li>
</ul>
<pre><code class="language-js">export default function ServerComponent() {
    async function myAction(formData) {
        'use server';
        // access input values with formData
        // formData.get('name')
        // mutate data (server)
        // revalidate cache
    }

    return &lt;form action={myAction}&gt;...&lt;/form&gt;;
}
</code></pre>
<ul>
<li>or setup in a separate file (‘use server’ at the top)
<ul>
<li>can use in both (RSC and RCC)</li>
</ul>
</li>
</ul>
<p>utils/actions.js</p>
<pre><code class="language-js">'use server';

export async function myAction() {
    // ...
}
</code></pre>
<pre><code class="language-js">'use client';

import { myAction } from './actions';

export default function ClientComponent() {
    return (
        &lt;form action={myAction}&gt;
            &lt;button type="submit"&gt;Add to Cart&lt;/button&gt;
        &lt;/form&gt;
    );
}
</code></pre>
<h2 id="taskform"><a class="header" href="#taskform">TaskForm</a></h2>
<pre><code class="language-js">import prisma from '@/utils/db';
import { revalidatePath } from 'next/cache';

const createTask = async (formData) =&gt; {
    'use server';
    const content = formData.get('content');
    // some validation here

    await prisma.task.create({
        data: {
            content
        }
    });
    // revalidate path
    revalidatePath('/tasks');
};

const TaskForm = () =&gt; {
    return (
        &lt;form action={createTask}&gt;
            &lt;div className="join w-full"&gt;
                &lt;input
                    className="input input-bordered join-item w-full"
                    placeholder="Type Here"
                    type="text"
                    name="content"
                    required
                /&gt;
                &lt;button type="submit" className="btn join-item btn-primary"&gt;
                    create task
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    );
};
export default TaskForm;
</code></pre>
<h2 id="refactor"><a class="header" href="#refactor">Refactor</a></h2>
<ul>
<li>create utils/actions</li>
<li>move get all tasks and create task functionality</li>
<li>refactor TaskForm and TaskList</li>
</ul>
<pre><code class="language-js">'use server';

import prisma from '@/utils/db';
import { revalidatePath } from 'next/cache';

export const getAllTasks = async () =&gt; {
    return prisma.task.findMany({
        orderBy: {
            createdAt: 'desc'
        }
    });
};

export const createTask = async (formData) =&gt; {
    const content = formData.get('content');
    // some validation here

    await prisma.task.create({
        data: {
            content
        }
    });
    // revalidate path
    revalidatePath('/tasks');
};
</code></pre>
<h2 id="deleteform"><a class="header" href="#deleteform">DeleteForm</a></h2>
<ul>
<li>will use “action” approach since it works without JS</li>
<li>invoke by using startTransition (useTransition hook)</li>
</ul>
<pre><code class="language-js">import { deleteTask } from '@/utils/actions';

const DeleteForm = ({ id }) =&gt; {
    return (
        &lt;form action={deleteTask}&gt;
            &lt;input type="hidden" name="id" value={id} /&gt;
            &lt;button className="btn btn-error btn-xs"&gt;delete&lt;/button&gt;
        &lt;/form&gt;
    );
};
export default DeleteForm;
</code></pre>
<p>utils/actions</p>
<pre><code class="language-js">export const deleteTask = async (formData) =&gt; {
    const id = formData.get('id');
    await prisma.task.delete({ where: { id } });
    revalidatePath('/tasks');
};
</code></pre>
<h2 id="challenge---edit-task"><a class="header" href="#challenge---edit-task">Challenge - Edit Task</a></h2>
<ul>
<li>create single task page</li>
<li>get task info (hint:params)</li>
<li>create EditForm component</li>
<li>setup form with all the inputs</li>
<li>render in single task page</li>
<li>create server action to update task</li>
<li>extra - redirect when complete</li>
</ul>
<h2 id="edit-task"><a class="header" href="#edit-task">Edit Task</a></h2>
<p>tasks/[id]/page.js</p>
<pre><code class="language-js">import EditForm from '@/components/EditForm';
import { getTask } from '@/utils/actions';
import Link from 'next/link';
const TaskPage = async ({ params }) =&gt; {
    const task = await getTask(params.id);

    return (
        &lt;&gt;
            &lt;div className="mb-16"&gt;
                &lt;Link href="/tasks" className="btn btn-accent"&gt;
                    Back to Tasks
                &lt;/Link&gt;
            &lt;/div&gt;
            &lt;EditForm task={task} /&gt;
        &lt;/&gt;
    );
};
export default TaskPage;
</code></pre>
<p>actions</p>
<pre><code class="language-js">export const getTask = async (id) =&gt; {
    return prisma.task.findUnique({
        where: {
            id
        }
    });
};

export const editTask = async (formData) =&gt; {
    const id = formData.get('id');
    const content = formData.get('content');
    const completed = formData.get('completed');

    await prisma.task.update({
        where: {
            id: id
        },
        data: {
            content: content,
            completed: completed === 'on' ? true : false
        }
    });
    // redirect won't works unless the component has 'use client'
    // another option, setup the editTask in the component directly
    redirect('/tasks');
};
</code></pre>
<p>EditForm.js</p>
<pre><code class="language-js">'use client';
import { editTask } from '@/utils/actions';

const EditForm = ({ task }) =&gt; {
    const { id, completed, content } = task;
    return (
        &lt;form
            action={editTask}
            className="max-w-sm bg-base-100 p-12 border border-base-300  rounded-lg"
        &gt;
            &lt;input type="hidden" name="id" value={id} /&gt;
            {/* content */}

            &lt;input
                type="text"
                required
                defaultValue={content}
                name="content"
                className="input input-bordered w-full"
            /&gt;

            {/* completed */}
            &lt;div className="form-control my-4"&gt;
                &lt;label className="label cursor-pointer"&gt;
                    &lt;span className="label-text"&gt;Completed&lt;/span&gt;
                    &lt;input
                        type="checkbox"
                        defaultChecked={completed}
                        name="completed"
                        className="checkbox checkbox-primary checkbox-sm"
                    /&gt;
                &lt;/label&gt;
            &lt;/div&gt;
            &lt;button className="btn btn-primary btn-block btn-sm"&gt;edit&lt;/button&gt;
        &lt;/form&gt;
    );
};
export default EditForm;
</code></pre>
<h2 id="server-actions---loading-state-response-errors"><a class="header" href="#server-actions---loading-state-response-errors">Server Actions - Loading State, Response, Errors</a></h2>
<ul>
<li>clone TaskForm - copy and rename TaskFormCustom</li>
<li>make it client component</li>
<li>import and replace in Tasks page</li>
<li>clone createTask in actions - copy and rename createTaskCustom</li>
<li>import and replace in TaskFormCustom component</li>
</ul>
<h2 id="server-actions---loading-state"><a class="header" href="#server-actions---loading-state">Server Actions - Loading State</a></h2>
<p>TaskFormCustom</p>
<pre><code class="language-js">'use client';

import { createTaskCustom } from '@/utils/actions';
import { useFormStatus } from 'react-dom';
// The useFormStatus Hook provides status information of the last form submission.
// useFormState is a Hook that allows you to update state based on the result of a form action.

const SubmitButton = () =&gt; {
    const { pending } = useFormStatus();

    return (
        &lt;button
            type="submit"
            className="btn join-item btn-primary"
            disabled={pending}
        &gt;
            {pending ? 'please wait... ' : 'create task'}
        &lt;/button&gt;
    );
};

const TaskForm = () =&gt; {
    return (
        &lt;form action={createTaskCustom}&gt;
            &lt;div className="join w-full"&gt;
                &lt;input
                    className="input input-bordered join-item w-full"
                    placeholder="Type Here"
                    type="text"
                    name="content"
                    required
                /&gt;
                &lt;SubmitButton /&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    );
};
export default TaskForm;
</code></pre>
<pre><code class="language-js">export const createTaskCustom = async (formData) =&gt; {
    await new Promise((resolve) =&gt; setTimeout(resolve, 2000));
    const content = formData.get('content');
    // some validation here

    await prisma.task.create({
        data: {
            content
        }
    });
    // revalidate path
    revalidatePath('/tasks');
};
</code></pre>
<h2 id="error-handling-and-response-to-user"><a class="header" href="#error-handling-and-response-to-user">Error Handling and Response To User</a></h2>
<p>TaskFormCustom.jsx</p>
<pre><code class="language-js">'use client';

import { createTaskCustom } from '@/utils/actions';
import { useFormStatus, useFormState } from 'react-dom';
// The useFormStatus Hook provides status information of the last form submission.
// useFormState is a Hook that allows you to update state based on the result of a form action.

const SubmitButton = () =&gt; {
    const { pending } = useFormStatus();

    return (
        &lt;button
            type="submit"
            className="btn join-item btn-primary"
            disabled={pending}
        &gt;
            {pending ? 'please wait... ' : 'create task'}
        &lt;/button&gt;
    );
};

const initialState = {
    message: null
};

const TaskForm = () =&gt; {
    const [state, formAction] = useFormState(createTaskCustom, initialState);

    return (
        &lt;form action={formAction}&gt;
            {state.message ? &lt;p className="mb-2"&gt;{state.message}&lt;/p&gt; : null}
            &lt;div className="join w-full"&gt;
                &lt;input
                    className="input input-bordered join-item w-full"
                    placeholder="Type Here"
                    type="text"
                    name="content"
                    required
                /&gt;
                &lt;SubmitButton /&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    );
};
export default TaskForm;
</code></pre>
<p>actions.js</p>
<pre><code class="language-js">// fix params
export const createTaskCustom = async (prevState, formData) =&gt; {
    await new Promise((resolve) =&gt; setTimeout(resolve, 2000));
    const content = formData.get('content');
    // some validation here
    try {
        await prisma.task.create({
            data: {
                content
            }
        });
        // revalidate path
        revalidatePath('/tasks');
        return { message: 'success!!!' };
    } catch (error) {
        // can't return error
        return { message: 'error...' };
    }
};
</code></pre>
<h2 id="extra---more-user-input-validation-options"><a class="header" href="#extra---more-user-input-validation-options">Extra - More User Input Validation Options</a></h2>
<ul>
<li>required attribute a great start</li>
<li>zod library</li>
</ul>
<p>The Zod library is a TypeScript-first schema declaration and validation library that allows developers to create complex type checks with simple syntax.</p>
<p><a href="https://zod.dev/">Zod</a></p>
<pre><code class="language-sh">npm install zod
</code></pre>
<p>actions.js</p>
<pre><code class="language-js">import { z } from 'zod';

export const createTaskCustom = async (prevState, formData) =&gt; {
    await new Promise((resolve) =&gt; setTimeout(resolve, 2000));
    const content = formData.get('content');

    const Task = z.object({
        content: z.string().min(5)
    });

    // some validation here
    try {
        Task.parse({
            content
        });
        await prisma.task.create({
            data: {
                content
            }
        });
        // revalidate path
        revalidatePath('/tasks');
        return { message: 'success!!!' };
    } catch (error) {
        console.log(error);
        // can't return error
        return { message: 'error...' };
    }
};
</code></pre>
<h2 id="providers"><a class="header" href="#providers">Providers</a></h2>
<p><a href="https://react-hot-toast.com/">Beautiful Toasts</a></p>
<pre><code class="language-sh">npm install react-hot-toast
</code></pre>
<ul>
<li>create providers.js file in app</li>
</ul>
<pre><code class="language-js">'use client';
import { Toaster } from 'react-hot-toast';

const Providers = ({ children }) =&gt; {
    return (
        &lt;&gt;
            &lt;Toaster /&gt;
            {children}
        &lt;/&gt;
    );
};
export default Providers;
</code></pre>
<p>layout.js</p>
<pre><code class="language-js">import Providers from './providers';

export default function RootLayout({ children }) {
    return (
        &lt;html lang="en"&gt;
            &lt;body className={inter.className}&gt;
                &lt;Navbar /&gt;
                &lt;main className="px-8 py-20 max-w-6xl mx-auto"&gt;
                    &lt;Providers&gt;{children}&lt;/Providers&gt;
                &lt;/main&gt;
            &lt;/body&gt;
        &lt;/html&gt;
    );
}
</code></pre>
<ul>
<li>simplify createTaskCustom action</li>
</ul>
<pre><code class="language-js">try {
    return { message: 'success' };
} catch (error) {
    console.log(error);
    return { message: 'error' };
}
</code></pre>
<ul>
<li>add toast</li>
</ul>
<p>TaskFormCustom.jsx</p>
<pre><code class="language-js">'use client';
import { createTaskCustom } from '@/utils/actions';
import { useEffect } from 'react';

import { useFormStatus, useFormState } from 'react-dom';
import toast from 'react-hot-toast';
const SubmitBtn = () =&gt; {
    const { pending } = useFormStatus();
    return (
        &lt;button
            type="submit"
            className="btn btn-primary join-item"
            disabled={pending}
        &gt;
            {pending ? 'please wait...' : 'create task'}
        &lt;/button&gt;
    );
};

const initialState = {
    message: null
};

const TaskForm = () =&gt; {
    const [state, formAction] = useFormState(createTaskCustom, initialState);

    useEffect(() =&gt; {
        if (state.message === 'error') {
            toast.error('there was an error');
            return;
        }
        if (state.message) {
            toast.success('task created....');
        }
    }, [state]);

    return (
        &lt;form action={formAction}&gt;
            &lt;div className="join w-full"&gt;
                &lt;input
                    type="text "
                    className="input input-bordered join-item w-full"
                    placeholder="type here"
                    name="content"
                    required
                /&gt;
                &lt;SubmitBtn /&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    );
};
export default TaskForm;
</code></pre>
<h2 id="challenge---add-functionality"><a class="header" href="#challenge---add-functionality">Challenge - Add Functionality</a></h2>
<p>DeleteForm.jsx</p>
<pre><code class="language-js">'use client';
import { useFormStatus } from 'react-dom';
import { deleteTask } from '@/utils/actions';

const SubmitBtn = () =&gt; {
    const { pending } = useFormStatus();
    return (
        &lt;button
            type="submit"
            className="btn btn-xs btn-error"
            disabled={pending}
        &gt;
            {pending ? 'pending...' : 'delete'}
        &lt;/button&gt;
    );
};

const DeleteForm = ({ id }) =&gt; {
    return (
        &lt;form action={deleteTask}&gt;
            &lt;input type="hidden" name="id" value={id} /&gt;
            &lt;SubmitBtn /&gt;
        &lt;/form&gt;
    );
};
export default DeleteForm;
</code></pre>
<h2 id="route-handlers"><a class="header" href="#route-handlers">Route Handlers</a></h2>
<ul>
<li>install Thunder Client</li>
</ul>
<p>Route Handlers allow you to create custom request handlers for a given route using the Web Request and Response APIs.</p>
<ul>
<li>in app create folder “api”</li>
<li>in there create folder “tasks” with route.js file</li>
</ul>
<p>The following HTTP methods are supported: GET, POST, PUT, PATCH, DELETE, HEAD, and OPTIONS. If an unsupported method is called, Next.js will return a 405 Method Not Allowed response.</p>
<p>In addition to supporting native Request and Response. Next.js extends them with NextRequest and NextResponse to provide convenient helpers for advanced use cases.</p>
<p>app/api/tasks/route.js</p>
<pre><code class="language-js">// the following HTTP methods are supported: GET, POST, PUT, PATCH, DELETE, HEAD, and OPTIONS. If an unsupported method is called, Next.js will return a 405 Method Not Allowed response.

import { NextResponse } from 'next/server';
import db from '@/utils/db';

export const GET = async (request) =&gt; {
    const tasks = await db.task.findMany();
    return Response.json({ data: tasks });
    // return NextResponse.json({ data: tasks });
};

export const POST = async (request) =&gt; {
    const data = await request.json();
    const task = await db.task.create({
        data: {
            content: data.content
        }
    });
    return NextResponse.json({ data: task });
};
</code></pre>
<h2 id="middleware"><a class="header" href="#middleware">Middleware</a></h2>
<p><a href="https://nextjs.org/docs/app/building-your-application/routing/middleware">Docs</a></p>
<p>Middleware in Next.js is a piece of code that allows you to perform actions before a request is completed and modify the response accordingly.</p>
<ul>
<li>create middleware.js in the root</li>
<li>by default will be invoked for every route in your project</li>
</ul>
<pre><code class="language-js">export function middleware(request) {
    return Response.json({ msg: 'hello there' });
}

export const config = {
    matcher: '/about'
};
</code></pre>
<pre><code class="language-js">import { NextResponse } from 'next/server';

// This function can be marked `async` if using `await` inside
export function middleware(request) {
    return NextResponse.redirect(new URL('/', request.url));
}

// See "Matching Paths" below to learn more
export const config = {
    matcher: ['/about/:path*', '/tasks/:path*']
};
</code></pre>
<h2 id="planetscale"><a class="header" href="#planetscale">PlanetScale</a></h2>
<p><a href="https://planetscale.com/">Host DB</a></p>
<ul>
<li>set DATABASE_URL in .env</li>
</ul>
<pre><code class="language-prisma">generator client {
  provider = "prisma-client-js"
}
datasource db {
  provider = "mysql"
  url = env("DATABASE_URL")
  relationMode = "prisma"
}
</code></pre>
<pre><code class="language-sh">npx prisma db push
</code></pre>
<h3 id="local-build"><a class="header" href="#local-build">Local Build</a></h3>
<h3 id="setup-app"><a class="header" href="#setup-app">Setup App</a></h3>
<p>package.json</p>
<pre><code class="language-json"> "build": "npx prisma generate &amp;&amp; next build",
</code></pre>
<ul>
<li>prisma-example</li>
</ul>
<pre><code class="language-js">import prisma from '@/utils/db';

const prismaHandlers = async () =&gt; {
    console.log('prisma example');
    // await prisma.task.create({
    //   data: {
    //     content: 'wake up',
    //   },
    // });
    return prisma.task.findMany();
};

const PrismaExample = async () =&gt; {
    const tasks = await prismaHandlers();
    if (tasks.length === 0) {
        return (
            &lt;h2 className="mt-8 font-medium text-lg"&gt;No tasks to show...&lt;/h2&gt;
        );
    }

    return (
        &lt;div&gt;
            &lt;h1 className="text-7xl"&gt;PrismaExample&lt;/h1&gt;
            {tasks.map((task) =&gt; {
                return (
                    &lt;h2 key={task.id} className="text-xl py-2"&gt;
                        😬 {task.content}
                    &lt;/h2&gt;
                );
            })}
        &lt;/div&gt;
    );
};
export default PrismaExample;
</code></pre>
<ul>
<li>clean out the DB</li>
</ul>
<pre><code class="language-sh">npm run build
</code></pre>
<pre><code class="language-sh">npm start
</code></pre>
<h2 id="force-dynamic"><a class="header" href="#force-dynamic">Force Dynamic</a></h2>
<ul>
<li>add loading.js to tasks</li>
</ul>
<p>tasks.js</p>
<pre><code class="language-js">export const dynamic = 'force-dynamic';
</code></pre>
<h2 id="deploy"><a class="header" href="#deploy">Deploy</a></h2>
<p><a href="https://vercel.com/">Vercel</a></p>
<ul>
<li>sign up for account</li>
<li>create github repo</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="19_reactnode_js_jwt"><a href="#19_reactnode_js_jwt" class="header">19_React+Node_JS_JWT</a></h1>
<h3 id="backend"><a class="header" href="#backend">Backend</a></h3>
<pre><code class="language-sh">mkdir jwt-backend
cd jwt-backend
npm init -y
npm install express bcrypt jsonwebtoken cors nodemon cookie-parser
npm i @prisma/client express dotenv nodemon
npm install express-validator
</code></pre>
<blockquote>
<p>Add Script</p>
</blockquote>
<pre><code class="language-json">"scripts": {
    "dev": "nodemon index.js"
},
</code></pre>
<h3 id="initialize-prisma-project-1"><a class="header" href="#initialize-prisma-project-1">Initialize Prisma project</a></h3>
<pre><code class="language-sh">npx prisma init
</code></pre>
<h3 id="env-variables-1"><a class="header" href="#env-variables-1">ENV Variables</a></h3>
<pre><code>DATABASE_URL="postgresql://postgres:@localhost:5432/postdb?schema=public"
CHECKPOINT_DISABLE=1
</code></pre>
<blockquote>
<p>Documentation Links</p>
</blockquote>
<ul>
<li>
<p><a href="https://www.prisma.io/docs/orm/reference/prisma-cli-reference">cli Reference</a></p>
</li>
<li>
<p><a href="https://www.prisma.io/docs/orm/reference/prisma-client-reference">client Reference</a></p>
</li>
</ul>
<h2 id="modelschema-1"><a class="header" href="#modelschema-1">Model/Schema</a></h2>
<blockquote>
<p>prisma/schema.prisma</p>
</blockquote>
<pre><code class="language-prisma">generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User{
    id Int @id @default(autoincrement())
    email String
    password String
}

</code></pre>
<blockquote>
<p>Run migration</p>
</blockquote>
<pre><code class="language-sh">npx prisma migrate dev --name init
</code></pre>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-js">// Imports
const express = require('express');
const cookieParser = require('cookie-parser');
const bcrypt = require('bcrypt');
const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();
const { body, validationResult } = require('express-validator');
const jwt = require('jsonwebtoken');
const cors = require('cors');
const app = express();

// Constants
const PORT = 3333;
const secret = 'your-secret-key';

// Middlewares

// Verify Token
function verifyToken(req, res, next) {
    const token = req.header('Authorization');
    if (!token) return res.status(401).json({ error: 'Access denied' });
    try {
        const decoded = jwt.verify(token, secret);
        req.userId = decoded.userId;
        next();
    } catch (error) {
        res.status(401).json({ error: 'Invalid token' });
    }
}

// Custom Middleware
const logger = (req, res, next) =&gt; {
    console.log(req.url);
    next();
};

// Validator
const validate = (validations) =&gt; {
    return async (req, res, next) =&gt; {
        for (let validation of validations) {
            const result = await validation.run(req);
            if (result.errors.length) break;
        }

        const errors = validationResult(req);
        if (errors.isEmpty()) {
            return next();
        }

        let msg =
            errors.errors[0]['path'] == 'email'
                ? 'Invalid email address. Please try again.'
                : 'Password must be longer than 6 characters.';

        res.status(400).json({ data: null, errs: msg });
    };
};

// Use CORS middleware
app.use(
    cors({
        origin: ['http://localhost:5173'],
        methods: ['GET', 'POST', 'PUT', 'DELETE'],
        credentials: true
    })
);
// parse form data
app.use(express.urlencoded({ extended: false }));
// parse json
app.use(express.json());
// custom logger
app.use(logger);
// Cookie
app.use(cookieParser());

// Routes
app.post('/', (req, res) =&gt; {
    return res.status(201).json({ name: 'hello' });
});

// User registration
app.post(
    '/register',
    validate([body('email').isEmail(), body('password').isLength({ min: 6 })]),
    async (req, res) =&gt; {
        const { email, password } = req.body;
        try {
            const hashedPassword = await bcrypt.hash(password, 10);
            await prisma.user.create({
                data: { email, password: hashedPassword }
            });
            return res.status(201).json({
                data: { email, password: hashedPassword },
                errs: null
            });
        } catch (err) {
            return res.status(500).json({ data: null, errs: err });
        }
    }
);

// User login
app.post('/login', async (req, res) =&gt; {
    try {
        const { email, password } = req.body;
        const user = await prisma.user.findUnique({ where: { email } });
        if (!user) {
            return res.status(401).json({ error: 'Invalid email!' });
        }
        const passwordMatch = await bcrypt.compare(password, user.password);
        if (!passwordMatch) {
            return res.status(401).json({ error: 'Invalid password!' });
        }
        const token = jwt.sign({ userId: user.id }, secret, {
            expiresIn: '1h'
        });
        const reftoken = jwt.sign({ userId: user.id }, secret, {
            expiresIn: '1h'
        });

        res.cookie('jwt', reftoken, {
            httpOnly: true,
            sameSite: 'None',
            secure: true,
            maxAge: 24 * 60 * 60 * 1000
        });

        return res.status(200).json({ token: token });
    } catch (error) {
        res.status(500).json({ error: 'Login failed' });
    }
});

// Protected route
app.get('/', verifyToken, async (req, res) =&gt; {
    let userID = parseInt(req.userId);
    const new_user = await prisma.user.findUnique({ where: { id: userID } });

    res.status(200).json({ me: new_user });
});

// App Listening
app.listen(PORT, () =&gt; {
    console.log('Listening ....');
});
</code></pre>
<h3 id="frontend"><a class="header" href="#frontend">Frontend</a></h3>
<pre><code class="language-sh">mkdir jwt-frontend
cd jwt-frontend
npm init -y
</code></pre>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-js">import React, { useEffect } from 'react';

const App = () =&gt; {
    useEffect(() =&gt; {
        const fetchData = async () =&gt; {
            const data = await fetch('http://localhost:3333/login', {
                method: 'POST',
                credentials: 'include',
                headers: {
                    Accept: 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    email: 'sad@sad.com',
                    password: 'helloworld'
                })
            });

            const resp = await data.json();
            console.log(resp);
        };

        fetchData();
    }, []);
    return &lt;div&gt;App&lt;/div&gt;;
};

export default App;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="20_fastapi_jwt_scratch_react"><a href="#20_fastapi_jwt_scratch_react" class="header">20_Fastapi_JWT_Scratch_React</a></h1>
<h3 id="install-dependencies-4"><a class="header" href="#install-dependencies-4">Install Dependencies</a></h3>
<pre><code class="language-sh">pip install fastapi uvicorn gunicorn pyjwt
</code></pre>
<blockquote>
<p>main.py</p>
</blockquote>
<pre><code class="language-py">from fastapi import Depends, FastAPI, Response, status
import datetime

from fastapi.encoders import jsonable_encoder
from fastapi.responses import JSONResponse
from middlewares.authenticate import authenticate
from helper.utils import jwt_encode
from fastapi.middleware.cors import CORSMiddleware


# Main app
app = FastAPI()

origins = ["http://localhost:5173"]

app.add_middleware(
    CORSMiddleware,
    allow_origins=origins,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)


# Generate JWT Token
@app.get("/login", status_code=200)
async def login(res: Response):
    user = {"id": 1, "name": "John"}
    accToken = await jwt_encode(
        user, int(datetime.datetime.timestamp(datetime.datetime.now())) + (60 * 60)
    )
    refToken = await jwt_encode(
        user,
        int(datetime.datetime.timestamp(datetime.datetime.now())) + (24 * 60 * 60),
    )

    res.set_cookie("refreshToken", refToken, httponly=True, samesite="strict")
    res.headers["Authorization"] = accToken

    return {"accToken": accToken, "id": 1, "user": "John"}


@app.get("/me")
async def me(data: dict = Depends(authenticate)):
    return data
</code></pre>
<blockquote>
<p>helper/utils.py</p>
</blockquote>
<pre><code class="language-py">
import jwt


async def jwt_encode(data, exp):
    return jwt.encode(
        {**data, "exp": exp},
        "secret",
        algorithm="HS256",
    ).decode("utf-8")


async def jwt_decode(encoded_jwt):
    return jwt.decode(encoded_jwt, "secret", algorithms=["HS256"])
</code></pre>
<blockquote>
<p>middlewares/authenticate.py</p>
</blockquote>
<pre><code class="language-py">import sys

sys.path.append("..")


from fastapi.responses import JSONResponse
from fastapi.encoders import jsonable_encoder
from fastapi import Request, Response, status
import datetime
from helper import utils


async def authenticate(req: Request, res: Response):
    accToken, refToken = req.headers.get("Authorization", None), req.cookies.get(
        "refreshToken", None
    )

    # Check if both tokens provided
    if not accToken and not refToken:
        return JSONResponse(
            content=jsonable_encoder({"type": "err", "msg": "No Tokens provided"}),
            status_code=status.HTTP_401_UNAUTHORIZED,
        )

    decoded = {}

    # If acc_token not expired
    try:
        # Decode the jwt token
        decoded = await utils.jwt_decode(accToken)
        req.state.data = decoded.get("name")
        return JSONResponse(
            content=jsonable_encoder(
                {"type": "data", "msg": "Got user back!", "data": decoded.get("name")}
            ),
            status_code=status.HTTP_200_OK,
        )

    # If acc_token expired then use refToken to Generate new accToken
    except Exception as e:
        # Check Refresh token provided
        if not refToken:
            return JSONResponse(
                content=jsonable_encoder(
                    {"type": "err", "msg": "No Refresh Token provided"}
                ),
                status_code=status.HTTP_401_UNAUTHORIZED,
            )

        # If ref_token not expired
        decoded = {}
        try:
            decoded = await utils.jwt_decode(refToken)
            accToken = await utils.jwt_encode(
                {"id": decoded.get("id"), "name": decoded.get("name")},
                int(datetime.datetime.timestamp(datetime.datetime.now())) + 15,
            )
            res.set_cookie("refreshToken", refToken, httponly=True, samesite="strict")
            res.headers["Authorization"] = accToken
            return JSONResponse(
                content=jsonable_encoder(
                    {
                        "type": "data",
                        "msg": "Refreshed Token",
                        "data": {
                            "accToken": accToken,
                            "id": decoded.get("id"),
                            "name": decoded.get("name"),
                        },
                    }
                ),
                status_code=status.HTTP_200_OK,
            )
        # If ref_token expired
        except Exception as e:
            return JSONResponse(
                content=jsonable_encoder(
                    {"type": "err", "msg": "refreshToken expired"}
                ),
                status_code=status.HTTP_401_UNAUTHORIZED,
            )
</code></pre>
<blockquote>
<p>gunicorn.conf.py</p>
</blockquote>
<pre><code class="language-py">
import os
import signal


def worker_int(worker):
    os.kill(worker.pid, signal.SIGINT)
</code></pre>
<blockquote>
<p>run.sh</p>
</blockquote>
<pre><code class="language-sh">#!/usr/bin/env bash

WORKERS=6
PORT=5000

gunicorn main:app -w "${WORKERS}" -b 0.0.0.0:"${PORT}" -k uvicorn.workers.UvicornWorker --log-file=- --log-level DEBUG --reload
</code></pre>
<blockquote>
<p>App.tsx</p>
</blockquote>
<pre><code class="language-ts">import { useCallback } from 'react';

const App = () =&gt; {
    const handleLogin = useCallback(async () =&gt; {
        const url = 'http://localhost:5000/login';
        const data = await fetch(url, {
            credentials: 'include',
            headers: {
                Accept: 'application/json',
                'Content-Type': 'application/json'
            }
        });
        const final = await data.json();
        console.log('DATA', final);

        if (final['accToken']) {
            localStorage.setItem('accToken', final['accToken']);
        } else {
            console.log('No data found');
        }
    }, []);

    const me = useCallback(async () =&gt; {
        const url = 'http://localhost:5000/me';
        const data = await fetch(url, {
            credentials: 'include',
            headers: {
                Accept: 'application/json',
                'Content-Type': 'application/json',
                Authorization: localStorage.getItem('accToken')
            }
        });
        const final = await data.json();
        if (final['accToken']) {
            localStorage.setItem('accToken', final['accToken']);
            console.log('DATA', final);
        } else {
            console.log(final);
        }
    }, []);

    return (
        &lt;div&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    handleLogin();
                }}
            &gt;
                Login
            &lt;/button&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    me();
                }}
            &gt;
                Me
            &lt;/button&gt;
        &lt;/div&gt;
    );
};

export default App;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="mongodb"><a class="header" href="#mongodb">MongoDB</a></h1>
<blockquote>
<p>Connecting to mongodb</p>
</blockquote>
<pre><code class="language-sh">mongosh // connects to mongodb://127.0.0.1:27017 by default
mongo "mongodb+srv://cluster-name.abcde.mongodb.net/&lt;dbname&gt;" --username &lt;username&gt; // MongoDB Atlas
</code></pre>
<blockquote>
<p>Similarities</p>
</blockquote>
<p>Note:</p>
<p>Tables -&gt; Collections
Rows -&gt; Documents
DBs -&gt; DBs</p>
<blockquote>
<p>Basic commands</p>
</blockquote>
<pre><code class="language-sh">show dbs // show databases
use &lt;dbname&gt; // use or create database
show collections // show collections
</code></pre>
<blockquote>
<p>Collections</p>
</blockquote>
<pre><code class="language-sh">db.createCollection("coll") // creates the collection `coll`
db.coll.drop()    // removes the collection `coll`
</code></pre>
<h3 id="crud"><a class="header" href="#crud">CRUD</a></h3>
<blockquote>
<p>Create</p>
</blockquote>
<pre><code class="language-sh">db.coll.insertOne({name: "John Doe", age: 25}) // insert one document
db.coll.insertMany([{name: "John Doe", age: 25}, {name: "Alice", age: 30}]) // insert many documents
</code></pre>
<blockquote>
<p>Read</p>
</blockquote>
<pre><code class="language-sh">db.coll.count() // count all documents in 'coll' collection
db.coll.count({name: "John Doe"}) // count all documents with name "John Doe"

db.coll.find() // list all documents
db.coll.find({name: "John Doe"}) // list all documents with name "John Doe"
db.coll.find({name: "John Doe", age: 25}).limit(1) // list all documents with name "John Doe" and age 25, and return only one document.

db.Reviews.find({userId:"666258c68d02124bd1ddbadb"},{_id:true,comment:true}).limit(2) // only required fields
db.User.find({},{name:true}).limit(5).sort({name:-1}) // Sort by descending
db.User.find({},{name:true}).limit(5).sort({name:1}) // Sort by ascending
db.User.find({"address.country":"Lesotho"},{name:true}).limit(5).sort({name:-1}) // Nested Fields
db.User.find({"address.country":"Lesotho"},{name:true}).limit(5).count() // Count results

// Atomic operators
db.inventory.find( { quantity: { $in: [ 5, 15 ] } }, { _id: 0 } ) // in operator

db.coll.find({name: "John Doe"}).explain("executionStats") // find document and show execution stats
</code></pre>
<blockquote>
<p>Update</p>
</blockquote>
<pre><code class="language-sh">db.coll.update({name: "John Doe"}, {$set: {age: 26}}) // update all documents with name "John Doe" and set age to 26
db.coll.update({name: "John Doe"}, {$inc: {age: 1}}) // update all documents with name "John Doe" and increment age by 1

db.coll.update({name: "John Doe"}, {$unset: {age: 1}}) // update all documents with name "John Doe" and set age to null
db.coll.updateMany({age: {$exists: true}}, {$unset: {age: ""}}) // remove age field from all documents with age field
</code></pre>
<blockquote>
<p>Delete</p>
</blockquote>
<pre><code class="language-sh">db.coll.deleteMany({name: "John Doe"}) // remove all documents with name "John Doe"
db.coll.deleteOne({name: "John Doe"}) // remove one document with name "John Doe"
</code></pre>
<blockquote>
<p>ACID Compliance</p>
</blockquote>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Properties</th><th>Points</th></tr>
</thead>
<tbody>
<tr><td>Atomicity</td><td>Means: A single transaction will take place or it will not take place.On error rollback will happen and on success data will be commited. mongodb historically supported for single documents only,now supports multi document</td></tr>
<tr><td>Consistency</td><td>Means: MongoDB uses schema validation, a feature that allows you to define the specific structure of documents in each MongoDB collection. If the document structure deviates from the defined schema, MongoDB will return an error. This is how MongoDB enforces its version of consistency</td></tr>
<tr><td>Isolation</td><td>Means: Concurrent transaction run in some serial order to prevent data corruption and race condition.</td></tr>
<tr><td>Durability</td><td>Measn : Data perssitence.If a data has been commited evn if the coputer crashes we will have the data stored into the disk</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Jsonschema</p>
</blockquote>
<pre><code class="language-sh">// Create collection with a $jsonschema
db.createCollection("hosts", {
    validator: {$jsonSchema: {
        bsonType: "object",
        required: ["email"], // required fields
        properties: {
            // All possible fields
            phone: {
                bsonType: "string",
                description: "must be a string and is required"
            },
            email: {
                bsonType: "string",
                pattern: "@mongodb\.com$",
                description: "must be a string and match the regular expression pattern"
            },
        }
    }}
})

</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="22_trpc"><a href="#22_trpc" class="header">22_TRPC</a></h1>
<h3 id="integrate-trpc-with-bun"><a class="header" href="#integrate-trpc-with-bun">Integrate TRPC with bun</a></h3>
<h4 id="install-3"><a class="header" href="#install-3">Install</a></h4>
<pre><code class="language-sh">bun add dotenv @types/dotenv @types/express express @types/cookie-parser cookie-parser cors @types/cors zod @trpc/server
</code></pre>
<h4 id="basic-integration-server"><a class="header" href="#basic-integration-server">Basic Integration Server</a></h4>
<blockquote>
<p>src/index.ts</p>
</blockquote>
<pre><code class="language-ts">import 'dotenv/config';

import { createExpressMiddleware } from '@trpc/server/adapters/express';
import cookieParser from 'cookie-parser';
import cors from 'cors';
import express from 'express';
import { appRouter } from './trpc';

// Express initialize
const app = express();

// Middlewares
app.use(cookieParser());
app.use(express.json());
app.use(
    cors({
        origin: process.env.FRONTEND_URL,
        credentials: true
    })
);

// TRPC Server
app.use('/trpc', createExpressMiddleware({ router: appRouter }));
app.listen(5000);
console.log('Express Server started!');
</code></pre>
<blockquote>
<p>src/trpc.ts</p>
</blockquote>
<pre><code class="language-ts">import { initTRPC } from '@trpc/server';

const t = initTRPC.create();

export const appRouter = t.router({
    sayHi: t.procedure.query(() =&gt; {
        return 'hi';
    }),
    logToserver: t.procedure
        .input((v) =&gt; {
            if (typeof v === 'string') return v;
            throw new Error('Invalid Input!');
        })
        .mutation((req) =&gt; {
            console.log(req.input);
            return true;
        })
});

export type AppRouter = typeof appRouter;
</code></pre>
<h3 id="basic-integration-client"><a class="header" href="#basic-integration-client">Basic Integration client</a></h3>
<h4 id="install-1-1"><a class="header" href="#install-1-1">Install</a></h4>
<pre><code class="language-sh">bun add @trpc/server@next @trpc/client@next @trpc/react-query@next @trpc/next@next @tanstack/react-query@latest zod
bun remove @trpc/server
</code></pre>
<blockquote>
<p>lib/utils.ts</p>
</blockquote>
<pre><code class="language-ts">import { createTRPCClient, httpBatchLink } from '@trpc/client';
import { AppRouter } from '../../../server/src/trpc';

export const trpc = createTRPCClient&lt;AppRouter&gt;({
    links: [
        httpBatchLink({
            url: process.env.BACKEND_URL as string,
            fetch(url, options) {
                return fetch(url, {
                    ...options,
                    credentials: 'include'
                });
            }
        })
    ]
});

export const main = async () =&gt; {
    console.log('Entered!');
    // const res = await trpcClient.sayHi.query();
    const res = await trpc.logToserver.mutate('asd');
    console.log(res);
};
</code></pre>
<blockquote>
<p>app/page.tsx</p>
</blockquote>
<pre><code class="language-tsx">import { trpc } from '@/lib/utils';

const fn = async () =&gt; {
    let res = await trpc.sayHi.query();
    console.log(res);
};

const Page = async () =&gt; {
    await fn();
    return &lt;div&gt;Hello World!&lt;/div&gt;;
};

export default Page;
</code></pre>
<h3 id="nested-routes-1"><a class="header" href="#nested-routes-1">Nested Routes</a></h3>
<blockquote>
<p>src/routers/index.ts</p>
</blockquote>
<pre><code class="language-ts">import { t } from '../trpc';
import { userRouter } from './user';

export const appRouter = t.router({
    sayHi: t.procedure.query(() =&gt; {
        return 'hi';
    }),
    logToserver: t.procedure
        .input((v) =&gt; {
            if (typeof v === 'string') return v;
            throw new Error('Invalid Input!');
        })
        .mutation((req) =&gt; {
            console.log(req.input);
            return true;
        }),
    user: userRouter
});

export type AppRouter = typeof appRouter;
</code></pre>
<blockquote>
<p>src/routers/user.ts</p>
</blockquote>
<pre><code class="language-ts">import { t } from '../trpc';
import { z } from 'zod';

export const userRouter = t.router({
    inputUser: t.procedure
        .input(z.object({ name: z.string() }))
        // .input((inp) =&gt; inp)
        .query((req) =&gt; {
            console.log(req.input);
            return 'hello';
        })
});
</code></pre>
<blockquote>
<p>src/trpc.ts</p>
</blockquote>
<pre><code class="language-ts">import { initTRPC } from '@trpc/server';

export const t = initTRPC.create();
</code></pre>
<h4 id="final-client-clientserver-side"><a class="header" href="#final-client-clientserver-side">Final Client (client+server side)</a></h4>
<pre><code class="language-ts">import { createTRPCClient, httpBatchLink } from '@trpc/client';
import { AppRouter, ccf } from '../../../server/src/routers/index';

// client side
export const trpc = createTRPCClient&lt;AppRouter&gt;({
    links: [
        httpBatchLink({
            url: process.env.BACKEND_URL as string,
            fetch(url, options) {
                return fetch(url, {
                    ...options,
                    credentials: 'include'
                });
            }
        })
    ]
});

// server client side
export const serverClient = ccf({
    // @ts-ignore
    links: [
        httpBatchLink({
            url: process.env.BACKEND_URL as string,
            fetch(url, options) {
                return fetch(url, {
                    ...options,
                    credentials: 'include'
                });
            }
        })
    ]
});

export const main = async () =&gt; {
    console.log('Entered!');
    const res = await serverClient.user.inputUser({
        id: 123213,
        name: 'hello'
    });

    console.log(res, 'Result');
};
</code></pre>
<h3 id="context"><a class="header" href="#context">Context</a></h3>
<blockquote>
<p>src/create-context.ts</p>
</blockquote>
<pre><code class="language-ts">import { type CreateExpressContextOptions } from '@trpc/server/adapters/express';

export const createContext = ({ req, res }: CreateExpressContextOptions) =&gt; {
    return {
        isAdmin: true,
        req,
        res
    };
};
</code></pre>
<blockquote>
<p>src/index.ts</p>
</blockquote>
<pre><code class="language-ts">import { initTRPC, type inferAsyncReturnType } from '@trpc/server';
import type { createContext } from './create-context';

export const t = initTRPC
    .context&lt;inferAsyncReturnType&lt;typeof createContext&gt;&gt;()
    .create({
        allowOutsideOfServer: true
    });

export const { createCallerFactory, router } = t;
</code></pre>
<h4 id="middlewares-1"><a class="header" href="#middlewares-1">Middlewares</a></h4>
<pre><code class="language-ts">import { initTRPC, type inferAsyncReturnType, TRPCError } from '@trpc/server';
import type { createContext } from './create-context';

export const t = initTRPC
    .context&lt;inferAsyncReturnType&lt;typeof createContext&gt;&gt;()
    .create({
        allowOutsideOfServer: true
    });

export const { createCallerFactory, router } = t;

export const isAdminMiddleware = t.middleware(({ ctx, next }) =&gt; {
    if (!ctx.isAdmin) {
        throw new TRPCError({ code: 'UNAUTHORIZED' });
    }
    return next({ ctx: { user: { id: 1 } } });
});

export const adminProcedure = t.procedure.use(isAdminMiddleware);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="23_react_query"><a href="#23_react_query" class="header">23_React_Query</a></h1>
<h3 id="react-query"><a class="header" href="#react-query">React Query</a></h3>
<pre><code class="language-sh">npm create vite@latest myapp
npm i @tanstack/react-query @tanstack/react-query-devtools
cd myapp
</code></pre>
<h4 id="global-client-wrapper"><a class="header" href="#global-client-wrapper">Global client wrapper</a></h4>
<blockquote>
<p>react-query-wrapper.tsx</p>
</blockquote>
<pre><code class="language-tsx">import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import React from 'react';

export const queryClient = new QueryClient({
    defaultOptions: {
        queries: {
            staleTime: 10 * (60 * 1000)
        }
    }
});

export const ReactQueryWrapper = ({ children }: React.PropsWithChildren) =&gt; {
    return (
        &lt;QueryClientProvider client={queryClient}&gt;
            {children}
        &lt;/QueryClientProvider&gt;
    );
};
</code></pre>
<h4 id="post-list-1"><a class="header" href="#post-list-1">Post List 1</a></h4>
<pre><code class="language-tsx">import { useQuery } from '@tanstack/react-query';

async function getPosts() {
    const data = await fetch('http://localhost:5000/posts');
    const res = await data.json();
    console.log(res);
    return res.data;
}

export default function PostsList1() {
    const postsQuery = useQuery({
        queryKey: ['posts'],
        queryFn: async () =&gt; await getPosts(),
        placeholderData: [{ id: 1, title: 'Initial Data' }]
    });

    if (postsQuery.status === 'pending') return &lt;h1&gt;Loading...&lt;/h1&gt;;
    if (postsQuery.status === 'error') {
        return &lt;h1&gt;{JSON.stringify(postsQuery.error)}&lt;/h1&gt;;
    }

    return (
        &lt;div&gt;
            &lt;h1&gt;Posts List 1&lt;/h1&gt;
            &lt;ol&gt;
                {postsQuery.data.map((post: any) =&gt; (
                    &lt;li key={post.id}&gt;{post.title}&lt;/li&gt;
                ))}
            &lt;/ol&gt;
        &lt;/div&gt;
    );
}
</code></pre>
<h4 id="post-by-id"><a class="header" href="#post-by-id">Post by id</a></h4>
<pre><code class="language-tsx">import { useQuery } from '@tanstack/react-query';
import { getPost } from './api/posts';
import { getUser } from './api/users';

export default function Post({ id }) {
    const postQuery = useQuery({
        queryKey: ['posts', id],
        queryFn: () =&gt; getPost(id)
    });

    const userQuery = useQuery({
        queryKey: ['users', postQuery?.data?.userId],
        // Only do after this
        enabled: postQuery?.data?.userId != null,
        queryFn: () =&gt; getUser(postQuery.data.userId)
    });

    if (postQuery.status === 'loading') return &lt;h1&gt;Loading...&lt;/h1&gt;;
    if (postQuery.status === 'error') {
        return &lt;h1&gt;{JSON.stringify(postQuery.error)}&lt;/h1&gt;;
    }

    return (
        &lt;&gt;
            &lt;h1&gt;
                {postQuery.data.title} &lt;br /&gt;
                &lt;small&gt;
                    {userQuery.isLoading
                        ? 'Loading User...'
                        : userQuery.isError
                          ? 'Error Loading User'
                          : userQuery.data.name}
                &lt;/small&gt;
            &lt;/h1&gt;
            &lt;p&gt;{postQuery.data.body}&lt;/p&gt;
        &lt;/&gt;
    );
}
</code></pre>
<h4 id="create-post"><a class="header" href="#create-post">Create Post</a></h4>
<pre><code class="language-tsx">import { useMutation } from '@tanstack/react-query';
import { useRef } from 'react';
import { queryClient } from './react-query-wrapper';

async function createPost(data: any) {
    console.log(data);
    const res = await fetch('http://localhost:5000/posts', {
        method: 'POST',
        headers: {
            Accept: 'application/json',
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    });
    const _res = await res.json();
    console.log(_res);
    return _res;
}

const CreatePost = ({ setCurrentPage }: any) =&gt; {
    const createPostQuery = useMutation({
        mutationFn: async (data) =&gt; {
            return await createPost(data);
        },
        onSuccess: (data) =&gt; {
            // update cache for post by id to skip loading
            queryClient.setQueryData(['posts', data.id], data);

            // invalidate
            queryClient.invalidateQueries({ queryKey: ['posts'], exact: true });
        }
    });

    const title = useRef();
    const body = useRef();

    return (
        &lt;&gt;
            &lt;h3&gt;CreatePost &lt;/h3&gt;
            &lt;input type="text" ref={title} /&gt;
            &lt;input type="text" ref={body} /&gt;
            &lt;button
                type="button"
                onClick={() =&gt; {
                    createPostQuery.mutateAsync({
                        title: title.current.value,
                        body: body.current.value
                    });
                }}
            &gt;
                Add
            &lt;/button&gt;
        &lt;/&gt;
    );
};

export default CreatePost;
</code></pre>
<h4 id="apptsx"><a class="header" href="#apptsx">App.tsx</a></h4>
<pre><code class="language-tsx">import { useQueryClient } from '@tanstack/react-query';
import { useState } from 'react';
import PostsList1 from './PostList1';
import CreatePost from './CreatePost';

export default function App() {
    const [currentPage, setCurrentPage] = useState(&lt;PostsList1 /&gt;);
    const queryClient = useQueryClient();

    return (
        &lt;div&gt;
            &lt;button onClick={() =&gt; setCurrentPage(&lt;PostsList1 /&gt;)}&gt;
                Posts List 1
            &lt;/button&gt;
            &lt;button
                onClick={() =&gt;
                    setCurrentPage(
                        &lt;CreatePost setCurrentPage={setCurrentPage} /&gt;
                    )
                }
            &gt;
                New Post
            &lt;/button&gt;
            &lt;br /&gt;
            {currentPage}
        &lt;/div&gt;
    );
}
</code></pre>
<h4 id="fastapi-backend"><a class="header" href="#fastapi-backend">Fastapi backend</a></h4>
<pre><code class="language-sh">python -m venv env
source ./env/bin/activate.fish
pip install fastapi uvicorn
wget "https://raw.githubusercontent.com/WebDevSimplified/react-query-crash-course-example/main/api/db.json"
</code></pre>
<pre><code class="language-py">from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
import json
import time
from pydantic import BaseModel
from starlette.responses import JSONResponse
import uvicorn

app = FastAPI()

origins = [
    "http://localhost:5173",
]

app.add_middleware(
    CORSMiddleware,
    allow_origins=origins,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

db = None
with open("./db.json", "r") as fp:
    db = json.load(fp)


def add_post_to_json(data):
    if db:
        val = {
            "userId": 1,
            "id": int(time.time()),
            "title": data.title,
            "body": data.body,
        }

        db["posts"].append(val)
        with open("./db.json", "w") as fp:
            json.dump(db, fp, indent=4)

        return val
    return None


@app.get("/posts")
async def get_posts():
    return JSONResponse(content={"data": db["posts"] if db else None})


@app.get("/posts/id")
async def get_posts_by_id(id: int):
    return JSONResponse(content={"data": db["posts"][id] if db else None})


class Data(BaseModel):
    title: str
    body: str


@app.post("/posts")
async def create_post(data: Data):
    val = add_post_to_json(data)
    return JSONResponse(content=val)


if __name__ == "__main__":
    uvicorn.run("main:app", port=5000, reload=True)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="24_monorepo"><a href="#24_monorepo" class="header">24_Monorepo</a></h1>
<h3 id="monorepo-setup"><a class="header" href="#monorepo-setup">Monorepo setup</a></h3>
<pre><code class="language-sh">mkdir monorepo
cd monorepo
bun init -y
mkdir apps libs
rm -rf index.ts

cd apps
mkdir web
cd web
bunx create-next-app@latest .
cd ../..

cd apps
mkdir server
cd server
bun init -y
bun add express cors dotenv
bun add -D @types/express @types/cors
cd ../..

### Add these to package.json [server]
  "workspaces": [
    "apps/*",
    "libs/*"
  ]



    "private": true,

    "scripts": {
        "format": "prettier  '{apps,libs}/**/*.{ts,tsx,js,json}' --ignore-path .gitignore",
        "format:check": "bun format --check",
        "format:write": "bun format --write",
        "build": "bun nx run-many -t build",
        "lint": "bun nx run-many -t lint",
        "validate": "bun run format:write &amp;&amp; bun run lint &amp;&amp; bun run build &amp;&amp; cd libs/db/;bun run prisma generate",
        "prepare": "husky"
    },

</code></pre>
<h3 id="server-code"><a class="header" href="#server-code">Server Code</a></h3>
<blockquote>
<p>src/index.ts</p>
</blockquote>
<pre><code class="language-ts">import express from 'express';
import cors from 'cors';
import 'dotenv/config';

const app = express();
app.use(express.json());
app.use(cors());

app.get('/', (_, res) =&gt; {
    return res.json({ msg: 'Hello World!' }).status(200);
});

app.listen(process.env.SERVER_PORT, () =&gt; {
    console.log(`Listening on http://localhost:${process.env.SERVER_PORT} ...`);
});
</code></pre>
<h3 id="web-code"><a class="header" href="#web-code">Web Code</a></h3>
<p>Delete the template nextjs code and start server and check</p>
<h3 id="validation-code"><a class="header" href="#validation-code">Validation Code</a></h3>
<h3 id="install-nx-to-root"><a class="header" href="#install-nx-to-root">Install nx to root</a></h3>
<pre><code class="language-sh">### Add these to root package.json
bunx nx@latest init

dev, build [order]
build, lint [cache]
next,dist,build [output]

bun nx run-many -t build
</code></pre>
<h3 id="add-prettier-to-root"><a class="header" href="#add-prettier-to-root">Add prettier to root</a></h3>
<pre><code class="language-sh">
### Install

bun add -D prettier

### package.json
    "scripts": {
        "format": "prettier  '{apps,libs}/**/*.{ts,tsx,js,json}' --ignore-path .gitignore",
        "format:check": "bun format --check",
        "format:write": "bun format --write",
        "build": "bun nx run-many -t build",
        "lint": "bun nx run-many -t lint"
    },
</code></pre>
<h3 id="add-husky--lint-staged"><a class="header" href="#add-husky--lint-staged">Add Husky &amp; lint-staged</a></h3>
<pre><code class="language-sh">bunx husky init;
bun add --dev husky;
bun install

### Add to pre-commit
bun run lint-staged


bun add -D lint-staged
touch .lintstagedrc
echo "{
'{apps,libs}/**/*.{ts,tsx,js,json}':'bun run validate',
}" &gt; .lintstagedrc
</code></pre>
<h3 id="add-prisma"><a class="header" href="#add-prisma">Add prisma</a></h3>
<pre><code class="language-sh"># change name package.json

bun add -D prisma
bun add @prisma/client
bunx prisma init --datasource-provider postgresql

bunx prisma generate
bunx prisma migrate dev --name "Initial Migration"

ALTER DATABASE template1 REFRESH COLLATION VERSION;
</code></pre>
<pre><code class="language-env">DATABASE_URL="postgresql://postgres:@localhost:5432/authdb?schema=public"
</code></pre>
<pre><code class="language-prisma">// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model User {
    uid          String        @id
    createdAt    DateTime      @default(now())
    updatedAt    DateTime      @updatedAt
    name         String?
    image        String?
    Credentials  Credentials?
    AuthProvider AuthProvider?
    Admin        Admin?
    Manager      Manager?
}

model Admin {
    uid  String @id
    user User   @relation(fields: [uid], references: [uid])
}

model Manager {
    uid  String @id
    user User   @relation(fields: [uid], references: [uid])
}

model Credentials {
    uid          String   @id
    email        String   @unique
    user         User     @relation(fields: [uid], references: [uid])
    passwordHash String
    createdAt    DateTime @default(now())
    updatedAt    DateTime @updatedAt
}

model AuthProvider {
    uid String @id
    type AuthProviderType
    user User             @relation(fields: [uid], references: [uid])
}

enum AuthProviderType {
    GOOGLE
    CREDENTIALS
}
</code></pre>
<blockquote>
<p>libs/db/index.ts</p>
</blockquote>
<pre><code class="language-ts">import { PrismaClient } from '@prisma/client';

const globalForPrisma = globalThis as unknown as {
    prisma: PrismaClient | undefined;
};

export const prisma =
    globalForPrisma.prisma ??
    new PrismaClient({
        log:
            process.env.NODE_ENV === 'development'
                ? ['query', 'error', 'warn']
                : ['error']
    });

if (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;
</code></pre>
<blockquote>
<p>libs/db/types.ts</p>
</blockquote>
<pre><code class="language-ts">export * from '@prisma/client';
</code></pre>
<h3 id="trpc-setup"><a class="header" href="#trpc-setup">TRPC Setup</a></h3>
<pre><code class="language-sh">
# change name package.json


cd libs
mkdir trpc-server trpc-client
cd trpc-server
bun add @trpc/server
cd ../..
"@monorepo/db": "workspace:^"
</code></pre>
<blockquote>
<p>libs/trpc-server/index.ts</p>
</blockquote>
<pre><code class="language-ts">import { createExpressMiddleware } from '@trpc/server/adapters/express';
import { appRouter } from './routers';

export const trpcExpress = createExpressMiddleware({
    router: appRouter
});
</code></pre>
<blockquote>
<p>libs/trpc-server/trpc.ts</p>
</blockquote>
<pre><code class="language-ts">import { initTRPC } from '@trpc/server';

const t = initTRPC.create();

export const router = t.router;
export const publicProcedure = t.procedure;
</code></pre>
<blockquote>
<p>libs/trpc-server/routers/index.ts</p>
</blockquote>
<pre><code class="language-ts">import type { inferRouterOutputs } from '@trpc/server';
import { router } from '../trpc';
import { authRoutes } from './auth';

export const appRouter = router({
    auth: authRoutes
});

export type AppRouter = typeof appRouter;
export type AppRouterType = inferRouterOutputs&lt;AppRouter&gt;;
</code></pre>
<blockquote>
<p>libs/trpc-server/routers/auth.ts</p>
</blockquote>
<pre><code class="language-ts">import { publicProcedure, router } from '../trpc';
import { prisma } from '@monorepo/db';

export const authRoutes = router({
    users: publicProcedure.query(() =&gt; {
        return prisma.user.findMany({});
    })
});
</code></pre>
<p>Add ExpressMiddleware</p>
<pre><code class="language-ts">// TRPC Middleware
app.use('/trpc', trpcExpress);

// Add dependencies
"dependencies": {
        "@monorepo/trpc-server": "workspace:^"
    },
</code></pre>
<h3 id="trpc-in-react-client--server"><a class="header" href="#trpc-in-react-client--server">TRPC in react client &amp; server</a></h3>
<pre><code class="language-sh">bun add @tanstack/react-query@4.36.1 @trpc/client @trpc/react-query react
bun add dotenv
bun add -D @types/dotenv
</code></pre>
<blockquote>
<p>src/libs/trcp-client/src/client.ts</p>
</blockquote>
<pre><code class="language-ts">import type { AppRouter } from '@monorepo/trpc-server/routers';
import { createTRPCReact } from '@trpc/react-query';

export const trpcClient = createTRPCReact&lt;AppRouter&gt;();
</code></pre>
<blockquote>
<p>src/libs/trcp-client/src/index.ts</p>
</blockquote>
<pre><code class="language-ts">import type { AppRouter } from '@monorepo/trpc-server/routers';
import { createTRPCProxyClient, httpBatchLink } from '@trpc/client';
import 'dotenv/config';

export const trpc = createTRPCProxyClient&lt;AppRouter&gt;({
    links: [
        httpBatchLink({
            url: process.env.SERVER_URL as string
        })
    ]
});
</code></pre>
<blockquote>
<p>src/libs/trcp-client/src/Provider.tsx</p>
</blockquote>
<pre><code class="language-tsx">'use client';

import { trpcClient as trpc } from './client';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { httpBatchLink } from '@trpc/client';

import React, { useState } from 'react';

export const Provider = ({ children }: { children: React.ReactNode }) =&gt; {
    const [queryClient] = useState(() =&gt; new QueryClient());
    const [trpcClient] = useState(() =&gt;
        trpc.createClient({
            links: [
                httpBatchLink({
                    url: process.env.SERVER_URL as string
                })
            ]
        })
    );

    return (
        &lt;trpc.Provider client={trpcClient} queryClient={queryClient}&gt;
            &lt;QueryClientProvider client={queryClient}&gt;
                {children}
            &lt;/QueryClientProvider&gt;
        &lt;/trpc.Provider&gt;
    );
};
</code></pre>
<h3 id="add-to-web"><a class="header" href="#add-to-web">Add to web</a></h3>
<pre><code class="language-sh">"dependencies": {
        "@monorepo/trpc-client": "workspace:^"
    },
&lt;Provider&gt;{children}&lt;/Provider&gt;

env: {
        SERVER_URL: process.env.SERVER_URL
    }
</code></pre>
<h3 id="authn-and-authz"><a class="header" href="#authn-and-authz">AuthN and AuthZ</a></h3>
<p>Add context</p>
<blockquote>
<p>libs/trpc-server/context.ts</p>
</blockquote>
<pre><code class="language-ts">import type { CreateExpressContextOptions } from '@trpc/server/adapters/express';

export const createTRPCContext = ({
    req,
    res
}: CreateExpressContextOptions) =&gt; {
    const header = req.headers.authorization;
    const token = header?.split(' ')[1];
    return { req, res, token };
};

export type TRPCContext = Awaited&lt;ReturnType&lt;typeof createTRPCContext&gt;&gt;;
</code></pre>
<blockquote>
<p>libs/trpc-server/index.ts</p>
</blockquote>
<pre><code class="language-ts">import { createExpressMiddleware } from '@trpc/server/adapters/express';
import { appRouter } from './routers';
import { createTRPCContext } from './context';

export const trpcExpress = createExpressMiddleware({
    router: appRouter,
    createContext: createTRPCContext
});
</code></pre>
<blockquote>
<p>libs/trpc-server/trpc.ts</p>
</blockquote>
<pre><code class="language-ts">import { initTRPC } from '@trpc/server';
import type { TRPCContext } from './context';

const t = initTRPC.context&lt;TRPCContext&gt;().create();

export const router = t.router;
export const publicProcedure = t.procedure;
</code></pre>
<p>Add Middleware</p>
<pre><code class="language-sh">bun add jsonwebtoken
bun add -D @types/jsonwebtoken
</code></pre>
<blockquote>
<p>libs/trpc-server/middleware.ts</p>
</blockquote>
<pre><code class="language-ts">import { TRPCError } from '@trpc/server';
import { verify, type JwtPayload } from 'jsonwebtoken';
import { t } from './trpc';
import type { Role } from './types';
import { authorizeUser } from './utils';

export const isAuthed = (...roles: Role[]) =&gt;
    t.middleware(async (opts) =&gt; {
        const { token } = opts.ctx;
        if (!token) {
            throw new TRPCError({
                code: 'FORBIDDEN',
                message: 'Token not found.'
            });
        }

        let uid;

        try {
            const user = verify(token, process.env.NEXTAUTH_SECRET || '');
            uid = (user as JwtPayload).uid;
        } catch (error) {
            throw new TRPCError({
                code: 'FORBIDDEN',
                message: 'Invalid token.'
            });
        }

        await authorizeUser(uid, roles);

        return opts.next({ ...opts, ctx: { ...opts.ctx, uid } });
    });
</code></pre>
<blockquote>
<p>libs/trpc-server/utils.ts</p>
</blockquote>
<pre><code class="language-ts">import { prisma } from '@monorepo/db';
import { TRPCError } from '@trpc/server';
import type { Role } from './types';

export const getUserRoles = async (uid: string): Promise&lt;Role[]&gt; =&gt; {
    const [adminExists, managerExists] = await Promise.all([
        prisma.admin.findUnique({ where: { uid } }),
        prisma.manager.findUnique({ where: { uid } })
    ]);

    const roles: Role[] = [];
    if (adminExists) roles.push('admin');
    if (managerExists) roles.push('manager');

    return roles;
};

export const authorizeUser = async (
    uid: string,
    roles: Role[]
): Promise&lt;void&gt; =&gt; {
    if (!roles || roles.length === 0) {
        return; // No specific roles required, access is granted
    }

    const userRoles = await getUserRoles(uid);

    if (!userRoles.some((role) =&gt; roles.includes(role))) {
        throw new TRPCError({
            code: 'FORBIDDEN',
            message: 'User does not have the required role(s).'
        });
    }
};

export const checkRowLevelPermission = async (
    uid: string,
    allowedUids: string | string[],
    allowedRoles: Role[] = ['admin']
) =&gt; {
    const userRoles = await getUserRoles(uid);

    if (userRoles?.some((role) =&gt; allowedRoles.includes(role))) {
        return true;
    }

    const uids =
        typeof allowedUids === 'string'
            ? [allowedUids]
            : allowedUids.filter(Boolean);

    if (!uids.includes(uid)) {
        throw new TRPCError({
            code: 'FORBIDDEN',
            message: 'You are not allowed to do this action.'
        });
    }
};
</code></pre>
<blockquote>
<p>libs/trpc-server/types.ts</p>
</blockquote>
<pre><code class="language-ts">export type Role = 'admin' | 'manager';
</code></pre>
<blockquote>
<p>trpc.ts</p>
</blockquote>
<pre><code class="language-ts">import { initTRPC } from '@trpc/server';
import type { TRPCContext } from './context';
import { isAuthed } from './middleware';
import type { Role } from './types';

export const t = initTRPC.context&lt;TRPCContext&gt;().create();

export const router = t.router;
export const publicProcedure = t.procedure;
// export const privateProcedure = t.procedure.use(isAuthed());
export const privateProcedure = (...roles: Role[]) =&gt;
    t.procedure.use(isAuthed(...roles));
</code></pre>
<p>Test by passing headers</p>
<pre><code>t.procedure.use(isAuthed("")).query()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="golang"><a class="header" href="#golang">Golang</a></h1>
<h1 id="01hello"><a class="header" href="#01hello">01hello</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import "fmt"

func main() {
	fmt.Println("Hello from LearnCodeonline.in")
}
</code></pre>
<h1 id="02variables"><a class="header" href="#02variables">02variables</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import "fmt"

const LoginToken string = "ghabbhhjd" // Public

func main() {
	var username string = "hitesh"
	fmt.Println(username)
	fmt.Printf("Variable is of type: %T \n", username)

	var isLoggedIn bool = false
	fmt.Println(isLoggedIn)
	fmt.Printf("Variable is of type: %T \n", isLoggedIn)

	var smallVal uint8 = 255
	fmt.Println(smallVal)
	fmt.Printf("Variable is of type: %T \n", smallVal)

	var smallFloat float64 = 255.45544511254451885
	fmt.Println(smallFloat)
	fmt.Printf("Variable is of type: %T \n", smallFloat)

	// default values and some aliases
	var anotherVariable int
	fmt.Println(anotherVariable)
	fmt.Printf("Variable is of type: %T \n", anotherVariable)

	// implicit type

	var website = "learncodeonline.in"
	fmt.Println(website)

	// no var style

	numberOfUser := 300000.0
	fmt.Println(numberOfUser)

	fmt.Println(LoginToken)
	fmt.Printf("Variable is of type: %T \n", LoginToken)

}
</code></pre>
<h1 id="03userinput"><a class="header" href="#03userinput">03userinput</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"bufio"
	"fmt"
	"os"
)

func main() {
	welcome := "Welcome to user input"
	fmt.Println(welcome)

	reader := bufio.NewReader(os.Stdin)
	fmt.Println("Enter the rating for our Pizza:")

	// comma ok || err err

	input, _ := reader.ReadString('\n')
	fmt.Println("Thanks for rating, ", input)
	fmt.Printf("Type of this rating is %T", input)
}
</code></pre>
<h1 id="04conversion"><a class="header" href="#04conversion">04conversion</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"bufio"
	"fmt"
	"os"
	"strconv"
	"strings"
)

func main() {
	fmt.Println("Welcome to our pizza app")
	fmt.Println("Please rate our pizza between 1 and 5")

	reader := bufio.NewReader(os.Stdin)

	input, _ := reader.ReadString('\n')

	fmt.Println("Thanks for rating, ", input)

	numRating, err := strconv.ParseFloat(strings.TrimSpace(input), 64)

	if err != nil {
		fmt.Println(err)

	} else {
		fmt.Println("Added 1 to your rating: ", numRating+1)
	}
}
</code></pre>
<h1 id="05mymaths"><a class="header" href="#05mymaths">05mymaths</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"fmt"
	"math/big"

	//"math/rand"
	"crypto/rand"
)

func main() {
	fmt.Println("Welcome to maths in golang")

	//var mynumberOne int = 2
	//var mynumberTwo float64 = 4.5

	// fmt.Println("The sum is: ", mynumberOne+int(mynumberTwo))

	//random number
	// rand.Seed(time.Now().UnixNano())
	// fmt.Println(rand.Intn(5) + 1)

	//random from crypto

	myRandomNum, _ := rand.Int(rand.Reader, big.NewInt(5))
	fmt.Println(myRandomNum)

}
</code></pre>
<h1 id="06mytime"><a class="header" href="#06mytime">06mytime</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"fmt"
	"time"
)

func main() {
	fmt.Println("Welcome to time study of golang")

	presentTime := time.Now()
	fmt.Println(presentTime)

	fmt.Println(presentTime.Format("01-02-2006 15:04:05 Monday"))

	createdDate := time.Date(2020, time.August, 12, 23, 23, 0, 0, time.UTC)
	fmt.Println(createdDate)
	fmt.Println(createdDate.Format("01-02-2006 Monday"))
}
</code></pre>
<h1 id="07mypointers"><a class="header" href="#07mypointers">07mypointers</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import "fmt"

func main() {
	fmt.Println("Welcome to a class on pointers")

	// var ptr *int
	// fmt.Println("Value of pointer is ", ptr)

	myNumber := 23

	var ptr = &amp;myNumber

	fmt.Println("Value of actual pointer is ", ptr)
	fmt.Println("Value of actual pointer is ", *ptr)

	*ptr = *ptr + 2
	fmt.Println("New value is: ", myNumber)

}
</code></pre>
<h1 id="08myarray"><a class="header" href="#08myarray">08myarray</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import "fmt"

func main() {
	fmt.Println("Welcome to array in golangs")

	var fruitList [4]string

	fruitList[0] = "Apple"
	fruitList[1] = "Tomato"
	fruitList[3] = "Peach"

	fmt.Println("Fruit list is: ", fruitList)
	fmt.Println("Fruit list is: ", len(fruitList))

	var vegList = [5]string{"potato", "beans", "mushroom"}
	fmt.Println("Vegy list is: ", len(vegList))

}
</code></pre>
<h1 id="09myslices"><a class="header" href="#09myslices">09myslices</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"fmt"
	"sort"
)

func main() {
	fmt.Println("Welcome to video on slices")

	var fruitList = []string{"Apple", "Tomato", "Peach"}
	fmt.Printf("Type of fruitlist is %T\n", fruitList)

	fruitList = append(fruitList, "Mango", "Banana")
	fmt.Println(fruitList)

	fruitList = append(fruitList[:3])
	fmt.Println(fruitList)

	highScores := make([]int, 4)

	highScores[0] = 234
	highScores[1] = 945
	highScores[2] = 465
	highScores[3] = 867
	//highScores[4] = 777

	highScores = append(highScores, 555, 666, 321)

	fmt.Println(highScores)

	//fmt.Println(sort.IntsAreSorted(highScores))
	sort.Ints(highScores)
	//fmt.Println(highScores)

	//how to remove a value from slices based on index

	var courses = []string{"reactjs", "javascript", "swift", "python", "ruby"}
	fmt.Println(courses)
	var index int = 2
	courses = append(courses[:index], courses[index+1:]...)
	fmt.Println(courses)

}
</code></pre>
<h1 id="10mymaps"><a class="header" href="#10mymaps">10mymaps</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import "fmt"

func main() {
	fmt.Println("Maps in golang")

	languages := make(map[string]string)

	languages["JS"] = "Javascript"
	languages["RB"] = "Ruby"
	languages["PY"] = "Python"

	fmt.Println("List of all languages: ", languages)
	fmt.Println("JS shorts for: ", languages["JS"])

	delete(languages, "RB")
	fmt.Println("List of all languages: ", languages)

	// loops are interesting in golang

	for _, value := range languages {
		fmt.Printf("For key v, value is %v\n", value)
	}

}
</code></pre>
<h1 id="11mystructs"><a class="header" href="#11mystructs">11mystructs</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import "fmt"

func main() {
	fmt.Println("Structs in golang")
	// no inheritance in golang; No super or parent

	hitesh := User{"Hitesh", "hitesh@go.dev", true, 16}
	fmt.Println(hitesh)
	fmt.Printf("hitesh details are: %+v\n", hitesh)
	fmt.Printf("Name is %v and email is %v.", hitesh.Name, hitesh.Email)

}

type User struct {
	Name   string
	Email  string
	Status bool
	Age    int
}
</code></pre>
<h1 id="12ifelse"><a class="header" href="#12ifelse">12ifelse</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import "fmt"

func main() {
	fmt.Println("If else in golang")

	loginCount := 10
	var result string

	if loginCount &lt; 10 {
		result = "Regular user"
	} else if loginCount &gt; 10 {
		result = "Watch out"
	} else {
		result = "Exactly 10 login count"
	}

	fmt.Println(result)

	if 9%2 == 0 {
		fmt.Println("Number is even")
	} else {
		fmt.Println("Number is odd")
	}

	if num := 3; num &lt; 10 {
		fmt.Println("Num is less than 10")
	} else {
		fmt.Println("Num is NOT less than 10")
	}

	// if err != nil {

	// }

}
</code></pre>
<h1 id="13switchcase"><a class="header" href="#13switchcase">13switchcase</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"fmt"
	"math/rand"
	"time"
)

func main() {
	fmt.Println("Switch and case in golang")

	rand.Seed(time.Now().UnixNano())
	diceNumber := rand.Intn(6) + 1
	fmt.Println("Value of dice is ", diceNumber)

	switch diceNumber {
	case 1:
		fmt.Println("Dice value is 1 and you can open")
	case 2:
		fmt.Println("You can move 2 spot")
	case 3:
		fmt.Println("You can move to 3 spot")
		fallthrough
	case 4:
		fmt.Println("you can move to 4 spot")
		fallthrough
	case 5:
		fmt.Println("You can move to 5 spot")
	case 6:
		fmt.Println("You can move to 6 spot and roll dice again")
	default:
		fmt.Println("What was that!")
	}

}
</code></pre>
<h1 id="14loops"><a class="header" href="#14loops">14loops</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import "fmt"

func main() {
	fmt.Println("Welcome to loops in golang")

	days := []string{"Sunday", "Tuesday", "Wednesday", "Friday", "Saturday"}

	fmt.Println(days)

	// for d := 0; d &lt; len(days); d++ {
	// 	fmt.Println(days[d])
	// }

	// for i := range days {
	// 	fmt.Println(days[i])
	// }

	// for _, day := range days {
	// 	fmt.Printf("index is  and value is %v\n", day)
	// }

	rougueValue := 1

	for rougueValue &lt; 10 {

		if rougueValue == 2 {
			goto lco
		}

		if rougueValue == 5 {
			rougueValue++
			continue
		}

		fmt.Println("Value is: ", rougueValue)
		rougueValue++
	}

lco:
	fmt.Println("Jumping at LearnCodeonline.in")

}
</code></pre>
<h1 id="15functions"><a class="header" href="#15functions">15functions</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import "fmt"

func main() {
	fmt.Println("Welcome to functions in golang")
	greeter()

	result := adder(3, 5)
	fmt.Println("Result is: ", result)

	proRes, myMessage := proAdder(2, 5, 8, 7, 3)
	fmt.Println("Pro result is: ", proRes)
	fmt.Println("Pro Message is: ", myMessage)

}

func adder(valOne int, valTwo int) int {
	return valOne + valTwo
}

func proAdder(values ...int) (int, string) {
	total := 0

	for _, val := range values {
		total += val
	}

	return total, "Hi Pro result function"

}

func greeter() {
	fmt.Println("Namstey from golang")
}
</code></pre>
<h1 id="16methods"><a class="header" href="#16methods">16methods</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import "fmt"

func main() {
	fmt.Println("Structs in golang")
	// no inheritance in golang; No super or parent

	hitesh := User{"Hitesh", "hitesh@go.dev", true, 16}
	fmt.Println(hitesh)
	fmt.Printf("hitesh details are: %+v\n", hitesh)
	fmt.Printf("Name is %v and email is %v.\n", hitesh.Name, hitesh.Email)
	hitesh.GetStatus()
	hitesh.NewMail()
	fmt.Printf("Name is %v and email is %v.\n", hitesh.Name, hitesh.Email)

}

type User struct {
	Name   string
	Email  string
	Status bool
	Age    int
}

func (u User) GetStatus() {
	fmt.Println("Is user active: ", u.Status)
}

func (u User) NewMail() {
	u.Email = "test@go.dev"
	fmt.Println("Email of this user is: ", u.Email)
}
</code></pre>
<h1 id="17defer"><a class="header" href="#17defer">17defer</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import "fmt"

func main() {
	defer fmt.Println("World")
	defer fmt.Println("One")
	defer fmt.Println("Two")
	fmt.Println("Hello")
	myDefer()

}

// world, One, Two
// 0, 1, 2, 3, 4
// hello, 43210, two, One, world

func myDefer() {
	for i := 0; i &lt; 5; i++ {
		defer fmt.Print(i)
	}
}
</code></pre>
<h1 id="18files"><a class="header" href="#18files">18files</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"fmt"
	"io"
	"io/ioutil"
	"os"
)

func main() {
	fmt.Println("Welcome to files in golang")
	content := "This needs to go in a file - LearnCodeOnline.in"

	file, err := os.Create("./mylcogofile.txt")

	// if err != nil {
	// 	panic(err)
	// }
	checkNilErr(err)

	length, err := io.WriteString(file, content)
	checkNilErr(err)
	fmt.Println("length is: ", length)
	defer file.Close()
	readFile("./mylcogofile.txt")
}

func readFile(filname string) {
	databyte, err := ioutil.ReadFile(filname)
	checkNilErr(err)

	fmt.Println("Text data inside the file is \n", string(databyte))

}

func checkNilErr(err error) {
	if err != nil {
		panic(err)
	}
}
</code></pre>
<h1 id="19webrequests"><a class="header" href="#19webrequests">19webrequests</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"fmt"
	"io/ioutil"
	"net/http"
)

const url = "https://lco.dev"

func main() {
	fmt.Println("LCO web request")

	response, err := http.Get(url)

	if err != nil {
		panic(err)
	}

	fmt.Printf("Response is of type: %T\n", response)

	defer response.Body.Close() // caller's responsibility to close the connection

	databytes, err := ioutil.ReadAll(response.Body)

	if err != nil {
		panic(err)
	}
	content := string(databytes)
	fmt.Println(content)

}
</code></pre>
<h1 id="20urls"><a class="header" href="#20urls">20urls</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"fmt"
	"net/url"
)

const myurl string = "https://lco.dev:3000/learn?coursename=reactjs&amp;paymentid=ghbj456ghb"

func main() {
	fmt.Println("Welcome to handling URLs in golang")
	fmt.Println(myurl)

	//parsing
	result, _ := url.Parse(myurl)

	// fmt.Println(result.Scheme)
	// fmt.Println(result.Host)
	// fmt.Println(result.Path)
	// fmt.Println(result.Port())
	fmt.Println(result.RawQuery)

	qparams := result.Query()
	fmt.Printf("The type of query params are: %T\n", qparams)

	fmt.Println(qparams["coursename"])

	for _, val := range qparams {
		fmt.Println("Param is: ", val)
	}

	partsOfUrl := &amp;url.URL{
		Scheme:  "https",
		Host:    "lco.dev",
		Path:    "/tutcss",
		RawPath: "user=hitesh",
	}

	anotherURL := partsOfUrl.String()
	fmt.Println(anotherURL)

}
</code></pre>
<h1 id="21webreqverbs"><a class="header" href="#21webreqverbs">21webreqverbs</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"fmt"
	"io/ioutil"
	"net/http"
	"net/url"
	"strings"
)

func main() {
	fmt.Println("Welcome to web verb video - LCO")
	//PerformGetRequest()
	// PerformPostJsonRequest()
	PerformPostFormRequest()
}

func PerformGetRequest() {
	const myurl = "http://localhost:8000/get"

	response, err := http.Get(myurl)
	if err != nil {
		panic(err)
	}

	defer response.Body.Close()

	fmt.Println("Status code: ", response.StatusCode)
	fmt.Println("Content length is: ", response.ContentLength)

	var responseString strings.Builder
	content, _ := ioutil.ReadAll(response.Body)
	byteCount, _ := responseString.Write(content)

	fmt.Println("ByteCount is: ", byteCount)
	fmt.Println(responseString.String())

	//fmt.Println(content)
	//fmt.Println(string(content))
}

func PerformPostJsonRequest() {
	const myurl = "http://localhost:8000/post"

	//fake json payload

	requestBody := strings.NewReader(`
		{
			"coursename":"Let's go with golang",
			"price": 0,
			"platform":"learnCodeOnline.in"
		}
	`)

	response, err := http.Post(myurl, "application/json", requestBody)

	if err != nil {
		panic(err)
	}
	defer response.Body.Close()

	content, _ := ioutil.ReadAll(response.Body)

	fmt.Println(string(content))
}

func PerformPostFormRequest() {
	const myurl = "http://localhost:8000/postform"

	//formdata

	data := url.Values{}
	data.Add("firstname", "hitesh")
	data.Add("lastname", "choudhary")
	data.Add("email", "hitesh@go.dev")

	response, err := http.PostForm(myurl, data)
	if err != nil {
		panic(err)
	}

	defer response.Body.Close()

	content, _ := ioutil.ReadAll(response.Body)
	fmt.Println(string(content))

}
</code></pre>
<h1 id="22bitmorejson"><a class="header" href="#22bitmorejson">22bitmorejson</a></h1>
<blockquote>
<p>Code</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"encoding/json"
	"fmt"
)

type course struct {
	Name     string `json:"coursename"`
	Price    int
	Platform string   `json:"website"`
	Password string   `json:"-"`
	Tags     []string `json:"tags,omitempty"`
}

func main() {
	fmt.Println("Welcome to JSON video")
	// EncodeJson()
	DecodeJson()
}

func EncodeJson() {

	lcoCourses := []course{
		{"ReactJS Bootcamp", 299, "LearnCodeOnline.in", "abc123", []string{"web-dev", "js"}},
		{"MERN Bootcamp", 199, "LearnCodeOnline.in", "bcd123", []string{"full-stack", "js"}},
		{"Angular Bootcamp", 299, "LearnCodeOnline.in", "hit123", nil},
	}

	//package this data as JSON data

	finalJson, err := json.MarshalIndent(lcoCourses, "", "\t")
	if err != nil {
		panic(err)
	}
	fmt.Printf("%s\n", finalJson)

}

func DecodeJson() {
	jsonDataFromWeb := []byte(`
	{
		"coursename": "ReactJS Bootcamp",
		"Price": 299,
		"website": "LearnCodeOnline.in",
		"tags": ["web-dev","js"]
	}
	`)

	var lcoCourse course

	checkValid := json.Valid(jsonDataFromWeb)

	if checkValid {
		fmt.Println("JSON was valid")
		json.Unmarshal(jsonDataFromWeb, &amp;lcoCourse)
		fmt.Printf("%#v\n", lcoCourse)
	} else {
		fmt.Println("JSON WAS NOT VALID")
	}

	// some cases where you just want to add data to key value

	var myOnlineData map[string]interface{}
	json.Unmarshal(jsonDataFromWeb, &amp;myOnlineData)
	fmt.Printf("%#v\n", myOnlineData)

	for k, v := range myOnlineData {
		fmt.Printf("Key is %v  and value is %v and Type is: %T\n", k, v, v)
	}

}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="-docker-complete-cheatsheet-for-beginners"><a class="header" href="#-docker-complete-cheatsheet-for-beginners">🐳 Docker Complete Cheatsheet for Beginners</a></h1>
<hr>
<h2 id="-official-documentation-links"><a class="header" href="#-official-documentation-links">📚 Official Documentation Links</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Resource</th><th>Link</th></tr>
</thead>
<tbody>
<tr><td>Docker Documentation</td><td>https://docs.docker.com/</td></tr>
<tr><td>Dockerfile Reference</td><td>https://docs.docker.com/reference/dockerfile/</td></tr>
<tr><td>Docker CLI Reference</td><td>https://docs.docker.com/reference/cli/docker/</td></tr>
<tr><td>Docker Compose</td><td>https://docs.docker.com/compose/</td></tr>
<tr><td>Docker Hub</td><td>https://hub.docker.com/</td></tr>
<tr><td>Best Practices</td><td>https://docs.docker.com/develop/develop-images/dockerfile_best-practices/</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="-basic-docker-commands"><a class="header" href="#-basic-docker-commands">📦 Basic Docker Commands</a></h2>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/</p>
</blockquote>
<h3 id="images"><a class="header" href="#images">Images</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/image/</p>
</blockquote>
<pre><code class="language-bash"># List images
docker images

# Pull image from Docker Hub
docker pull python:3.11

# Build image from Dockerfile
docker build -t myapp .

# Build with custom Dockerfile
docker build -f Dockerfile.prod -t myapp .

# Remove image
docker rmi myapp

# Remove all unused images
docker image prune -a

# Tag image
docker tag myapp myapp:v1.0

# Push to registry
docker push username/myapp:v1.0
</code></pre>
<h3 id="containers"><a class="header" href="#containers">Containers</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/container/</p>
</blockquote>
<pre><code class="language-bash"># Run container
docker run myapp

# Run with port mapping
docker run -p 8000:8000 myapp

# Run in background (detached)
docker run -d myapp

# Run with name
docker run --name my-container myapp

# Run interactively
docker run -it myapp bash

# Run with environment variables
docker run -e PORT=3000 -e DEBUG=true myapp

# Run with volume mount
docker run -v $(pwd):/app myapp

# Run and remove after exit
docker run --rm myapp

# List running containers
docker ps

# List all containers (including stopped)
docker ps -a

# Stop container
docker stop my-container

# Start stopped container
docker start my-container

# Restart container
docker restart my-container

# Remove container
docker rm my-container

# Remove running container (force)
docker rm -f my-container

# Remove all stopped containers
docker container prune
</code></pre>
<h3 id="logs--debugging"><a class="header" href="#logs--debugging">Logs &amp; Debugging</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/container/logs/</p>
</blockquote>
<pre><code class="language-bash"># View logs
docker logs my-container

# Follow logs (live)
docker logs -f my-container

# Show last 100 lines
docker logs --tail 100 my-container

# Execute command in running container
docker exec -it my-container bash

# View container details
docker inspect my-container

# View container resource usage
docker stats

# View container processes
docker top my-container
</code></pre>
<h3 id="cleanup"><a class="header" href="#cleanup">Cleanup</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/system/prune/</p>
</blockquote>
<pre><code class="language-bash"># Remove all stopped containers
docker container prune

# Remove all unused images
docker image prune -a

# Remove all unused volumes
docker volume prune

# Remove all unused networks
docker network prune

# Remove EVERYTHING unused
docker system prune -a

# View disk usage
docker system df
</code></pre>
<hr>
<h2 id="-dockerfile-reference"><a class="header" href="#-dockerfile-reference">📝 Dockerfile Reference</a></h2>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/reference/dockerfile/</p>
</blockquote>
<h3 id="basic-instructions"><a class="header" href="#basic-instructions">Basic Instructions</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Instruction</th><th>Purpose</th><th>Example</th><th>Docs</th></tr>
</thead>
<tbody>
<tr><td><code>FROM</code></td><td>Base image</td><td><code>FROM python:3.11-slim</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#from">Link</a></td></tr>
<tr><td><code>WORKDIR</code></td><td>Set working directory</td><td><code>WORKDIR /app</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#workdir">Link</a></td></tr>
<tr><td><code>COPY</code></td><td>Copy files</td><td><code>COPY . .</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#copy">Link</a></td></tr>
<tr><td><code>ADD</code></td><td>Copy files (supports URLs, tar)</td><td><code>ADD app.tar.gz /app</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#add">Link</a></td></tr>
<tr><td><code>RUN</code></td><td>Execute command</td><td><code>RUN pip install flask</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#run">Link</a></td></tr>
<tr><td><code>ENV</code></td><td>Set environment variable</td><td><code>ENV PORT=8000</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#env">Link</a></td></tr>
<tr><td><code>ARG</code></td><td>Build-time variable</td><td><code>ARG VERSION=1.0</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#arg">Link</a></td></tr>
<tr><td><code>EXPOSE</code></td><td>Document port</td><td><code>EXPOSE 8000</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#expose">Link</a></td></tr>
<tr><td><code>CMD</code></td><td>Default command</td><td><code>CMD ["python", "app.py"]</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#cmd">Link</a></td></tr>
<tr><td><code>ENTRYPOINT</code></td><td>Fixed command</td><td><code>ENTRYPOINT ["python"]</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#entrypoint">Link</a></td></tr>
<tr><td><code>VOLUME</code></td><td>Create mount point</td><td><code>VOLUME /data</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#volume">Link</a></td></tr>
<tr><td><code>USER</code></td><td>Set user</td><td><code>USER appuser</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#user">Link</a></td></tr>
<tr><td><code>LABEL</code></td><td>Add metadata</td><td><code>LABEL version="1.0"</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#label">Link</a></td></tr>
<tr><td><code>HEALTHCHECK</code></td><td>Container health check</td><td><code>HEALTHCHECK CMD curl -f http://localhost/</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#healthcheck">Link</a></td></tr>
<tr><td><code>SHELL</code></td><td>Change default shell</td><td><code>SHELL ["/bin/bash", "-c"]</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#shell">Link</a></td></tr>
<tr><td><code>STOPSIGNAL</code></td><td>Set stop signal</td><td><code>STOPSIGNAL SIGTERM</code></td><td><a href="https://docs.docker.com/reference/dockerfile/#stopsignal">Link</a></td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="-dockerfile-examples"><a class="header" href="#-dockerfile-examples">📄 Dockerfile Examples</a></h2>
<h3 id="python-single-stage"><a class="header" href="#python-single-stage">Python (Single Stage)</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://hub.docker.com/_/python</p>
</blockquote>
<pre><code class="language-dockerfile">FROM python:3.11-slim

ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1

WORKDIR /app

# Install dependencies first (caching)
COPY requirements.txt .
RUN pip install --upgrade pip &amp;&amp; \
    pip install --no-cache-dir -r requirements.txt

# Copy application code
COPY . .

EXPOSE 8000

CMD ["python", "app.py"]
</code></pre>
<h3 id="python-with-virtual-environment"><a class="header" href="#python-with-virtual-environment">Python with Virtual Environment</a></h3>
<pre><code class="language-dockerfile">FROM python:3.11-slim

ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1

WORKDIR /app

# Create and activate virtual environment
RUN python -m venv /opt/venv
ENV PATH="/opt/venv/bin:$PATH"

COPY requirements.txt .
RUN pip install --upgrade pip &amp;&amp; \
    pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 8000

CMD ["python", "app.py"]
</code></pre>
<h3 id="nodejs-single-stage"><a class="header" href="#nodejs-single-stage">Node.js (Single Stage)</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://hub.docker.com/_/node</p>
</blockquote>
<pre><code class="language-dockerfile">FROM node:20-alpine

WORKDIR /app

# Install dependencies first (caching)
COPY package*.json ./
RUN npm ci --only=production

COPY . .

EXPOSE 3000

CMD ["node", "server.js"]
</code></pre>
<h3 id="go-single-stage"><a class="header" href="#go-single-stage">Go (Single Stage)</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://hub.docker.com/_/golang</p>
</blockquote>
<pre><code class="language-dockerfile">FROM golang:1.21-alpine

WORKDIR /app

COPY go.mod go.sum ./
RUN go mod download

COPY . .

RUN go build -o main .

EXPOSE 8080

CMD ["./main"]
</code></pre>
<hr>
<h2 id="-multi-stage-builds"><a class="header" href="#-multi-stage-builds">🏗️ Multi-Stage Builds</a></h2>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/build/building/multi-stage/</p>
</blockquote>
<h3 id="why-multi-stage"><a class="header" href="#why-multi-stage">Why Multi-Stage?</a></h3>
<ul>
<li>✅ Smaller final image</li>
<li>✅ No build tools in production</li>
<li>✅ Better security</li>
<li>✅ Faster deployments</li>
</ul>
<h3 id="python-multi-stage"><a class="header" href="#python-multi-stage">Python Multi-Stage</a></h3>
<pre><code class="language-dockerfile"># ============ Build Stage ============
FROM python:3.11-slim AS builder

WORKDIR /app

RUN python -m venv /opt/venv
ENV PATH="/opt/venv/bin:$PATH"

COPY requirements.txt .
RUN pip install --upgrade pip &amp;&amp; \
    pip install --no-cache-dir -r requirements.txt

# ============ Production Stage ============
FROM python:3.11-slim

WORKDIR /app

# Copy virtual environment from builder
COPY --from=builder /opt/venv /opt/venv
ENV PATH="/opt/venv/bin:$PATH"

# Create non-root user
RUN useradd --create-home appuser
USER appuser

COPY --chown=appuser:appuser . .

EXPOSE 8000

CMD ["gunicorn", "--bind", "0.0.0.0:8000", "app:app"]
</code></pre>
<h3 id="nodejs-multi-stage"><a class="header" href="#nodejs-multi-stage">Node.js Multi-Stage</a></h3>
<pre><code class="language-dockerfile"># ============ Build Stage ============
FROM node:20-alpine AS builder

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .
RUN npm run build

# ============ Production Stage ============
FROM node:20-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

# Copy built files from builder
COPY --from=builder /app/dist ./dist

USER node

EXPOSE 3000

CMD ["node", "dist/server.js"]
</code></pre>
<h3 id="go-multi-stage-tiny-image"><a class="header" href="#go-multi-stage-tiny-image">Go Multi-Stage (Tiny Image!)</a></h3>
<pre><code class="language-dockerfile"># ============ Build Stage ============
FROM golang:1.21-alpine AS builder

WORKDIR /app

COPY go.mod go.sum ./
RUN go mod download

COPY . .

# Build static binary
RUN CGO_ENABLED=0 GOOS=linux go build -o main .

# ============ Production Stage ============
FROM scratch

# Copy only the binary
COPY --from=builder /app/main /main

EXPOSE 8080

ENTRYPOINT ["/main"]
</code></pre>
<h3 id="react-multi-stage-with-nginx"><a class="header" href="#react-multi-stage-with-nginx">React Multi-Stage (with Nginx)</a></h3>
<blockquote>
<p>📖 <strong>Nginx Docs:</strong> https://hub.docker.com/_/nginx</p>
</blockquote>
<pre><code class="language-dockerfile"># ============ Build Stage ============
FROM node:20-alpine AS builder

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .
RUN npm run build

# ============ Production Stage ============
FROM nginx:alpine

COPY --from=builder /app/build /usr/share/nginx/html

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
</code></pre>
<hr>
<h2 id="-docker-compose"><a class="header" href="#-docker-compose">🐙 Docker Compose</a></h2>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/compose/
📖 <strong>Compose File Reference:</strong> https://docs.docker.com/compose/compose-file/</p>
</blockquote>
<h3 id="basic-commands"><a class="header" href="#basic-commands">Basic Commands</a></h3>
<blockquote>
<p>📖 <strong>CLI Reference:</strong> https://docs.docker.com/reference/cli/docker/compose/</p>
</blockquote>
<pre><code class="language-bash"># Start services
docker compose up

# Start in background
docker compose up -d

# Build and start
docker compose up --build

# Stop services
docker compose down

# Stop and remove volumes
docker compose down -v

# View logs
docker compose logs

# Follow logs
docker compose logs -f

# View logs for specific service
docker compose logs app

# List running services
docker compose ps

# Execute command in service
docker compose exec app bash

# Restart services
docker compose restart

# Stop services (without removing)
docker compose stop

# Start stopped services
docker compose start

# Build images
docker compose build

# Pull images
docker compose pull
</code></pre>
<h3 id="basic-docker-composeyml"><a class="header" href="#basic-docker-composeyml">Basic docker-compose.yml</a></h3>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        ports:
            - '8000:8000'
        environment:
            - DEBUG=true
</code></pre>
<h3 id="full-example-app--database--redis"><a class="header" href="#full-example-app--database--redis">Full Example (App + Database + Redis)</a></h3>
<blockquote>
<p>📖 <strong>PostgreSQL:</strong> https://hub.docker.com/<em>/postgres
📖 <strong>Redis:</strong> https://hub.docker.com/</em>/redis</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    # ============ Web Application ============
    app:
        build:
            context: .
            dockerfile: Dockerfile
        ports:
            - '8000:8000'
        environment:
            - DATABASE_URL=postgresql://user:password@db:5432/mydb
            - REDIS_URL=redis://redis:6379
        depends_on:
            - db
            - redis
        volumes:
            - .:/app # For development
        restart: unless-stopped

    # ============ PostgreSQL Database ============
    db:
        image: postgres:15-alpine
        environment:
            - POSTGRES_USER=user
            - POSTGRES_PASSWORD=password
            - POSTGRES_DB=mydb
        volumes:
            - postgres_data:/var/lib/postgresql/data
        ports:
            - '5432:5432'
        restart: unless-stopped

    # ============ Redis Cache ============
    redis:
        image: redis:7-alpine
        ports:
            - '6379:6379'
        volumes:
            - redis_data:/data
        restart: unless-stopped

# ============ Named Volumes ============
volumes:
    postgres_data:
    redis_data:
</code></pre>
<h3 id="with-environment-file"><a class="header" href="#with-environment-file">With Environment File</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/compose/environment-variables/</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        ports:
            - '8000:8000'
        env_file:
            - .env
</code></pre>
<p><strong>.env file:</strong></p>
<pre><code>DATABASE_URL=postgresql://user:pass@db:5432/mydb
SECRET_KEY=mysecretkey
DEBUG=false
</code></pre>
<h3 id="multiple-compose-files"><a class="header" href="#multiple-compose-files">Multiple Compose Files</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/compose/multiple-compose-files/</p>
</blockquote>
<pre><code class="language-bash"># Development
docker compose -f docker-compose.yml -f docker-compose.dev.yml up

# Production
docker compose -f docker-compose.yml -f docker-compose.prod.yml up
</code></pre>
<p><strong>docker-compose.yml (base):</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        environment:
            - DATABASE_URL=postgresql://user:pass@db:5432/mydb
</code></pre>
<p><strong>docker-compose.dev.yml:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        volumes:
            - .:/app
        environment:
            - DEBUG=true
        ports:
            - '8000:8000'
</code></pre>
<p><strong>docker-compose.prod.yml:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        environment:
            - DEBUG=false
        restart: always
</code></pre>
<h3 id="health-checks"><a class="header" href="#health-checks">Health Checks</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/compose/compose-file/05-services/#healthcheck</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        ports:
            - '8000:8000'
        healthcheck:
            test: ['CMD', 'curl', '-f', 'http://localhost:8000/health']
            interval: 30s
            timeout: 10s
            retries: 3
            start_period: 40s

    db:
        image: postgres:15-alpine
        healthcheck:
            test: ['CMD-SHELL', 'pg_isready -U user -d mydb']
            interval: 10s
            timeout: 5s
            retries: 5
</code></pre>
<h3 id="depends-on-with-conditions"><a class="header" href="#depends-on-with-conditions">Depends On with Conditions</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/compose/compose-file/05-services/#depends_on</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        depends_on:
            db:
                condition: service_healthy
            redis:
                condition: service_started

    db:
        image: postgres:15-alpine
        healthcheck:
            test: ['CMD-SHELL', 'pg_isready']
            interval: 5s
            timeout: 5s
            retries: 5

    redis:
        image: redis:7-alpine
</code></pre>
<hr>
<h2 id="-networking"><a class="header" href="#-networking">🌐 Networking</a></h2>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/network/</p>
</blockquote>
<h3 id="network-commands"><a class="header" href="#network-commands">Network Commands</a></h3>
<blockquote>
<p>📖 <strong>CLI Docs:</strong> https://docs.docker.com/reference/cli/docker/network/</p>
</blockquote>
<pre><code class="language-bash"># List networks
docker network ls

# Create network
docker network create mynetwork

# Run container on network
docker run --network mynetwork myapp

# Connect container to network
docker network connect mynetwork my-container

# Disconnect from network
docker network disconnect mynetwork my-container

# Inspect network
docker network inspect mynetwork

# Remove network
docker network rm mynetwork
</code></pre>
<h3 id="network-drivers"><a class="header" href="#network-drivers">Network Drivers</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/engine/network/drivers</p>
</blockquote>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Driver</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><code>bridge</code></td><td>Default. Containers on same host communicate</td></tr>
<tr><td><code>host</code></td><td>Container uses host’s network directly</td></tr>
<tr><td><code>none</code></td><td>No networking</td></tr>
<tr><td><code>overlay</code></td><td>Multi-host networking (Swarm)</td></tr>
</tbody>
</table>
</div>
<h3 id="compose-networks"><a class="header" href="#compose-networks">Compose Networks</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/compose/networking/</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    frontend:
        build: ./frontend
        networks:
            - frontend-network

    backend:
        build: ./backend
        networks:
            - frontend-network
            - backend-network

    db:
        image: postgres:15
        networks:
            - backend-network

networks:
    frontend-network:
    backend-network:
</code></pre>
<hr>
<h2 id="-volumes"><a class="header" href="#-volumes">💾 Volumes</a></h2>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/storage/volumes/</p>
</blockquote>
<h3 id="volume-commands"><a class="header" href="#volume-commands">Volume Commands</a></h3>
<blockquote>
<p>📖 <strong>CLI Docs:</strong> https://docs.docker.com/reference/cli/docker/volume/</p>
</blockquote>
<pre><code class="language-bash"># List volumes
docker volume ls

# Create volume
docker volume create myvolume

# Run with volume
docker run -v myvolume:/data myapp

# Bind mount (host directory)
docker run -v $(pwd)/data:/app/data myapp

# Read-only mount
docker run -v $(pwd)/config:/app/config:ro myapp

# Inspect volume
docker volume inspect myvolume

# Remove volume
docker volume rm myvolume

# Remove unused volumes
docker volume prune
</code></pre>
<h3 id="volume-types"><a class="header" href="#volume-types">Volume Types</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/storage/</p>
</blockquote>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Type</th><th>Syntax</th><th>Use Case</th></tr>
</thead>
<tbody>
<tr><td>Named Volume</td><td><code>-v myvolume:/data</code></td><td>Persistent data</td></tr>
<tr><td>Bind Mount</td><td><code>-v $(pwd):/app</code></td><td>Development</td></tr>
<tr><td>tmpfs</td><td><code>--tmpfs /temp</code></td><td>Temporary data</td></tr>
</tbody>
</table>
</div>
<h3 id="compose-volumes"><a class="header" href="#compose-volumes">Compose Volumes</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/compose/compose-file/07-volumes/</p>
</blockquote>
<pre><code class="language-yaml">version: '3.8'

services:
    app:
        build: .
        volumes:
            # Named volume
            - app_data:/app/data

            # Bind mount
            - ./src:/app/src

            # Read-only bind mount
            - ./config:/app/config:ro

volumes:
    app_data:
</code></pre>
<hr>
<h2 id="-dockerignore"><a class="header" href="#-dockerignore">📁 .dockerignore</a></h2>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/reference/dockerfile/#dockerignore-file</p>
</blockquote>
<pre><code># Git
.git
.gitignore

# Python
__pycache__
*.pyc
*.pyo
venv/
.env

# Node
node_modules/
npm-debug.log

# IDE
.vscode/
.idea/

# OS
.DS_Store
Thumbs.db

# Docker
Dockerfile*
docker-compose*

# Docs
README.md
docs/

# Tests
tests/
*.test.js
</code></pre>
<hr>
<h2 id="-security-best-practices"><a class="header" href="#-security-best-practices">🔒 Security Best Practices</a></h2>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/develop/security-best-practices/</p>
</blockquote>
<h3 id="run-as-non-root-user"><a class="header" href="#run-as-non-root-user">Run as Non-Root User</a></h3>
<blockquote>
<p>📖 <strong>USER Docs:</strong> https://docs.docker.com/reference/dockerfile/#user</p>
</blockquote>
<pre><code class="language-dockerfile"># Create user
RUN useradd --create-home appuser

# Switch to user
USER appuser

# Copy files with correct ownership
COPY --chown=appuser:appuser . .
</code></pre>
<h3 id="use-specific-image-tags"><a class="header" href="#use-specific-image-tags">Use Specific Image Tags</a></h3>
<pre><code class="language-dockerfile"># ❌ Bad
FROM python:latest

# ✅ Good
FROM python:3.11.6-slim-bookworm
</code></pre>
<h3 id="scan-for-vulnerabilities"><a class="header" href="#scan-for-vulnerabilities">Scan for Vulnerabilities</a></h3>
<blockquote>
<p>📖 <strong>Docker Scout Docs:</strong> https://docs.docker.com/scout/</p>
</blockquote>
<pre><code class="language-bash"># Scan image
docker scout cves myapp

# Quick overview
docker scout quickview myapp
</code></pre>
<hr>
<h2 id="-best-practices"><a class="header" href="#-best-practices">🔧 Best Practices</a></h2>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/develop/develop-images/dockerfile_best-practices/</p>
</blockquote>
<h3 id="dockerfile"><a class="header" href="#dockerfile">Dockerfile</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>✅ Do</th><th>❌ Don’t</th></tr>
</thead>
<tbody>
<tr><td>Use specific image tags</td><td>Use <code>latest</code> tag</td></tr>
<tr><td>Use <code>.dockerignore</code></td><td>Copy unnecessary files</td></tr>
<tr><td>Order by change frequency</td><td>Random instruction order</td></tr>
<tr><td>Combine RUN commands</td><td>Multiple RUN for one task</td></tr>
<tr><td>Use multi-stage builds</td><td>Include build tools in prod</td></tr>
<tr><td>Run as non-root user</td><td>Run as root</td></tr>
<tr><td>Use <code>COPY</code> over <code>ADD</code></td><td>Use <code>ADD</code> unless needed</td></tr>
</tbody>
</table>
</div>
<h3 id="layer-caching-order"><a class="header" href="#layer-caching-order">Layer Caching Order</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/build/cache/</p>
</blockquote>
<pre><code class="language-dockerfile"># 1. Base image (rarely changes)
FROM python:3.11-slim

# 2. System dependencies (rarely changes)
RUN apt-get update &amp;&amp; apt-get install -y curl

# 3. App dependencies (sometimes changes)
COPY requirements.txt .
RUN pip install -r requirements.txt

# 4. Application code (frequently changes)
COPY . .

# 5. Runtime config
CMD ["python", "app.py"]
</code></pre>
<hr>
<h2 id="-quick-reference-card"><a class="header" href="#-quick-reference-card">🚀 Quick Reference Card</a></h2>
<h3 id="most-used-commands"><a class="header" href="#most-used-commands">Most Used Commands</a></h3>
<pre><code class="language-bash"># Build
docker build -t myapp .

# Run
docker run -d -p 8000:8000 --name myapp myapp

# Logs
docker logs -f myapp

# Shell access
docker exec -it myapp bash

# Stop &amp; Remove
docker stop myapp &amp;&amp; docker rm myapp

# Compose up
docker compose up -d --build

# Compose down
docker compose down -v

# Cleanup
docker system prune -a
</code></pre>
<h3 id="port-mapping"><a class="header" href="#port-mapping">Port Mapping</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/container/run/#publish</p>
</blockquote>
<pre><code>-p HOST:CONTAINER

-p 8000:8000     # localhost:8000 → container:8000
-p 3000:8000     # localhost:3000 → container:8000
-p 127.0.0.1:8000:8000  # Only localhost
</code></pre>
<h3 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h3>
<blockquote>
<p>📖 <strong>Docs:</strong> https://docs.docker.com/reference/cli/docker/container/run/#env</p>
</blockquote>
<pre><code class="language-bash"># Single variable
docker run -e MY_VAR=value myapp

# Multiple variables
docker run -e VAR1=a -e VAR2=b myapp

# From file
docker run --env-file .env myapp
</code></pre>
<hr>
<h2 id="-image-size-comparison"><a class="header" href="#-image-size-comparison">📊 Image Size Comparison</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Base Image</th><th>Size</th><th>Docs</th></tr>
</thead>
<tbody>
<tr><td><code>python:3.11</code></td><td>~900MB</td><td><a href="https://hub.docker.com/_/python">Link</a></td></tr>
<tr><td><code>python:3.11-slim</code></td><td>~120MB</td><td><a href="https://hub.docker.com/_/python">Link</a></td></tr>
<tr><td><code>python:3.11-alpine</code></td><td>~50MB</td><td><a href="https://hub.docker.com/_/python">Link</a></td></tr>
<tr><td><code>node:20</code></td><td>~1GB</td><td><a href="https://hub.docker.com/_/node">Link</a></td></tr>
<tr><td><code>node:20-slim</code></td><td>~200MB</td><td><a href="https://hub.docker.com/_/node">Link</a></td></tr>
<tr><td><code>node:20-alpine</code></td><td>~130MB</td><td><a href="https://hub.docker.com/_/node">Link</a></td></tr>
<tr><td><code>golang:1.21</code></td><td>~800MB</td><td><a href="https://hub.docker.com/_/golang">Link</a></td></tr>
<tr><td><code>golang:1.21-alpine</code></td><td>~250MB</td><td><a href="https://hub.docker.com/_/golang">Link</a></td></tr>
<tr><td><code>nginx:alpine</code></td><td>~40MB</td><td><a href="https://hub.docker.com/_/nginx">Link</a></td></tr>
<tr><td><code>scratch</code></td><td>0MB</td><td><a href="https://hub.docker.com/_/scratch">Link</a></td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="-additional-resources"><a class="header" href="#-additional-resources">📖 Additional Resources</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Resource</th><th>Link</th></tr>
</thead>
<tbody>
<tr><td>Docker Getting Started</td><td>https://docs.docker.com/get-started/</td></tr>
<tr><td>Docker Samples</td><td>https://docs.docker.com/samples/</td></tr>
<tr><td>Dockerfile Reference</td><td>https://docs.docker.com/reference/dockerfile/</td></tr>
<tr><td>Compose File Reference</td><td>https://docs.docker.com/compose/compose-file/</td></tr>
<tr><td>Docker CLI Reference</td><td>https://docs.docker.com/reference/cli/docker/</td></tr>
<tr><td>Awesome Docker</td><td>https://github.com/veggiemonk/awesome-docker</td></tr>
<tr><td>Docker Labs</td><td>https://github.com/docker/labs</td></tr>
<tr><td>Play with Docker</td><td>https://labs.play-with-docker.com/</td></tr>
<tr><td>Docker Curriculum</td><td>https://docker-curriculum.com/</td></tr>
</tbody>
</table>
</div>
<hr>
<p>Happy Dockerizing! 🐳</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="-kubernetes-cheatsheet"><a class="header" href="#-kubernetes-cheatsheet">🎯 Kubernetes Cheatsheet</a></h1>
<h2 id="1--namespace"><a class="header" href="#1--namespace">1. 📁 NAMESPACE</a></h2>
<h3 id="definition-8"><a class="header" href="#definition-8">Definition</a></h3>
<blockquote>
<p>Namespaces provide a mechanism for isolating groups of resources within a single cluster.</p>
</blockquote>
<h3 id="yaml-template"><a class="header" href="#yaml-template">YAML Template</a></h3>
<pre><code class="language-yaml">apiVersion: v1
kind: Namespace
metadata:
    name: my-app-dev # ⚠️ IMPORTANT: Use lowercase, no spaces
    labels:
        environment: dev # Optional: helps in filtering
</code></pre>
<h3 id="quick-commands"><a class="header" href="#quick-commands">Quick Commands</a></h3>
<pre><code class="language-bash"># Create namespace
kubectl create namespace my-app-dev

# List namespaces
kubectl get namespaces

# Set default namespace for context
kubectl config set-context --current --namespace=my-app-dev

# Delete namespace (⚠️ DELETES EVERYTHING INSIDE!)
kubectl delete namespace my-app-dev
</code></pre>
<h3 id="-consequences-of-wrong-configuration"><a class="header" href="#-consequences-of-wrong-configuration">⚠️ Consequences of Wrong Configuration</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Consequence</th></tr>
</thead>
<tbody>
<tr><td>Deleting namespace</td><td><strong>ALL resources inside are deleted permanently</strong></td></tr>
<tr><td>Wrong namespace in commands</td><td>Resources created in wrong place, confusion</td></tr>
<tr><td>No namespace specified</td><td>Goes to <code>default</code> namespace</td></tr>
</tbody>
</table>
</div>
<h3 id="-documentation"><a class="header" href="#-documentation">📚 Documentation</a></h3>
<ul>
<li>https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/</li>
</ul>
<hr>
<h2 id="2--pod"><a class="header" href="#2--pod">2. 🫛 POD</a></h2>
<h3 id="definition-1-1"><a class="header" href="#definition-1-1">Definition</a></h3>
<blockquote>
<p>The <strong>smallest deployable unit</strong> in Kubernetes. A pod wraps one or more containers. Think of it as a <strong>wrapper/box</strong> for your container.</p>
</blockquote>
<h3 id="yaml-template-1"><a class="header" href="#yaml-template-1">YAML Template</a></h3>
<pre><code class="language-yaml">apiVersion: v1
kind: Pod
metadata:
    name: my-pod # ⚠️ IMPORTANT: Unique name in namespace
    namespace: my-app-dev # ⚠️ IMPORTANT: Specify or uses 'default'
    labels:
        app: my-app # ⚠️ CRITICAL: Used by Services to find pods
        version: v1
spec:
    containers:
        - name: my-container # ⚠️ IMPORTANT: Container name
          image: nginx:1.21 # ⚠️ CRITICAL: Image name and tag
          ports:
              - containerPort: 80 # ⚠️ IMPORTANT: Port your app listens on
          resources: # ⚠️ RECOMMENDED: Set limits
              requests:
                  memory: '64Mi'
                  cpu: '250m'
              limits:
                  memory: '128Mi'
                  cpu: '500m'
    restartPolicy: Always # Always | OnFailure | Never
</code></pre>
<h3 id="quick-commands-1"><a class="header" href="#quick-commands-1">Quick Commands</a></h3>
<pre><code class="language-bash"># Create pod
kubectl apply -f pod.yaml

# List pods
kubectl get pods -n my-app-dev

# Describe pod (see events, errors)
kubectl describe pod my-pod -n my-app-dev

# Get pod logs
kubectl logs my-pod -n my-app-dev

# Execute command in pod
kubectl exec -it my-pod -n my-app-dev -- /bin/bash

# Delete pod
kubectl delete pod my-pod -n my-app-dev
</code></pre>
<h3 id="-consequences-of-wrong-configuration-1"><a class="header" href="#-consequences-of-wrong-configuration-1">⚠️ Consequences of Wrong Configuration</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Consequence</th></tr>
</thead>
<tbody>
<tr><td>Wrong image name/tag</td><td><code>ImagePullBackOff</code> error, pod won’t start</td></tr>
<tr><td>Wrong containerPort</td><td>App unreachable, connection refused</td></tr>
<tr><td>No resource limits</td><td>Pod can consume all node resources, crash other pods</td></tr>
<tr><td>Missing labels</td><td>Services can’t find the pod</td></tr>
<tr><td>Wrong namespace</td><td>Pod created in wrong namespace</td></tr>
</tbody>
</table>
</div>
<h3 id="-documentation-1"><a class="header" href="#-documentation-1">📚 Documentation</a></h3>
<ul>
<li>https://kubernetes.io/docs/concepts/workloads/pods/</li>
</ul>
<hr>
<h2 id="3--deployment"><a class="header" href="#3--deployment">3. 🚀 DEPLOYMENT</a></h2>
<h3 id="definition-2-1"><a class="header" href="#definition-2-1">Definition</a></h3>
<blockquote>
<p>Manages <strong>multiple copies (replicas)</strong> of your pod and handles <strong>updates/rollbacks</strong>. Think of it as a
<strong>pod manager</strong> that ensures your desired number of pods are always running.</p>
</blockquote>
<h3 id="yaml-template-2"><a class="header" href="#yaml-template-2">YAML Template</a></h3>
<pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
    name: my-deployment
    namespace: my-app-dev
    labels:
        app: my-app
spec:
    replicas: 3 # ⚠️ IMPORTANT: Number of pod copies

    selector: # ⚠️ CRITICAL: Must match template labels
        matchLabels:
            app: my-app

    strategy: # ⚠️ IMPORTANT: How updates happen
        type: RollingUpdate # RollingUpdate | Recreate
        rollingUpdate:
            maxSurge: 1 # Extra pods during update
            maxUnavailable: 0 # Pods that can be unavailable

    template: # ⚠️ CRITICAL: Pod template
        metadata:
            labels:
                app: my-app # ⚠️ MUST match selector.matchLabels
        spec:
            containers:
                - name: my-app
                  image: nginx:1.21 # ⚠️ CRITICAL: Your app image
                  ports:
                      - containerPort: 80
                  resources:
                      requests:
                          memory: '64Mi'
                          cpu: '250m'
                      limits:
                          memory: '128Mi'
                          cpu: '500m'

                  livenessProbe: # ⚠️ RECOMMENDED: Restart if unhealthy
                      httpGet:
                          path: /health
                          port: 80
                      initialDelaySeconds: 30
                      periodSeconds: 10

                  readinessProbe: # ⚠️ RECOMMENDED: Traffic only when ready
                      httpGet:
                          path: /ready
                          port: 80
                      initialDelaySeconds: 5
                      periodSeconds: 5
</code></pre>
<h3 id="quick-commands-2"><a class="header" href="#quick-commands-2">Quick Commands</a></h3>
<pre><code class="language-bash"># Create/Update deployment
kubectl apply -f deployment.yaml

# List deployments
kubectl get deployments -n my-app-dev

# Watch deployment status
kubectl rollout status deployment/my-deployment -n my-app-dev

# Scale deployment
kubectl scale deployment my-deployment --replicas=5 -n my-app-dev

# Update image (triggers rolling update)
kubectl set image deployment/my-deployment my-app=nginx:1.22 -n my-app-dev

# Rollback to previous version
kubectl rollout undo deployment/my-deployment -n my-app-dev

# See rollout history
kubectl rollout history deployment/my-deployment -n my-app-dev

# Delete deployment
kubectl delete deployment my-deployment -n my-app-dev
</code></pre>
<h3 id="-consequences-of-wrong-configuration-2"><a class="header" href="#-consequences-of-wrong-configuration-2">⚠️ Consequences of Wrong Configuration</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Consequence</th></tr>
</thead>
<tbody>
<tr><td><code>selector.matchLabels</code> ≠ <code>template.labels</code></td><td>Deployment won’t find its pods, error</td></tr>
<tr><td><code>replicas: 0</code></td><td>No pods running, app is down</td></tr>
<tr><td>Wrong liveness probe</td><td>Pods keep restarting (CrashLoopBackOff)</td></tr>
<tr><td>Wrong readiness probe</td><td>No traffic sent to pods</td></tr>
<tr><td>No resource limits</td><td>Resource starvation</td></tr>
<tr><td><code>strategy: Recreate</code></td><td>Downtime during updates</td></tr>
</tbody>
</table>
</div>
<h3 id="-documentation-2"><a class="header" href="#-documentation-2">📚 Documentation</a></h3>
<ul>
<li>https://kubernetes.io/docs/concepts/workloads/controllers/deployment/</li>
</ul>
<hr>
<h2 id="4--services"><a class="header" href="#4--services">4. 🌐 SERVICES</a></h2>
<h3 id="definition-3-1"><a class="header" href="#definition-3-1">Definition</a></h3>
<blockquote>
<p>A <strong>stable network endpoint</strong> to access your pods. Pods can die and restart with new IPs,
but Service IP stays the same. Think of it as a <strong>load balancer + DNS name</strong> for your pods.</p>
</blockquote>
<hr>
<h3 id="41-clusterip-default"><a class="header" href="#41-clusterip-default">4.1 ClusterIP (Default)</a></h3>
<p><strong>What it does:</strong>
Creates an internal IP address that’s <strong>only accessible from within the cluster</strong>. Other pods can
reach your service, but nothing outside the cluster can.</p>
<p><strong>How it works:</strong></p>
<pre><code>[Pod A] --&gt; [ClusterIP: 10.96.50.100] --&gt; [Your Pod B]
              (internal IP)
</code></pre>
<p><strong>Real-world analogy:</strong>
Like an internal office phone extension - employees can call each other, but external clients can’t dial extensions directly.</p>
<p><strong>When to use:</strong></p>
<ul>
<li>Backend services (databases, caches, internal APIs)</li>
<li>Microservice-to-microservice communication</li>
<li>Services that should NOT be exposed externally</li>
</ul>
<pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
    name: my-service-clusterip
    namespace: my-app-dev
spec:
    type: ClusterIP # ⚠️ Default type (can omit)

    selector: # ⚠️ CRITICAL: Must match pod labels
        app: my-app

    ports:
        - name: http # ⚠️ RECOMMENDED: Name your ports
          protocol: TCP
          port: 80 # ⚠️ IMPORTANT: Service port (what you call)
          targetPort: 80 # ⚠️ IMPORTANT: Pod port (where it goes)
</code></pre>
<p><strong>Access within cluster:</strong></p>
<pre><code class="language-bash"># From another pod
curl http://my-service-clusterip.my-app-dev.svc.cluster.local:80

# Short form (same namespace)
curl http://my-service-clusterip:80
</code></pre>
<hr>
<h3 id="42-nodeport"><a class="header" href="#42-nodeport">4.2 NodePort</a></h3>
<p><strong>What it does:</strong>
Opens a <strong>specific port (30000-32767) on every node</strong> in your cluster. External
traffic hitting any node’s IP on that port gets routed to your pods.</p>
<p><strong>How it works:</strong></p>
<pre><code>[External User] --&gt; [Any Node IP:30080] --&gt; [ClusterIP] --&gt; [Your Pods]
                         ↓
                    Node1:30080
                    Node2:30080  (same port on ALL nodes)
                    Node3:30080
</code></pre>
<p><strong>Real-world analogy:</strong>
Like having the same extension number work at every office branch - call any branch at extension 30080, and you’ll reach the same department.</p>
<p><strong>When to use:</strong></p>
<ul>
<li>Development/testing environments</li>
<li>On-premise clusters without cloud load balancers</li>
<li>When you need quick external access without Ingress setup</li>
</ul>
<p><strong>⚠️ Limitations:</strong></p>
<ul>
<li>Port range restricted to 30000-32767</li>
<li>Need to know node IPs</li>
<li>If a node goes down, that IP stops working (no automatic failover)</li>
</ul>
<pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
    name: my-service-nodeport
    namespace: my-app-dev
spec:
    type: NodePort # ⚠️ IMPORTANT: Exposes on node

    selector:
        app: my-app

    ports:
        - name: http
          protocol: TCP
          port: 80 # ClusterIP port
          targetPort: 80 # Pod port
          nodePort: 30080 # ⚠️ IMPORTANT: 30000-32767 range
</code></pre>
<p><strong>Access:</strong></p>
<pre><code class="language-bash"># From outside cluster
curl http://&lt;NODE-IP&gt;:30080
</code></pre>
<hr>
<h3 id="43-loadbalancer"><a class="header" href="#43-loadbalancer">4.3 LoadBalancer</a></h3>
<p><strong>What it does:</strong>
Provisions an <strong>external load balancer from your cloud provider</strong> (AWS ELB, GCP LB, Azure LB).
You get a single external IP/DNS that distributes traffic across your nodes.</p>
<p><strong>How it works:</strong></p>
<pre><code>[External User] --&gt; [Cloud LB: 52.1.2.3] --&gt; [NodePort] --&gt; [ClusterIP] --&gt; [Pods]
                    (external IP)              (auto-created)  (auto-created)
</code></pre>
<p><strong>Real-world analogy:</strong>
Like a company’s main phone number with a receptionist - one public number that
routes calls to the right department, handles busy lines, and keeps working even if one office is closed.</p>
<p><strong>When to use:</strong></p>
<ul>
<li>Production workloads in cloud environments</li>
<li>When you need a stable external IP</li>
<li>High-availability requirements</li>
</ul>
<pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
    name: my-service-lb
    namespace: my-app-dev
    annotations: # ⚠️ Cloud-specific annotations
        # AWS example:
        service.beta.kubernetes.io/aws-load-balancer-type: 'nlb'
spec:
    type: LoadBalancer # ⚠️ IMPORTANT: Creates cloud LB

    selector:
        app: my-app

    ports:
        - name: http
          protocol: TCP
          port: 80
          targetPort: 80
</code></pre>
<p><strong>Access:</strong></p>
<pre><code class="language-bash"># Get external IP
kubectl get svc my-service-lb -n my-app-dev

# Access via external IP
curl http://&lt;EXTERNAL-IP&gt;:80
</code></pre>
<hr>
<h3 id="quick-commands-3"><a class="header" href="#quick-commands-3">Quick Commands</a></h3>
<pre><code class="language-bash"># Create service
kubectl apply -f service.yaml

# List services
kubectl get svc -n my-app-dev

# Describe service (see endpoints)
kubectl describe svc my-service -n my-app-dev

# Get endpoints (pods behind service)
kubectl get endpoints my-service -n my-app-dev

# Delete service
kubectl delete svc my-service -n my-app-dev
</code></pre>
<h3 id="-consequences-of-wrong-configuration-3"><a class="header" href="#-consequences-of-wrong-configuration-3">⚠️ Consequences of Wrong Configuration</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Consequence</th></tr>
</thead>
<tbody>
<tr><td><code>selector</code> doesn’t match pod labels</td><td>Service has no endpoints, connection refused</td></tr>
<tr><td>Wrong <code>targetPort</code></td><td>Traffic sent to wrong port on pod</td></tr>
<tr><td><code>nodePort</code> outside 30000-32767</td><td>Error, service won’t create</td></tr>
<tr><td>LoadBalancer without cloud provider</td><td>Stays in “Pending” state forever</td></tr>
<tr><td>Missing port name (multi-port)</td><td>Ambiguous port reference</td></tr>
</tbody>
</table>
</div>
<h3 id="service-type-comparison"><a class="header" href="#service-type-comparison">Service Type Comparison</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Type</th><th>Access</th><th>Use Case</th></tr>
</thead>
<tbody>
<tr><td>ClusterIP</td><td>Internal only</td><td>Microservice-to-microservice</td></tr>
<tr><td>NodePort</td><td>Node IP:30000+</td><td>Dev/testing, on-prem</td></tr>
<tr><td>LoadBalancer</td><td>External IP</td><td>Production, cloud</td></tr>
</tbody>
</table>
</div>
<h3 id="-documentation-3"><a class="header" href="#-documentation-3">📚 Documentation</a></h3>
<ul>
<li>https://kubernetes.io/docs/concepts/services-networking/service/</li>
</ul>
<hr>
<h2 id="5--configmaps--secrets"><a class="header" href="#5--configmaps--secrets">5. ⚙️ CONFIGMAPS &amp; SECRETS</a></h2>
<h3 id="definition-4-1"><a class="header" href="#definition-4-1">Definition</a></h3>
<blockquote>
<p><strong>ConfigMap</strong>: Store non-sensitive configuration data (settings, config files).
<strong>Secret</strong>: Store sensitive data (passwords, tokens, keys) - base64 encoded.</p>
</blockquote>
<p>Think of them as <strong>external configuration</strong> that you inject into pods.</p>
<hr>
<h3 id="51-configmap---environment-variables"><a class="header" href="#51-configmap---environment-variables">5.1 ConfigMap - Environment Variables</a></h3>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
    name: my-config
    namespace: my-app-dev
data: # ⚠️ Key-value pairs
    DATABASE_HOST: 'mysql.database.svc'
    DATABASE_PORT: '3306'
    LOG_LEVEL: 'info'
</code></pre>
<p><strong>Use in Deployment:</strong></p>
<pre><code class="language-yaml">spec:
    containers:
        - name: my-app
          image: my-app:v1

          # Option 1: Single env var
          env:
              - name: DB_HOST
                valueFrom:
                    configMapKeyRef:
                        name: my-config # ⚠️ ConfigMap name
                        key: DATABASE_HOST # ⚠️ Key from ConfigMap

          # Option 2: All keys as env vars
          envFrom:
              - configMapRef:
                    name: my-config # ⚠️ All keys become env vars
</code></pre>
<hr>
<h3 id="52-configmap---file-based"><a class="header" href="#52-configmap---file-based">5.2 ConfigMap - File Based</a></h3>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
    name: my-config-file
    namespace: my-app-dev
data:
    nginx.conf: | # ⚠️ File name as key
        server {
            listen 80;
            server_name localhost;
            location / {
                root /usr/share/nginx/html;
            }
        }

    app.properties: |
        database.url=jdbc:mysql://localhost:3306/mydb
        cache.enabled=true
</code></pre>
<p><strong>Mount as Volume:</strong></p>
<pre><code class="language-yaml">spec:
    containers:
        - name: my-app
          image: nginx:1.21
          volumeMounts:
              - name: config-volume
                mountPath: /etc/nginx/conf.d # ⚠️ Where files appear
                readOnly: true

    volumes:
        - name: config-volume
          configMap:
              name: my-config-file # ⚠️ ConfigMap name
</code></pre>
<hr>
<h3 id="53-secret---environment-variables"><a class="header" href="#53-secret---environment-variables">5.3 Secret - Environment Variables</a></h3>
<pre><code class="language-yaml">apiVersion: v1
kind: Secret
metadata:
    name: my-secret
    namespace: my-app-dev
type: Opaque # ⚠️ Generic secret type
data: # ⚠️ Base64 encoded values
    DB_PASSWORD: cGFzc3dvcmQxMjM= # echo -n "password123" | base64
    API_KEY: c2VjcmV0a2V5MTIz

# Or use stringData (plain text, auto-encoded)
stringData: # ⚠️ Plain text (easier)
    DB_PASSWORD: password123
    API_KEY: secretkey123
</code></pre>
<p><strong>Use in Deployment:</strong></p>
<pre><code class="language-yaml">spec:
    containers:
        - name: my-app
          image: my-app:v1

          env:
              - name: DATABASE_PASSWORD
                valueFrom:
                    secretKeyRef:
                        name: my-secret # ⚠️ Secret name
                        key: DB_PASSWORD # ⚠️ Key from Secret

          # Or all secrets as env vars
          envFrom:
              - secretRef:
                    name: my-secret
</code></pre>
<hr>
<h3 id="54-secret---file-based"><a class="header" href="#54-secret---file-based">5.4 Secret - File Based</a></h3>
<pre><code class="language-yaml">apiVersion: v1
kind: Secret
metadata:
    name: tls-secret
    namespace: my-app-dev
type: kubernetes.io/tls # ⚠️ TLS secret type
data:
    tls.crt: &lt;base64-encoded-cert&gt;
    tls.key: &lt;base64-encoded-key&gt;
</code></pre>
<p><strong>Mount as Volume:</strong></p>
<pre><code class="language-yaml">spec:
    containers:
        - name: my-app
          image: my-app:v1
          volumeMounts:
              - name: secret-volume
                mountPath: /etc/ssl/certs # ⚠️ Where files appear
                readOnly: true

    volumes:
        - name: secret-volume
          secret:
              secretName: tls-secret # ⚠️ Secret name
</code></pre>
<hr>
<h3 id="quick-commands-4"><a class="header" href="#quick-commands-4">Quick Commands</a></h3>
<pre><code class="language-bash"># Create ConfigMap from literal
kubectl create configmap my-config \
  --from-literal=KEY1=value1 \
  --from-literal=KEY2=value2 \
  -n my-app-dev

# Create ConfigMap from file
kubectl create configmap my-config \
  --from-file=config.properties \
  -n my-app-dev

# Create Secret from literal
kubectl create secret generic my-secret \
  --from-literal=password=secret123 \
  -n my-app-dev

# Create Secret from file
kubectl create secret generic my-secret \
  --from-file=credentials.json \
  -n my-app-dev

# Create TLS Secret
kubectl create secret tls tls-secret \
  --cert=path/to/tls.crt \
  --key=path/to/tls.key \
  -n my-app-dev

# View ConfigMap
kubectl get configmap my-config -o yaml -n my-app-dev

# View Secret (decoded)
kubectl get secret my-secret -o jsonpath='{.data.password}' | base64 -d
</code></pre>
<h3 id="-consequences-of-wrong-configuration-4"><a class="header" href="#-consequences-of-wrong-configuration-4">⚠️ Consequences of Wrong Configuration</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Consequence</th></tr>
</thead>
<tbody>
<tr><td>Wrong ConfigMap/Secret name in pod</td><td>Pod fails to start, <code>CreateContainerConfigError</code></td></tr>
<tr><td>Wrong key name</td><td>Env var not set or file missing</td></tr>
<tr><td>Secret not base64 encoded (in <code>data</code>)</td><td>Invalid secret, pod error</td></tr>
<tr><td>ConfigMap/Secret in different namespace</td><td>Not found, pod fails</td></tr>
<tr><td>Updating ConfigMap (env-based)</td><td><strong>Pods don’t auto-update</strong>, need restart</td></tr>
<tr><td>Updating ConfigMap (volume-based)</td><td>Auto-updates (with delay), no restart needed</td></tr>
</tbody>
</table>
</div>
<h3 id="-documentation-4"><a class="header" href="#-documentation-4">📚 Documentation</a></h3>
<ul>
<li>https://kubernetes.io/docs/concepts/configuration/configmap/</li>
<li>https://kubernetes.io/docs/concepts/configuration/secret/</li>
</ul>
<hr>
<h2 id="6--ingress"><a class="header" href="#6--ingress">6. 🚪 INGRESS</a></h2>
<h3 id="definition-5-1"><a class="header" href="#definition-5-1">Definition</a></h3>
<blockquote>
<p><strong>HTTP/HTTPS router</strong> that routes external traffic to your services based on hostname or path. Think of it as a <strong>smart reverse proxy</strong> with SSL termination.</p>
</blockquote>
<blockquote>
<p>⚠️ <strong>Requires an Ingress Controller</strong> (nginx, traefik, etc.) installed in cluster!</p>
</blockquote>
<h3 id="yaml-template-3"><a class="header" href="#yaml-template-3">YAML Template</a></h3>
<pre><code class="language-yaml">apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
    name: my-ingress
    namespace: my-app-dev
    annotations: # ⚠️ Controller-specific settings
        # For NGINX Ingress Controller
        nginx.ingress.kubernetes.io/rewrite-target: /
        nginx.ingress.kubernetes.io/ssl-redirect: 'true'

        # Rate limiting
        nginx.ingress.kubernetes.io/limit-rps: '10'

        # For cert-manager (auto TLS)
        cert-manager.io/cluster-issuer: 'letsencrypt-prod'

spec:
    ingressClassName: nginx # ⚠️ IMPORTANT: Which controller to use

    tls: # ⚠️ HTTPS configuration
        - hosts:
              - myapp.example.com
              - api.example.com
          secretName: tls-secret # ⚠️ TLS cert secret

    rules:
        # Host-based routing
        - host: myapp.example.com # ⚠️ IMPORTANT: Domain name
          http:
              paths:
                  - path: / # ⚠️ URL path
                    pathType: Prefix # Prefix | Exact | ImplementationSpecific
                    backend:
                        service:
                            name: frontend-service # ⚠️ CRITICAL: Service name
                            port:
                                number: 80 # ⚠️ CRITICAL: Service port

        # Path-based routing
        - host: api.example.com
          http:
              paths:
                  - path: /v1
                    pathType: Prefix
                    backend:
                        service:
                            name: api-v1-service
                            port:
                                number: 80

                  - path: /v2
                    pathType: Prefix
                    backend:
                        service:
                            name: api-v2-service
                            port:
                                number: 80
</code></pre>
<h3 id="quick-commands-5"><a class="header" href="#quick-commands-5">Quick Commands</a></h3>
<pre><code class="language-bash"># Install NGINX Ingress Controller (if not installed)
kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.8.1/deploy/static/provider/cloud/deploy.yaml

# Create ingress
kubectl apply -f ingress.yaml

# List ingresses
kubectl get ingress -n my-app-dev

# Describe ingress
kubectl describe ingress my-ingress -n my-app-dev

# Get ingress controller external IP
kubectl get svc -n ingress-nginx

# Delete ingress
kubectl delete ingress my-ingress -n my-app-dev
</code></pre>
<h3 id="-consequences-of-wrong-configuration-5"><a class="header" href="#-consequences-of-wrong-configuration-5">⚠️ Consequences of Wrong Configuration</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Consequence</th></tr>
</thead>
<tbody>
<tr><td>No Ingress Controller installed</td><td>Ingress does nothing</td></tr>
<tr><td>Wrong <code>ingressClassName</code></td><td>Ingress ignored by controller</td></tr>
<tr><td>Wrong service name</td><td>502 Bad Gateway</td></tr>
<tr><td>Wrong service port</td><td>502 Bad Gateway</td></tr>
<tr><td>Service in different namespace</td><td>Not found, 503 error</td></tr>
<tr><td>Wrong TLS secret name</td><td>HTTPS fails, SSL error</td></tr>
<tr><td>Invalid host (no DNS)</td><td>Cannot reach the site</td></tr>
</tbody>
</table>
</div>
<h3 id="-documentation-5"><a class="header" href="#-documentation-5">📚 Documentation</a></h3>
<ul>
<li>https://kubernetes.io/docs/concepts/services-networking/ingress/</li>
<li>https://kubernetes.github.io/ingress-nginx/</li>
</ul>
<hr>
<h2 id="7--helm"><a class="header" href="#7--helm">7. ⎈ HELM</a></h2>
<h3 id="definition-6-1"><a class="header" href="#definition-6-1">Definition</a></h3>
<blockquote>
<p><strong>Package manager for Kubernetes</strong> - like apt/yum for Linux. Uses <strong>Charts</strong> (pre-configured templates) to install complex applications. Think of it as <strong>installing apps with one command</strong>.</p>
</blockquote>
<h3 id="directory-structure"><a class="header" href="#directory-structure">Directory Structure</a></h3>
<pre><code>my-chart/
├── Chart.yaml          # Chart metadata
├── values.yaml         # Default configuration
├── charts/             # Dependencies
└── templates/          # Kubernetes YAML templates
    ├── deployment.yaml
    ├── service.yaml
    ├── ingress.yaml
    ├── configmap.yaml
    ├── _helpers.tpl    # Template helpers
    └── NOTES.txt       # Post-install notes
</code></pre>
<h3 id="chartyaml"><a class="header" href="#chartyaml">Chart.yaml</a></h3>
<pre><code class="language-yaml">apiVersion: v2 # ⚠️ v2 for Helm 3
name: my-app # ⚠️ IMPORTANT: Chart name
description: My application chart
type: application # application | library
version: 1.0.0 # ⚠️ IMPORTANT: Chart version
appVersion: '1.0.0' # App version (displayed)

dependencies: # Optional: Sub-charts
    - name: postgresql
      version: '12.1.0'
      repository: 'https://charts.bitnami.com/bitnami'
      condition: postgresql.enabled
</code></pre>
<h3 id="valuesyaml"><a class="header" href="#valuesyaml">values.yaml</a></h3>
<pre><code class="language-yaml"># ⚠️ These values can be overridden during install
replicaCount: 3

image:
    repository: nginx
    tag: '1.21'
    pullPolicy: IfNotPresent

service:
    type: ClusterIP
    port: 80

ingress:
    enabled: true
    className: nginx
    host: myapp.example.com

resources:
    limits:
        cpu: 500m
        memory: 128Mi
    requests:
        cpu: 250m
        memory: 64Mi

# Feature flags
postgresql:
    enabled: true
</code></pre>
<h3 id="templatesdeploymentyaml-example"><a class="header" href="#templatesdeploymentyaml-example">templates/deployment.yaml (Example)</a></h3>
<pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
    name: { { include "my-app.fullname" . } } # ⚠️ Helm templating
    labels: { { - include "my-app.labels" . | nindent 4 } }
spec:
    replicas: { { .Values.replicaCount } } # ⚠️ From values.yaml
    selector:
        matchLabels: { { - include "my-app.selectorLabels" . | nindent 6 } }
    template:
        metadata:
            labels: { { - include "my-app.selectorLabels" . | nindent 8 } }
        spec:
            containers:
                - name: { { .Chart.Name } }
                  image: '{{ .Values.image.repository }}:{{ .Values.image.tag }}'
                  imagePullPolicy: { { .Values.image.pullPolicy } }
                  ports:
                      - containerPort: 80
                  resources: { { - toYaml .Values.resources | nindent 12 } }
</code></pre>
<h3 id="quick-commands-6"><a class="header" href="#quick-commands-6">Quick Commands</a></h3>
<pre><code class="language-bash"># ===== REPO MANAGEMENT =====
# Add repository
helm repo add bitnami https://charts.bitnami.com/bitnami

# Update repositories
helm repo update

# Search charts
helm search repo nginx

# ===== INSTALL/UPGRADE =====
# Install chart
helm install my-release bitnami/nginx -n my-namespace

# Install with custom values
helm install my-release bitnami/nginx \
  -f custom-values.yaml \
  -n my-namespace

# Install with inline values
helm install my-release bitnami/nginx \
  --set replicaCount=3 \
  --set service.type=LoadBalancer \
  -n my-namespace

# Upgrade release
helm upgrade my-release bitnami/nginx \
  -f updated-values.yaml \
  -n my-namespace

# Install or upgrade (if exists)
helm upgrade --install my-release bitnami/nginx \
  -f values.yaml \
  -n my-namespace

# ===== INSPECT =====
# List releases
helm list -n my-namespace

# Get release status
helm status my-release -n my-namespace

# Get values used
helm get values my-release -n my-namespace

# Get all manifests
helm get manifest my-release -n my-namespace

# Show chart values
helm show values bitnami/nginx

# ===== ROLLBACK =====
# List history
helm history my-release -n my-namespace

# Rollback to previous
helm rollback my-release -n my-namespace

# Rollback to specific revision
helm rollback my-release 2 -n my-namespace

# ===== DELETE =====
# Uninstall
helm uninstall my-release -n my-namespace

# ===== DEVELOPMENT =====
# Create new chart
helm create my-chart

# Lint chart
helm lint ./my-chart

# Dry-run (preview what will be created)
helm install my-release ./my-chart --dry-run --debug

# Template locally (see rendered YAML)
helm template my-release ./my-chart -f values.yaml
</code></pre>
<h3 id="-consequences-of-wrong-configuration-6"><a class="header" href="#-consequences-of-wrong-configuration-6">⚠️ Consequences of Wrong Configuration</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Consequence</th></tr>
</thead>
<tbody>
<tr><td>Wrong values.yaml syntax</td><td>Helm install fails</td></tr>
<tr><td>Template syntax error</td><td><code>helm install</code> fails with error</td></tr>
<tr><td>Missing required values</td><td>Empty/null values, app misconfigured</td></tr>
<tr><td>Wrong chart version</td><td>Incompatible features, errors</td></tr>
<tr><td>No <code>--namespace</code> flag</td><td>Installs in default namespace</td></tr>
<tr><td>Deleting release</td><td>All resources deleted</td></tr>
</tbody>
</table>
</div>
<h3 id="-documentation-6"><a class="header" href="#-documentation-6">📚 Documentation</a></h3>
<ul>
<li>https://helm.sh/docs/</li>
<li>https://artifacthub.io/ (Find charts)</li>
</ul>
<hr>
<h2 id="8--kustomize"><a class="header" href="#8--kustomize">8. 🔧 KUSTOMIZE</a></h2>
<h3 id="definition-7-1"><a class="header" href="#definition-7-1">Definition</a></h3>
<blockquote>
<p><strong>Kustomize</strong> lets you customize Kubernetes YAML files <strong>without modifying the originals</strong>.
You define a “base” configuration and then create “overlays” that patch specific values for different environments.</p>
</blockquote>
<p><strong>The Problem It Solves:</strong></p>
<p>Without Kustomize, you’d either:</p>
<ol>
<li>Copy-paste YAML files for each environment (dev, staging, prod) → maintenance nightmare</li>
<li>Use complex templating with placeholders → harder to read and validate</li>
</ol>
<p><strong>Kustomize Approach:</strong></p>
<pre><code>Base YAML (shared)     +     Overlay (env-specific patches)     =     Final YAML
───────────────────          ────────────────────────────            ────────────
replicas: 1                  replicas: 5                             replicas: 5
image: app:latest            image: app:v1.2.3                       image: app:v1.2.3
memory: 64Mi                 memory: 512Mi                           memory: 512Mi
</code></pre>
<p><strong>Key Concepts:</strong></p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Term</th><th>Meaning</th></tr>
</thead>
<tbody>
<tr><td><strong>Base</strong></td><td>Original YAML files - the “template” that’s shared across environments</td></tr>
<tr><td><strong>Overlay</strong></td><td>Environment-specific folder that references base and applies patches</td></tr>
<tr><td><strong>Patch</strong></td><td>A partial YAML that specifies only what to change</td></tr>
<tr><td><strong>Kustomization</strong></td><td>The <code>kustomization.yaml</code> file that tells Kustomize what to include and how to modify</td></tr>
</tbody>
</table>
</div>
<p><strong>How it works mentally:</strong></p>
<pre><code>1. Start with base/deployment.yaml (replicas: 1)
2. Apply overlays/prod/patch.yaml (replicas: 5)
3. Kustomize MERGES them → final deployment has replicas: 5
4. Everything else from base stays unchanged
</code></pre>
<p><strong>Real-world analogy:</strong>
Like a restaurant franchise - there’s a base menu (same across all locations), but each location can add local specials or adjust prices (overlays) without rewriting the entire menu.</p>
<h3 id="directory-structure-1"><a class="header" href="#directory-structure-1">Directory Structure</a></h3>
<pre><code>my-app/
├── base/                       # ⚠️ Base configuration (shared)
│   ├── kustomization.yaml
│   ├── deployment.yaml
│   ├── service.yaml
│   └── configmap.yaml
│
└── overlays/                   # ⚠️ Environment-specific changes
    ├── dev/
    │   ├── kustomization.yaml
    │   ├── replica-patch.yaml
    │   └── configmap.yaml
    │
    ├── staging/
    │   ├── kustomization.yaml
    │   └── namespace.yaml
    │
    └── prod/
        ├── kustomization.yaml
        ├── replica-patch.yaml
        └── resources-patch.yaml
</code></pre>
<h3 id="basekustomizationyaml"><a class="header" href="#basekustomizationyaml">base/kustomization.yaml</a></h3>
<pre><code class="language-yaml">apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# ⚠️ Resources to include
resources:
    - deployment.yaml
    - service.yaml
    - configmap.yaml

# Common labels added to all resources
commonLabels:
    app: my-app

# Common annotations
commonAnnotations:
    managed-by: kustomize
# Namespace (optional in base)
# namespace: my-app
</code></pre>
<h3 id="basedeploymentyaml"><a class="header" href="#basedeploymentyaml">base/deployment.yaml</a></h3>
<pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
    name: my-app
spec:
    replicas: 1 # Base replica count
    selector:
        matchLabels:
            app: my-app
    template:
        metadata:
            labels:
                app: my-app
        spec:
            containers:
                - name: my-app
                  image: my-app:latest
                  ports:
                      - containerPort: 80
                  resources:
                      requests:
                          memory: '64Mi'
                          cpu: '100m'
</code></pre>
<h3 id="overlaysprodkustomizationyaml"><a class="header" href="#overlaysprodkustomizationyaml">overlays/prod/kustomization.yaml</a></h3>
<pre><code class="language-yaml">apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# ⚠️ Reference base configuration
resources:
    - ../../base

# ⚠️ Set namespace for all resources
namespace: production

# ⚠️ Prefix/Suffix for resource names
namePrefix: prod-
# nameSuffix: -v1

# ⚠️ Image overrides
images:
    - name: my-app
      newName: my-registry/my-app
      newTag: v1.2.3

# ⚠️ Patches to modify resources
patches:
    # Inline patch
    - patch: |-
          - op: replace
            path: /spec/replicas
            value: 5
      target:
          kind: Deployment
          name: my-app

    # File-based patch
    - path: resources-patch.yaml
      target:
          kind: Deployment
          name: my-app

# ⚠️ Strategic merge patch
patchesStrategicMerge:
    - replica-patch.yaml

# ⚠️ ConfigMap generator
configMapGenerator:
    - name: my-config
      literals:
          - ENVIRONMENT=production
          - LOG_LEVEL=warn
      files:
          - config.properties

# ⚠️ Secret generator
secretGenerator:
    - name: my-secret
      literals:
          - password=prodpassword123
</code></pre>
<h3 id="overlaysprodreplica-patchyaml"><a class="header" href="#overlaysprodreplica-patchyaml">overlays/prod/replica-patch.yaml</a></h3>
<pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
    name: my-app # ⚠️ Must match base resource name
spec:
    replicas: 5 # ⚠️ Override replicas
</code></pre>
<h3 id="overlaysprodresources-patchyaml"><a class="header" href="#overlaysprodresources-patchyaml">overlays/prod/resources-patch.yaml</a></h3>
<pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
    name: my-app
spec:
    template:
        spec:
            containers:
                - name: my-app # ⚠️ Must match container name
                  resources:
                      requests:
                          memory: '256Mi'
                          cpu: '500m'
                      limits:
                          memory: '512Mi'
                          cpu: '1000m'
</code></pre>
<h3 id="quick-commands-7"><a class="header" href="#quick-commands-7">Quick Commands</a></h3>
<pre><code class="language-bash"># ===== BUILD &amp; PREVIEW =====
# Build/Preview kustomization (see rendered YAML)
kubectl kustomize overlays/prod

# Or using kustomize directly
kustomize build overlays/prod

# ===== APPLY =====
# Apply kustomization
kubectl apply -k overlays/prod

# Apply with dry-run
kubectl apply -k overlays/prod --dry-run=client

# ===== DELETE =====
# Delete all resources from kustomization
kubectl delete -k overlays/prod

# ===== DEVELOPMENT =====
# Edit kustomization
kustomize edit add resource new-resource.yaml
kustomize edit set image my-app=my-app:v2.0.0
kustomize edit set namespace production

# Validate
kustomize build overlays/prod | kubectl apply --dry-run=server -f -
</code></pre>
<h3 id="-consequences-of-wrong-configuration-7"><a class="header" href="#-consequences-of-wrong-configuration-7">⚠️ Consequences of Wrong Configuration</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Consequence</th></tr>
</thead>
<tbody>
<tr><td>Wrong path in <code>resources</code></td><td><code>kustomize build</code> fails</td></tr>
<tr><td>Patch target doesn’t match</td><td>Patch not applied, silent failure</td></tr>
<tr><td>Wrong patch syntax</td><td>Build fails</td></tr>
<tr><td>Missing base reference</td><td>Empty output</td></tr>
<tr><td>Conflicting patches</td><td>Unpredictable results</td></tr>
</tbody>
</table>
</div>
<h3 id="helm-vs-kustomize-comparison"><a class="header" href="#helm-vs-kustomize-comparison">Helm vs Kustomize Comparison</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Feature</th><th>Helm</th><th>Kustomize</th></tr>
</thead>
<tbody>
<tr><td>Templating</td><td>Yes (Go templates)</td><td>No (patches only)</td></tr>
<tr><td>Package management</td><td>Yes</td><td>No</td></tr>
<tr><td>Complexity</td><td>Higher</td><td>Lower</td></tr>
<tr><td>Learning curve</td><td>Steeper</td><td>Gentler</td></tr>
<tr><td>Rollback</td><td>Built-in</td><td>Manual</td></tr>
<tr><td>Best for</td><td>Complex apps</td><td>Environment overlays</td></tr>
</tbody>
</table>
</div>
<h3 id="-documentation-7"><a class="header" href="#-documentation-7">📚 Documentation</a></h3>
<ul>
<li>https://kustomize.io/</li>
<li>https://kubernetes.io/docs/tasks/manage-kubernetes-objects/kustomization/</li>
</ul>
<hr>
<h2 id="9--argocd"><a class="header" href="#9--argocd">9. 🔄 ARGOCD</a></h2>
<h3 id="definition-8-1"><a class="header" href="#definition-8-1">Definition</a></h3>
<blockquote>
<p><strong>GitOps continuous delivery</strong> tool. Automatically syncs your Kubernetes cluster state with Git repository.
Think of it as <strong>automated deployment from Git</strong> - Git is the source of truth.</p>
</blockquote>
<h3 id="installation-using-helm"><a class="header" href="#installation-using-helm">Installation (using Helm)</a></h3>
<pre><code class="language-bash"># Add ArgoCD Helm repo
helm repo add argo https://argoproj.github.io/argo-helm
helm repo update

# Install ArgoCD
helm install argocd argo/argo-cd \
  --namespace argocd \
  --create-namespace \
  --set server.service.type=LoadBalancer

# Get initial admin password
kubectl -n argocd get secret argocd-initial-admin-secret \
  -o jsonpath="{.data.password}" | base64 -d

# Access UI
kubectl get svc argocd-server -n argocd
</code></pre>
<hr>
<h3 id="91-application---helm-based"><a class="header" href="#91-application---helm-based">9.1 Application - Helm Based</a></h3>
<pre><code class="language-yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: my-app-helm
    namespace: argocd # ⚠️ Always in argocd namespace
    finalizers:
        - resources-finalizer.argocd.argoproj.io
spec:
    project: default # ⚠️ IMPORTANT: ArgoCD project

    source:
        # ===== HELM FROM GIT REPO =====
        repoURL: https://github.com/myorg/my-app.git
        targetRevision: main # ⚠️ IMPORTANT: Branch/tag/commit
        path: helm/my-chart # ⚠️ IMPORTANT: Path to chart in repo

        helm:
            # Values file from repo
            valueFiles:
                - values.yaml
                - values-prod.yaml # ⚠️ Multiple values files

            # Inline value overrides
            values: |
                replicaCount: 3
                image:
                  tag: v1.2.3

            # Or individual parameters
            parameters:
                - name: image.tag
                  value: v1.2.3
                - name: service.type
                  value: LoadBalancer

    # ===== OR HELM FROM HELM REPO =====
    # source:
    #   repoURL: https://charts.bitnami.com/bitnami
    #   chart: nginx
    #   targetRevision: 15.1.0     # Chart version
    #   helm:
    #     values: |
    #       replicaCount: 2

    destination:
        server: https://kubernetes.default.svc # ⚠️ Cluster URL
        namespace: production # ⚠️ IMPORTANT: Target namespace

    syncPolicy:
        automated: # ⚠️ Enable auto-sync
            prune: true # Delete resources not in Git
            selfHeal: true # Revert manual changes
            allowEmpty: false # Prevent sync if source is empty

        syncOptions:
            - CreateNamespace=true # Create namespace if not exists
            - PruneLast=true # Prune after sync
            - ApplyOutOfSyncOnly=true # Only apply changed resources

        retry:
            limit: 5 # Retry attempts
            backoff:
                duration: 5s
                factor: 2
                maxDuration: 3m
</code></pre>
<hr>
<h3 id="92-application---gitkustomize-based"><a class="header" href="#92-application---gitkustomize-based">9.2 Application - Git/Kustomize Based</a></h3>
<pre><code class="language-yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: my-app-kustomize
    namespace: argocd
spec:
    project: default

    source:
        repoURL: https://github.com/myorg/my-app.git
        targetRevision: main
        path: kustomize/overlays/prod # ⚠️ Path to kustomization.yaml

        # Optional: Kustomize-specific options
        kustomize:
            images: # Override images
                - my-app=my-registry/my-app:v1.2.3
            namePrefix: prod- # Add prefix
            commonLabels:
                environment: production

    destination:
        server: https://kubernetes.default.svc
        namespace: production

    syncPolicy:
        automated:
            prune: true
            selfHeal: true
        syncOptions:
            - CreateNamespace=true
</code></pre>
<hr>
<h3 id="93-application---plain-yaml-directory"><a class="header" href="#93-application---plain-yaml-directory">9.3 Application - Plain YAML (Directory)</a></h3>
<pre><code class="language-yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: my-app-plain
    namespace: argocd
spec:
    project: default

    source:
        repoURL: https://github.com/myorg/my-app.git
        targetRevision: main
        path: kubernetes/ # ⚠️ Directory with YAML files

        directory:
            recurse: true # Include subdirectories
            exclude: '*.md' # Exclude patterns

    destination:
        server: https://kubernetes.default.svc
        namespace: production

    syncPolicy:
        automated:
            prune: true
            selfHeal: true
</code></pre>
<hr>
<h3 id="94-applicationset-multiple-apps"><a class="header" href="#94-applicationset-multiple-apps">9.4 ApplicationSet (Multiple Apps)</a></h3>
<pre><code class="language-yaml">apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
    name: my-apps
    namespace: argocd
spec:
    generators:
        # Generate app for each environment
        - list:
              elements:
                  - env: dev
                    namespace: development
                    branch: develop
                  - env: staging
                    namespace: staging
                    branch: main
                  - env: prod
                    namespace: production
                    branch: main

    template:
        metadata:
            name: 'my-app-{{env}}' # ⚠️ Templated name
        spec:
            project: default
            source:
                repoURL: https://github.com/myorg/my-app.git
                targetRevision: '{{branch}}'
                path: 'kustomize/overlays/{{env}}'
            destination:
                server: https://kubernetes.default.svc
                namespace: '{{namespace}}'
            syncPolicy:
                automated:
                    prune: true
                    selfHeal: true
</code></pre>
<h3 id="95-multiple-sources-helm--values-from-different-repos"><a class="header" href="#95-multiple-sources-helm--values-from-different-repos">9.5 Multiple Sources (Helm + Values from Different Repos)</a></h3>
<p>Use when your Helm chart is in one repo but values files are in another (common in GitOps setups where infra team owns charts, app team owns configs).</p>
<pre><code class="language-yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: my-app-multi-source
    namespace: argocd
spec:
    project: default

    # ⚠️ MULTIPLE SOURCES - requires ArgoCD 2.6+
    sources:
        # Source 1: Helm chart from Helm repository
        - repoURL: https://charts.bitnami.com/bitnami
          chart: nginx
          targetRevision: 15.1.0
          helm:
              valueFiles:
                  # ⚠️ Reference values from another source using $name
                  - $values/environments/prod/values.yaml
                  - $values/environments/prod/secrets.yaml

        # Source 2: Values files from Git repo (named "values")
        - repoURL: https://github.com/myorg/app-config.git
          targetRevision: main
          ref: values # ⚠️ This name is used as $values above

    destination:
        server: https://kubernetes.default.svc
        namespace: production

    syncPolicy:
        automated:
            prune: true
            selfHeal: true
</code></pre>
<p><strong>What’s happening:</strong></p>
<ol>
<li>ArgoCD fetches the Helm chart from Bitnami</li>
<li>ArgoCD fetches values files from your Git repo</li>
<li><code>$values</code> references the source with <code>ref: values</code></li>
<li>Helm chart is rendered using values from Git repo</li>
</ol>
<hr>
<h3 id="96-values-file-locations---all-options"><a class="header" href="#96-values-file-locations---all-options">9.6 Values File Locations - All Options</a></h3>
<pre><code class="language-yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: my-app-values-examples
    namespace: argocd
spec:
    project: default

    source:
        repoURL: https://github.com/myorg/my-app.git
        targetRevision: main
        path: helm/my-chart

        helm:
            # ═══════════════════════════════════════════════════════
            # OPTION 1: Values file from SAME repo (relative to path)
            # ═══════════════════════════════════════════════════════
            valueFiles:
                - values.yaml # helm/my-chart/values.yaml
                - ../common/values-shared.yaml # helm/common/values-shared.yaml
                - environments/prod.yaml # helm/my-chart/environments/prod.yaml

            # ═══════════════════════════════════════════════════════
            # OPTION 2: Inline values (directly in Application spec)
            # ═══════════════════════════════════════════════════════
            values: |
                replicaCount: 3
                image:
                  repository: my-registry/my-app
                  tag: v1.2.3
                ingress:
                  enabled: true
                  host: myapp.example.com

                # Complex nested values
                resources:
                  limits:
                    cpu: 500m
                    memory: 256Mi

            # ═══════════════════════════════════════════════════════
            # OPTION 3: Individual parameters (override specific keys)
            # ═══════════════════════════════════════════════════════
            parameters:
                - name: image.tag
                  value: v1.2.3
                - name: replicaCount
                  value: '5' # ⚠️ Must be string
                - name: ingress.enabled
                  value: 'true' # ⚠️ Must be string

    destination:
        server: https://kubernetes.default.svc
        namespace: production
</code></pre>
<hr>
<h3 id="97-multiple-sources---chart-from-git--external-values"><a class="header" href="#97-multiple-sources---chart-from-git--external-values">9.7 Multiple Sources - Chart from Git + External Values</a></h3>
<p>Common pattern: Your team’s Helm chart in Git, with environment values also in Git but different path/branch.</p>
<pre><code class="language-yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: my-app-git-chart
    namespace: argocd
spec:
    project: default

    sources:
        # Source 1: Helm chart from Git repository
        - repoURL: https://github.com/myorg/helm-charts.git
          targetRevision: main
          path: charts/my-app # Path to Chart.yaml
          helm:
              valueFiles:
                  - values.yaml # Default values from chart repo
                  - $configRepo/prod/values.yaml # From config repo
                  - $configRepo/prod/secrets.yaml # From config repo

        # Source 2: Configuration repository
        - repoURL: https://github.com/myorg/app-configurations.git
          targetRevision: main
          ref: configRepo # ⚠️ Referenced as $configRepo above

    destination:
        server: https://kubernetes.default.svc
        namespace: production
</code></pre>
<hr>
<h3 id="98-multiple-sources---combining-kustomize--helm"><a class="header" href="#98-multiple-sources---combining-kustomize--helm">9.8 Multiple Sources - Combining Kustomize + Helm</a></h3>
<p>When you need to apply Kustomize patches on top of a Helm chart.</p>
<pre><code class="language-yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: my-app-helm-kustomize
    namespace: argocd
spec:
    project: default

    sources:
        # Source 1: Base Helm chart
        - repoURL: https://charts.bitnami.com/bitnami
          chart: postgresql
          targetRevision: 12.1.0
          helm:
              releaseName: my-postgres
              valueFiles:
                  - $values/base-values.yaml

        # Source 2: Values + Kustomize patches
        - repoURL: https://github.com/myorg/db-config.git
          targetRevision: main
          ref: values

        # Source 3: Additional Kustomize resources to add
        - repoURL: https://github.com/myorg/db-config.git
          targetRevision: main
          path: additional-resources/prod # Extra ConfigMaps, Secrets, etc.

    destination:
        server: https://kubernetes.default.svc
        namespace: database
</code></pre>
<hr>
<h3 id="values-precedence-when-multiple-sources"><a class="header" href="#values-precedence-when-multiple-sources">Values Precedence (When Multiple Sources)</a></h3>
<p>When the same key appears in multiple places, later values override earlier ones:</p>
<pre><code>1. Chart's default values.yaml        (lowest priority)
2. First valueFiles entry             ↓
3. Second valueFiles entry            ↓
4. Inline 'values:' block             ↓
5. 'parameters:' entries              (highest priority)
</code></pre>
<p><strong>Example:</strong></p>
<pre><code class="language-yaml">helm:
    valueFiles:
        - values.yaml # replicaCount: 1
        - values-prod.yaml # replicaCount: 3  ← overrides
    values: |
        replicaCount: 5         # ← overrides again
    parameters:
        - name: replicaCount
          value: '10' # ← final value = 10
</code></pre>
<hr>
<h3 id="-multiple-sources---common-mistakes"><a class="header" href="#-multiple-sources---common-mistakes">⚠️ Multiple Sources - Common Mistakes</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Error/Consequence</th></tr>
</thead>
<tbody>
<tr><td>Missing <code>ref:</code> in source</td><td>Cannot use <code>$refName</code> in valueFiles</td></tr>
<tr><td>Wrong <code>$ref</code> name</td><td>“source with ref ‘xxx’ not found”</td></tr>
<tr><td>Using <code>source:</code> with <code>sources:</code></td><td>Invalid spec, use one or the other</td></tr>
<tr><td>ArgoCD version &lt; 2.6</td><td>Multiple sources not supported</td></tr>
<tr><td>Wrong path in valueFiles</td><td>Values file not found, sync fails</td></tr>
</tbody>
</table>
</div>
<hr>
<h3 id="quick-commands-8"><a class="header" href="#quick-commands-8">Quick Commands</a></h3>
<pre><code class="language-bash"># ===== ARGOCD CLI =====
# Install CLI
brew install argocd  # macOS
# Or download from GitHub releases

# Login
argocd login &lt;ARGOCD_SERVER&gt; --username admin --password &lt;PASSWORD&gt;

# ===== APPLICATION MANAGEMENT =====
# List applications
argocd app list

# Get app details
argocd app get my-app

# Sync application (manual deploy)
argocd app sync my-app

# Sync with prune
argocd app sync my-app --prune

# Force sync (bypass hooks)
argocd app sync my-app --force

# Rollback
argocd app rollback my-app &lt;REVISION&gt;

# View app history
argocd app history my-app

# Delete application
argocd app delete my-app

# Delete app AND resources
argocd app delete my-app --cascade

# ===== USING KUBECTL =====
# Create application
kubectl apply -f application.yaml

# List applications
kubectl get applications -n argocd

# Describe application
kubectl describe application my-app -n argocd

# View sync status
kubectl get applications my-app -n argocd -o jsonpath='{.status.sync.status}'
</code></pre>
<h3 id="-consequences-of-wrong-configuration-8"><a class="header" href="#-consequences-of-wrong-configuration-8">⚠️ Consequences of Wrong Configuration</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Consequence</th></tr>
</thead>
<tbody>
<tr><td>Wrong <code>repoURL</code></td><td>Sync fails, can’t access repo</td></tr>
<tr><td>Wrong <code>path</code></td><td>“path does not exist” error</td></tr>
<tr><td>Wrong <code>targetRevision</code></td><td>Deploys wrong version</td></tr>
<tr><td><code>prune: true</code> accidentally</td><td>Deletes resources not in Git</td></tr>
<tr><td><code>selfHeal: true</code> + manual changes</td><td>Changes reverted automatically</td></tr>
<tr><td>Wrong destination namespace</td><td>Resources in wrong namespace</td></tr>
<tr><td>No <code>CreateNamespace=true</code></td><td>Fails if namespace doesn’t exist</td></tr>
<tr><td>Deleting Application with <code>--cascade</code></td><td><strong>Deletes all deployed resources</strong></td></tr>
</tbody>
</table>
</div>
<h3 id="argocd-sync-states"><a class="header" href="#argocd-sync-states">ArgoCD Sync States</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th></tr>
</thead>
<tbody>
<tr><td>Synced</td><td>Cluster matches Git</td></tr>
<tr><td>OutOfSync</td><td>Cluster differs from Git</td></tr>
<tr><td>Unknown</td><td>Can’t determine state</td></tr>
<tr><td>Progressing</td><td>Sync in progress</td></tr>
<tr><td>Degraded</td><td>Resources unhealthy</td></tr>
</tbody>
</table>
</div>
<h3 id="-documentation-8"><a class="header" href="#-documentation-8">📚 Documentation</a></h3>
<ul>
<li>https://argo-cd.readthedocs.io/</li>
<li>https://github.com/argoproj/argo-cd</li>
</ul>
<hr>
<h2 id="-quick-reference-card-1"><a class="header" href="#-quick-reference-card-1">🎯 Quick Reference Card</a></h2>
<h3 id="resource-creation-order"><a class="header" href="#resource-creation-order">Resource Creation Order</a></h3>
<pre><code>1. Namespace
2. ConfigMaps/Secrets
3. Deployments
4. Services
5. Ingress
</code></pre>
<h3 id="essential-commands"><a class="header" href="#essential-commands">Essential Commands</a></h3>
<pre><code class="language-bash"># Get all resources
kubectl get all -n &lt;namespace&gt;

# Watch resources
kubectl get pods -w -n &lt;namespace&gt;

# Debug pod
kubectl describe pod &lt;pod-name&gt; -n &lt;namespace&gt;
kubectl logs &lt;pod-name&gt; -n &lt;namespace&gt;
kubectl exec -it &lt;pod-name&gt; -n &lt;namespace&gt; -- /bin/sh

# Apply all YAML in directory
kubectl apply -f ./manifests/ -n &lt;namespace&gt;

# Delete all resources
kubectl delete all --all -n &lt;namespace&gt;
</code></pre>
<h3 id="most-common-errors--fixes"><a class="header" href="#most-common-errors--fixes">Most Common Errors &amp; Fixes</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Error</th><th>Cause</th><th>Fix</th></tr>
</thead>
<tbody>
<tr><td><code>ImagePullBackOff</code></td><td>Wrong image name/tag</td><td>Check image name, registry auth</td></tr>
<tr><td><code>CrashLoopBackOff</code></td><td>App crashing</td><td>Check logs: <code>kubectl logs</code></td></tr>
<tr><td><code>Pending</code> (Pod)</td><td>No resources/scheduling</td><td>Check events, node resources</td></tr>
<tr><td><code>CreateContainerConfigError</code></td><td>Missing ConfigMap/Secret</td><td>Create missing ConfigMap/Secret</td></tr>
<tr><td><code>Connection refused</code></td><td>Wrong port/service</td><td>Check ports, service selector</td></tr>
<tr><td><code>502 Bad Gateway</code></td><td>Service can’t reach pod</td><td>Check selectors, endpoints</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="-all-documentation-links"><a class="header" href="#-all-documentation-links">📚 All Documentation Links</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Resource</th><th>Link</th></tr>
</thead>
<tbody>
<tr><td>Kubernetes Docs</td><td>https://kubernetes.io/docs/</td></tr>
<tr><td>Namespace</td><td>https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/</td></tr>
<tr><td>Pods</td><td>https://kubernetes.io/docs/concepts/workloads/pods/</td></tr>
<tr><td>Deployments</td><td>https://kubernetes.io/docs/concepts/workloads/controllers/deployment/</td></tr>
<tr><td>Services</td><td>https://kubernetes.io/docs/concepts/services-networking/service/</td></tr>
<tr><td>ConfigMaps</td><td>https://kubernetes.io/docs/concepts/configuration/configmap/</td></tr>
<tr><td>Secrets</td><td>https://kubernetes.io/docs/concepts/configuration/secret/</td></tr>
<tr><td>Ingress</td><td>https://kubernetes.io/docs/concepts/services-networking/ingress/</td></tr>
<tr><td>Helm</td><td>https://helm.sh/docs/</td></tr>
<tr><td>Helm Charts Hub</td><td>https://artifacthub.io/</td></tr>
<tr><td>Kustomize</td><td>https://kustomize.io/</td></tr>
<tr><td>ArgoCD</td><td>https://argo-cd.readthedocs.io/</td></tr>
</tbody>
</table>
</div>
<h1 id="-port-forward"><a class="header" href="#-port-forward">🔌 PORT FORWARD</a></h1>
<h3 id="definition-9"><a class="header" href="#definition-9">Definition</a></h3>
<blockquote>
<p><strong>Temporary tunnel</strong> from your local machine to a pod, service, or deployment inside the cluster. Think of it as a <strong>direct phone line</strong> to a resource that’s otherwise unreachable from outside.</p>
</blockquote>
<h3 id="quick-commands-9"><a class="header" href="#quick-commands-9">Quick Commands</a></h3>
<pre><code class="language-bash"># Forward to pod
kubectl port-forward pod/my-pod 8080:80 -n my-namespace

# Forward to service
kubectl port-forward svc/my-service 8080:80 -n my-namespace

# Forward to deployment
kubectl port-forward deploy/my-deployment 8080:80 -n my-namespace

# Listen on all interfaces (accessible from other machines)
kubectl port-forward svc/my-service 8080:80 --address 0.0.0.0 -n my-namespace

# Multiple ports
kubectl port-forward pod/my-pod 8080:80 8443:443 -n my-namespace

# Run in background
kubectl port-forward svc/my-service 8080:80 -n my-namespace &amp;
</code></pre>
<h3 id="common-use-cases-1"><a class="header" href="#common-use-cases-1">Common Use Cases</a></h3>
<pre><code class="language-bash"># Database access
kubectl port-forward svc/postgres 5432:5432 -n database
# → psql -h localhost -p 5432

# Redis access
kubectl port-forward svc/redis 6379:6379 -n cache
# → redis-cli -h localhost

# Internal dashboards
kubectl port-forward svc/grafana 3000:3000 -n monitoring
# → http://localhost:3000

# ArgoCD UI
kubectl port-forward svc/argocd-server 8080:443 -n argocd
# → https://localhost:8080

# Debug API
kubectl port-forward deploy/my-api 8080:8080 -n my-app
# → curl http://localhost:8080/health
</code></pre>
<h3 id="-consequences-of-wrong-usage"><a class="header" href="#-consequences-of-wrong-usage">⚠️ Consequences of Wrong Usage</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Consequence</th></tr>
</thead>
<tbody>
<tr><td>Wrong port number</td><td>Connection refused</td></tr>
<tr><td>Wrong resource name</td><td>“not found” error</td></tr>
<tr><td>Closing terminal</td><td>Port forward stops immediately</td></tr>
<tr><td>Using for production traffic</td><td>Unreliable, single connection only</td></tr>
<tr><td>Forgetting namespace</td><td>Tries default namespace, resource not found</td></tr>
<tr><td>Port already in use locally</td><td>“bind: address already in use” error</td></tr>
</tbody>
</table>
</div>
<h3 id="-key-points"><a class="header" href="#-key-points">💡 Key Points</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Point</th><th>Explanation</th></tr>
</thead>
<tbody>
<tr><td><strong>Temporary</strong></td><td>Stops when terminal closes or Ctrl+C</td></tr>
<tr><td><strong>Local only</strong></td><td>Default binds to 127.0.0.1 only</td></tr>
<tr><td><strong>Single pod</strong></td><td>Even with service, connects to ONE pod</td></tr>
<tr><td><strong>Dev/Debug only</strong></td><td>Not meant for production traffic</td></tr>
</tbody>
</table>
</div>
<h3 id="-documentation-9"><a class="header" href="#-documentation-9">📚 Documentation</a></h3>
<ul>
<li>https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster/</li>
</ul>
<h1 id="-persistent-volume--persistent-volume-claim"><a class="header" href="#-persistent-volume--persistent-volume-claim">💾 PERSISTENT VOLUME &amp; PERSISTENT VOLUME CLAIM</a></h1>
<h2 id="definition-10"><a class="header" href="#definition-10">Definition</a></h2>
<blockquote>
<p><strong>PersistentVolume (PV)</strong>: A piece of storage in the cluster provisioned by an admin or dynamically.
Think of it as a <strong>physical hard drive</strong> available in the cluster.</p>
</blockquote>
<blockquote>
<p><strong>PersistentVolumeClaim (PVC)</strong>: A request for storage by a user. Think of it as a <strong>ticket/request</strong> to use a specific amount of storage.</p>
</blockquote>
<blockquote>
<p><strong>StorageClass</strong>: Defines <strong>how</strong> storage is provisioned (fast SSD, slow HDD, cloud provider specific).
Think of it as <strong>storage tiers/types</strong>.</p>
</blockquote>
<p><strong>How they work together:</strong></p>
<pre><code>[StorageClass]          [PersistentVolume]          [PersistentVolumeClaim]          [Pod]
 (defines type)    --&gt;   (actual storage)     &lt;--    (request for storage)     &lt;--  (uses storage)

     SSD-fast             100Gi SSD disk              "I need 10Gi SSD"           mounts /data
     HDD-slow             500Gi HDD disk              "I need 50Gi HDD"           mounts /backup
</code></pre>
<p><strong>Real-world analogy:</strong></p>
<ul>
<li><strong>StorageClass</strong> = Types of apartments (luxury, standard, economy)</li>
<li><strong>PersistentVolume</strong> = Actual apartment units available</li>
<li><strong>PersistentVolumeClaim</strong> = Your rental application for an apartment</li>
<li><strong>Pod</strong> = You living in the apartment</li>
</ul>
<hr>
<h2 id="101-storageclass"><a class="header" href="#101-storageclass">10.1 StorageClass</a></h2>
<h3 id="definition-11"><a class="header" href="#definition-11">Definition</a></h3>
<blockquote>
<p>Defines the <strong>type/tier of storage</strong> and how it should be provisioned. Different cloud providers have different storage classes.</p>
</blockquote>
<h3 id="yaml-template-4"><a class="header" href="#yaml-template-4">YAML Template</a></h3>
<pre><code class="language-yaml">apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
    name: fast-ssd # ⚠️ IMPORTANT: Name used in PVC
    annotations:
        storageclass.kubernetes.io/is-default-class: 'true' # Make default
spec:
    provisioner: kubernetes.io/aws-ebs # ⚠️ CRITICAL: Cloud provider specific

    parameters: # ⚠️ Provider-specific parameters
        type: gp3 # AWS: gp2, gp3, io1, io2
        fsType: ext4
        encrypted: 'true'

    reclaimPolicy: Delete # ⚠️ IMPORTANT: Delete | Retain

    volumeBindingMode: WaitForFirstConsumer # ⚠️ RECOMMENDED: Immediate | WaitForFirstConsumer

    allowVolumeExpansion: true # ⚠️ Allow PVC resize

    mountOptions: # Optional mount options
        - debug
</code></pre>
<h3 id="common-provisioners"><a class="header" href="#common-provisioners">Common Provisioners</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Cloud Provider</th><th>Provisioner</th><th>Common Types</th></tr>
</thead>
<tbody>
<tr><td>AWS EBS</td><td><code>kubernetes.io/aws-ebs</code></td><td>gp2, gp3, io1, io2</td></tr>
<tr><td>AWS EFS</td><td><code>efs.csi.aws.com</code></td><td>(shared filesystem)</td></tr>
<tr><td>GCP PD</td><td><code>kubernetes.io/gce-pd</code></td><td>pd-standard, pd-ssd</td></tr>
<tr><td>Azure Disk</td><td><code>kubernetes.io/azure-disk</code></td><td>Standard_LRS, Premium_LRS</td></tr>
<tr><td>Azure File</td><td><code>kubernetes.io/azure-file</code></td><td>(shared filesystem)</td></tr>
<tr><td>Local</td><td><code>kubernetes.io/no-provisioner</code></td><td>(manual provisioning)</td></tr>
<tr><td>NFS</td><td><code>nfs.csi.k8s.io</code></td><td>(shared filesystem)</td></tr>
</tbody>
</table>
</div>
<h3 id="reclaim-policies"><a class="header" href="#reclaim-policies">Reclaim Policies</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Policy</th><th>Behavior</th></tr>
</thead>
<tbody>
<tr><td><code>Delete</code></td><td>PV deleted when PVC is deleted (default for dynamic)</td></tr>
<tr><td><code>Retain</code></td><td>PV kept when PVC deleted, manual cleanup needed</td></tr>
<tr><td><code>Recycle</code></td><td>(Deprecated) Basic scrub and reuse</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="102-persistentvolume-pv"><a class="header" href="#102-persistentvolume-pv">10.2 PersistentVolume (PV)</a></h2>
<h3 id="definition-12"><a class="header" href="#definition-12">Definition</a></h3>
<blockquote>
<p>The <strong>actual storage resource</strong> in the cluster. Can be provisioned manually (static) or automatically via StorageClass (dynamic).</p>
</blockquote>
<h3 id="yaml-template---static-provisioning"><a class="header" href="#yaml-template---static-provisioning">YAML Template - Static Provisioning</a></h3>
<pre><code class="language-yaml">apiVersion: v1
kind: PersistentVolume
metadata:
    name: my-pv # ⚠️ IMPORTANT: PV name (cluster-wide)
    labels:
        type: local
        environment: prod
spec:
    capacity:
        storage: 100Gi # ⚠️ CRITICAL: Storage size

    volumeMode: Filesystem # Filesystem | Block

    accessModes: # ⚠️ CRITICAL: How it can be mounted
        - ReadWriteOnce # RWO: Single node read-write
        # - ReadOnlyMany               # ROX: Multiple nodes read-only
        # - ReadWriteMany              # RWX: Multiple nodes read-write
        # - ReadWriteOncePod           # RWOP: Single pod read-write (K8s 1.22+)

    persistentVolumeReclaimPolicy: Retain # ⚠️ IMPORTANT: Delete | Retain

    storageClassName: fast-ssd # ⚠️ IMPORTANT: Must match PVC

    # ===== STORAGE BACKEND (choose one) =====

    # Local storage
    hostPath:
        path: /mnt/data
        type: DirectoryOrCreate # Directory | DirectoryOrCreate | File | etc.

    # Or NFS
    # nfs:
    #     server: nfs-server.example.com
    #     path: /exports/data

    # Or AWS EBS
    # awsElasticBlockStore:
    #     volumeID: vol-0123456789abcdef0
    #     fsType: ext4

    # Or GCP PD
    # gcePersistentDisk:
    #     pdName: my-disk
    #     fsType: ext4

    nodeAffinity: # ⚠️ For local volumes - which node
        required:
            nodeSelectorTerms:
                - matchExpressions:
                      - key: kubernetes.io/hostname
                        operator: In
                        values:
                            - worker-node-1
</code></pre>
<h3 id="access-modes-explained"><a class="header" href="#access-modes-explained">Access Modes Explained</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mode</th><th>Abbreviation</th><th>Description</th><th>Use Case</th></tr>
</thead>
<tbody>
<tr><td><code>ReadWriteOnce</code></td><td>RWO</td><td>Single node can mount read-write</td><td>Databases, single pod apps</td></tr>
<tr><td><code>ReadOnlyMany</code></td><td>ROX</td><td>Multiple nodes can mount read-only</td><td>Shared config, static assets</td></tr>
<tr><td><code>ReadWriteMany</code></td><td>RWX</td><td>Multiple nodes can mount read-write</td><td>Shared uploads, CMS</td></tr>
<tr><td><code>ReadWriteOncePod</code></td><td>RWOP</td><td>Single pod can mount read-write</td><td>Strict single-pod access</td></tr>
</tbody>
</table>
</div>
<h3 id="-access-mode-support-by-storage-type"><a class="header" href="#-access-mode-support-by-storage-type">⚠️ Access Mode Support by Storage Type</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Storage Type</th><th>RWO</th><th>ROX</th><th>RWX</th></tr>
</thead>
<tbody>
<tr><td>AWS EBS</td><td>✅</td><td>❌</td><td>❌</td></tr>
<tr><td>AWS EFS</td><td>✅</td><td>✅</td><td>✅</td></tr>
<tr><td>GCP PD</td><td>✅</td><td>❌</td><td>❌</td></tr>
<tr><td>Azure Disk</td><td>✅</td><td>❌</td><td>❌</td></tr>
<tr><td>Azure File</td><td>✅</td><td>✅</td><td>✅</td></tr>
<tr><td>NFS</td><td>✅</td><td>✅</td><td>✅</td></tr>
<tr><td>hostPath</td><td>✅</td><td>❌</td><td>❌</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="103-persistentvolumeclaim-pvc"><a class="header" href="#103-persistentvolumeclaim-pvc">10.3 PersistentVolumeClaim (PVC)</a></h2>
<h3 id="definition-13"><a class="header" href="#definition-13">Definition</a></h3>
<blockquote>
<p>A <strong>request for storage</strong> by a user/pod. Kubernetes finds a matching PV or dynamically provisions one.</p>
</blockquote>
<h3 id="yaml-template-5"><a class="header" href="#yaml-template-5">YAML Template</a></h3>
<pre><code class="language-yaml">apiVersion: v1
kind: PersistentVolumeClaim
metadata:
    name: my-pvc # ⚠️ IMPORTANT: PVC name (used in pod)
    namespace: my-app-dev # ⚠️ IMPORTANT: Namespace-scoped
    labels:
        app: my-app
spec:
    accessModes:
        - ReadWriteOnce # ⚠️ CRITICAL: Must match/be subset of PV

    storageClassName:
        fast-ssd # ⚠️ CRITICAL: StorageClass to use
        # Empty string "" = use default
        # Omit = use cluster default

    resources:
        requests:
            storage: 10Gi # ⚠️ CRITICAL: Requested size

    # Optional: Select specific PV by label
    selector:
        matchLabels:
            type: local
            environment: prod

    # Optional: Specify exact PV name
    # volumeName: my-pv

    volumeMode: Filesystem # Filesystem | Block
</code></pre>
<h3 id="dynamic-vs-static-provisioning"><a class="header" href="#dynamic-vs-static-provisioning">Dynamic vs Static Provisioning</a></h3>
<pre><code>STATIC PROVISIONING (Admin creates PV first):
┌──────────────┐     ┌─────────────────┐     ┌─────────────────┐
│ Admin creates│ --&gt; │ PVC requests    │ --&gt; │ K8s binds PVC   │
│ PV manually  │     │ matching storage│     │ to existing PV  │
└──────────────┘     └─────────────────┘     └─────────────────┘

DYNAMIC PROVISIONING (StorageClass auto-creates PV):
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│ PVC requests    │ --&gt; │ StorageClass    │ --&gt; │ PV auto-created │
│ with SC name    │     │ provisions PV   │     │ and bound       │
└─────────────────┘     └─────────────────┘     └─────────────────┘
</code></pre>
<hr>
<h2 id="104-using-pvc-in-poddeployment"><a class="header" href="#104-using-pvc-in-poddeployment">10.4 Using PVC in Pod/Deployment</a></h2>
<h3 id="pod-with-pvc"><a class="header" href="#pod-with-pvc">Pod with PVC</a></h3>
<pre><code class="language-yaml">apiVersion: v1
kind: Pod
metadata:
    name: my-pod
    namespace: my-app-dev
spec:
    containers:
        - name: my-app
          image: nginx:1.21

          volumeMounts:
              - name: data-volume # ⚠️ Must match volumes[].name
                mountPath: /usr/share/nginx/html # ⚠️ Where to mount
                readOnly: false
                subPath: html # Optional: Mount subdirectory only

    volumes:
        - name: data-volume # ⚠️ Volume name
          persistentVolumeClaim:
              claimName: my-pvc # ⚠️ CRITICAL: PVC name
              readOnly: false
</code></pre>
<h3 id="deployment-with-pvc"><a class="header" href="#deployment-with-pvc">Deployment with PVC</a></h3>
<pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
    name: my-app
    namespace: my-app-dev
spec:
    replicas: 1 # ⚠️ With RWO, usually 1 replica
    selector:
        matchLabels:
            app: my-app
    template:
        metadata:
            labels:
                app: my-app
        spec:
            containers:
                - name: my-app
                  image: postgres:14

                  volumeMounts:
                      - name: postgres-data
                        mountPath: /var/lib/postgresql/data
                        subPath: pgdata # ⚠️ Avoid "lost+found" issues

                  env:
                      - name: PGDATA
                        value: /var/lib/postgresql/data/pgdata

            volumes:
                - name: postgres-data
                  persistentVolumeClaim:
                      claimName: postgres-pvc
</code></pre>
<hr>
<h2 id="105-statefulset-with-volumeclaimtemplate"><a class="header" href="#105-statefulset-with-volumeclaimtemplate">10.5 StatefulSet with VolumeClaimTemplate</a></h2>
<h3 id="definition-14"><a class="header" href="#definition-14">Definition</a></h3>
<blockquote>
<p>For <strong>stateful applications</strong> (databases, caches) where each pod needs its own dedicated storage.</p>
</blockquote>
<pre><code class="language-yaml">apiVersion: apps/v1
kind: StatefulSet
metadata:
    name: mysql
    namespace: database
spec:
    serviceName: mysql-headless # ⚠️ Required: Headless service name
    replicas: 3

    selector:
        matchLabels:
            app: mysql

    template:
        metadata:
            labels:
                app: mysql
        spec:
            containers:
                - name: mysql
                  image: mysql:8.0

                  volumeMounts:
                      - name: data # ⚠️ Matches volumeClaimTemplates[].name
                        mountPath: /var/lib/mysql

                  env:
                      - name: MYSQL_ROOT_PASSWORD
                        valueFrom:
                            secretKeyRef:
                                name: mysql-secret
                                key: root-password

    # ⚠️ CRITICAL: Creates PVC for each pod automatically
    volumeClaimTemplates:
        - metadata:
              name: data # ⚠️ Creates: data-mysql-0, data-mysql-1, etc.
          spec:
              accessModes:
                  - ReadWriteOnce
              storageClassName: fast-ssd
              resources:
                  requests:
                      storage: 50Gi

---
# Required headless service for StatefulSet
apiVersion: v1
kind: Service
metadata:
    name: mysql-headless
    namespace: database
spec:
    clusterIP: None # ⚠️ Headless service
    selector:
        app: mysql
    ports:
        - port: 3306
</code></pre>
<p><strong>What happens:</strong></p>
<pre><code>StatefulSet: mysql (replicas: 3)
    │
    ├── Pod: mysql-0  --&gt;  PVC: data-mysql-0  --&gt;  PV: pv-xxx-001
    ├── Pod: mysql-1  --&gt;  PVC: data-mysql-1  --&gt;  PV: pv-xxx-002
    └── Pod: mysql-2  --&gt;  PVC: data-mysql-2  --&gt;  PV: pv-xxx-003
</code></pre>
<hr>
<h2 id="106-expanding-pvc-resize"><a class="header" href="#106-expanding-pvc-resize">10.6 Expanding PVC (Resize)</a></h2>
<h3 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h3>
<pre><code class="language-yaml"># StorageClass must have:
allowVolumeExpansion: true
</code></pre>
<h3 id="resize-pvc"><a class="header" href="#resize-pvc">Resize PVC</a></h3>
<pre><code class="language-bash"># Edit PVC and increase storage
kubectl edit pvc my-pvc -n my-app-dev

# Or patch
kubectl patch pvc my-pvc -n my-app-dev -p '{"spec":{"resources":{"requests":{"storage":"20Gi"}}}}'
</code></pre>
<p><strong>⚠️ Note:</strong></p>
<ul>
<li>Can only <strong>increase</strong> size, never decrease</li>
<li>Some storage types require pod restart</li>
<li>File system resize happens automatically (usually)</li>
</ul>
<hr>
<h2 id="quick-commands-10"><a class="header" href="#quick-commands-10">Quick Commands</a></h2>
<pre><code class="language-bash"># ===== STORAGE CLASS =====
# List storage classes
kubectl get storageclass
kubectl get sc

# Describe storage class
kubectl describe sc fast-ssd

# Get default storage class
kubectl get sc -o jsonpath='{.items[?(@.metadata.annotations.storageclass\.kubernetes\.io/is-default-class=="true")].metadata.name}'

# ===== PERSISTENT VOLUME =====
# List PVs (cluster-wide)
kubectl get pv

# Describe PV
kubectl describe pv my-pv

# Delete PV
kubectl delete pv my-pv

# ===== PERSISTENT VOLUME CLAIM =====
# List PVCs
kubectl get pvc -n my-app-dev

# Describe PVC (check binding status)
kubectl describe pvc my-pvc -n my-app-dev

# Delete PVC
kubectl delete pvc my-pvc -n my-app-dev

# ===== DEBUGGING =====
# Check PVC events
kubectl describe pvc my-pvc -n my-app-dev | grep -A 10 Events

# Check PV bound to PVC
kubectl get pvc my-pvc -n my-app-dev -o jsonpath='{.spec.volumeName}'

# Check what's using a PVC
kubectl get pods -n my-app-dev -o json | jq '.items[] | select(.spec.volumes[].persistentVolumeClaim.claimName=="my-pvc") | .metadata.name'
</code></pre>
<hr>
<h2 id="pvpvc-states"><a class="header" href="#pvpvc-states">PV/PVC States</a></h2>
<h3 id="pv-states"><a class="header" href="#pv-states">PV States</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>State</th><th>Meaning</th></tr>
</thead>
<tbody>
<tr><td><code>Available</code></td><td>Free, not bound to any PVC</td></tr>
<tr><td><code>Bound</code></td><td>Bound to a PVC</td></tr>
<tr><td><code>Released</code></td><td>PVC deleted, but resource not reclaimed</td></tr>
<tr><td><code>Failed</code></td><td>Automatic reclamation failed</td></tr>
</tbody>
</table>
</div>
<h3 id="pvc-states"><a class="header" href="#pvc-states">PVC States</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>State</th><th>Meaning</th></tr>
</thead>
<tbody>
<tr><td><code>Pending</code></td><td>Waiting for PV to be available/created</td></tr>
<tr><td><code>Bound</code></td><td>Successfully bound to a PV</td></tr>
<tr><td><code>Lost</code></td><td>Bound PV no longer exists</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="-consequences-of-wrong-configuration-9"><a class="header" href="#-consequences-of-wrong-configuration-9">⚠️ Consequences of Wrong Configuration</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Mistake</th><th>Consequence</th></tr>
</thead>
<tbody>
<tr><td>PVC <code>storageClassName</code> doesn’t match</td><td>PVC stays <code>Pending</code> forever</td></tr>
<tr><td>PVC requests more than PV capacity</td><td>PVC stays <code>Pending</code></td></tr>
<tr><td>AccessMode mismatch (PVC vs PV)</td><td>PVC stays <code>Pending</code></td></tr>
<tr><td><code>ReclaimPolicy: Delete</code> + production data</td><td><strong>Data permanently lost when PVC deleted</strong></td></tr>
<tr><td>RWO with multiple replicas</td><td>Pods fail to schedule, stuck in <code>Pending</code></td></tr>
<tr><td>Missing <code>subPath</code> for databases</td><td>“lost+found” errors, DB fails to start</td></tr>
<tr><td>Deleting PVC before pod</td><td>Pod crashes with volume errors</td></tr>
<tr><td>Wrong <code>volumeName</code> in PVC</td><td>PVC binds to wrong/non-existent PV</td></tr>
<tr><td>No StorageClass in cluster</td><td>Dynamic provisioning fails</td></tr>
<tr><td><code>WaitForFirstConsumer</code> + no pod scheduled</td><td>PV not provisioned until pod is scheduled</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="-best-practices-1"><a class="header" href="#-best-practices-1">💡 Best Practices</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Practice</th><th>Reason</th></tr>
</thead>
<tbody>
<tr><td>Use <code>Retain</code> for production databases</td><td>Prevents accidental data loss</td></tr>
<tr><td>Use <code>WaitForFirstConsumer</code> binding mode</td><td>Ensures PV created in correct zone</td></tr>
<tr><td>Set <code>allowVolumeExpansion: true</code></td><td>Allows future resize without recreation</td></tr>
<tr><td>Use <code>subPath</code> for database mounts</td><td>Avoids “lost+found” directory issues</td></tr>
<tr><td>Use StatefulSet for stateful apps</td><td>Each pod gets its own PVC</td></tr>
<tr><td>Label PVs for static provisioning</td><td>Easier PVC-to-PV matching</td></tr>
<tr><td>Monitor PVC usage</td><td>Prevent “disk full” outages</td></tr>
<tr><td>Use appropriate access modes</td><td>RWX only when truly needed (slower)</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="complete-example-postgresql-with-persistent-storage"><a class="header" href="#complete-example-postgresql-with-persistent-storage">Complete Example: PostgreSQL with Persistent Storage</a></h2>
<pre><code class="language-yaml"># 1. StorageClass (if not using default)
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
    name: database-storage
provisioner: kubernetes.io/aws-ebs
parameters:
    type: gp3
    encrypted: 'true'
reclaimPolicy: Retain
volumeBindingMode: WaitForFirstConsumer
allowVolumeExpansion: true

---
# 2. PVC
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
    name: postgres-pvc
    namespace: database
spec:
    accessModes:
        - ReadWriteOnce
    storageClassName: database-storage
    resources:
        requests:
            storage: 50Gi

---
# 3. Secret for password
apiVersion: v1
kind: Secret
metadata:
    name: postgres-secret
    namespace: database
type: Opaque
stringData:
    postgres-password: mysecretpassword

---
# 4. Deployment
apiVersion: apps/v1
kind: Deployment
metadata:
    name: postgres
    namespace: database
spec:
    replicas: 1
    selector:
        matchLabels:
            app: postgres
    template:
        metadata:
            labels:
                app: postgres
        spec:
            containers:
                - name: postgres
                  image: postgres:15
                  ports:
                      - containerPort: 5432

                  env:
                      - name: POSTGRES_PASSWORD
                        valueFrom:
                            secretKeyRef:
                                name: postgres-secret
                                key: postgres-password
                      - name: PGDATA
                        value: /var/lib/postgresql/data/pgdata

                  volumeMounts:
                      - name: postgres-storage
                        mountPath: /var/lib/postgresql/data
                        subPath: pgdata

                  resources:
                      requests:
                          memory: '256Mi'
                          cpu: '250m'
                      limits:
                          memory: '512Mi'
                          cpu: '500m'

                  livenessProbe:
                      exec:
                          command:
                              - pg_isready
                              - -U
                              - postgres
                      initialDelaySeconds: 30
                      periodSeconds: 10

                  readinessProbe:
                      exec:
                          command:
                              - pg_isready
                              - -U
                              - postgres
                      initialDelaySeconds: 5
                      periodSeconds: 5

            volumes:
                - name: postgres-storage
                  persistentVolumeClaim:
                      claimName: postgres-pvc

---
# 5. Service
apiVersion: v1
kind: Service
metadata:
    name: postgres
    namespace: database
spec:
    type: ClusterIP
    selector:
        app: postgres
    ports:
        - port: 5432
          targetPort: 5432
</code></pre>
<hr>
<h2 id="-documentation-10"><a class="header" href="#-documentation-10">📚 Documentation</a></h2>
<ul>
<li>https://kubernetes.io/docs/concepts/storage/persistent-volumes/</li>
<li>https://kubernetes.io/docs/concepts/storage/storage-classes/</li>
<li>https://kubernetes.io/docs/concepts/storage/volume-pvc-datasource/</li>
<li>https://kubernetes.io/docs/tasks/configure-pod-container/configure-persistent-volume-storage/</li>
</ul>
<hr>
<p><strong>Added this section as #10 in your cheatsheet. Ready for more questions!</strong> 🎯</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="disk-fundamentals"><a class="header" href="#disk-fundamentals">Disk Fundamentals</a></h1>
<ul>
<li>disk have sectors,tracks</li>
<li>intersection of them is blocks</li>
<li>eacn block can be 4-16kb.</li>
</ul>
<h1 id="indexing-techniques"><a class="header" href="#indexing-techniques">Indexing Techniques</a></h1>
<h2 id="1-hash-index"><a class="header" href="#1-hash-index">1. Hash Index</a></h2>
<ul>
<li>Basic hashmap stored entirely in memory</li>
<li>Requires instant random access, cannot afford disk seek latency</li>
<li>Limited by available RAM, expensive to scale</li>
<li>Fastest reads and writes among all techniques</li>
<li>Cannot handle range queries efficiently</li>
<li>Durability achieved through WAL
<ul>
<li>Append-only log on disk</li>
<li>Easy writes as pointer always at end</li>
<li>Replay log to rebuild hashmap after crash</li>
</ul>
</li>
</ul>
<h2 id="2-b-trees"><a class="header" href="#2-b-trees">2. B-Trees</a></h2>
<ul>
<li>Self-balancing tree structure stored on disk</li>
<li>No size limitation since disk-based</li>
<li>Durability is inherent, less complex to manage</li>
<li>Slower reads than hash index due to disk access</li>
<li>Read complexity is O(logN)</li>
<li>Write operations are slow due to tree rebalancing</li>
<li>Excellent for range queries due to sorted tree structure</li>
<li>Durability strategy
<ul>
<li>Avoid in-place updates</li>
<li>Write to separate pages first</li>
<li>Update references atomically afterward</li>
</ul>
</li>
</ul>
<h2 id="3-lsm-tree-with-sstable"><a class="header" href="#3-lsm-tree-with-sstable">3. LSM Tree with SSTable</a></h2>
<h3 id="core-structure"><a class="header" href="#core-structure">Core Structure</a></h3>
<ul>
<li>In-memory balanced tree called Memtable</li>
<li>Uses AVL or Red-Black tree implementation</li>
<li>Memtable flushes to disk as SSTable when threshold reached</li>
</ul>
<h3 id="performance-characteristics"><a class="header" href="#performance-characteristics">Performance Characteristics</a></h3>
<ul>
<li>Writes faster than B-Trees but slower than hash index</li>
<li>Reads slower than B-Trees</li>
<li>Must check Memtable first then all SSTables</li>
<li>Range queries slower due to scattered data across SSTables</li>
</ul>
<h3 id="durability-and-storage"><a class="header" href="#durability-and-storage">Durability and Storage</a></h3>
<ul>
<li>WAL handles crash recovery</li>
<li>Replay WAL to restore Memtable state</li>
<li>SSTables stored on disk removes memory size constraints</li>
<li>No practical limit on total keys stored</li>
</ul>
<h3 id="sstable-properties"><a class="header" href="#sstable-properties">SSTable Properties</a></h3>
<ul>
<li>Sorted by key</li>
<li>Immutable once written</li>
<li>Never modified in place</li>
</ul>
<h3 id="read-path"><a class="header" href="#read-path">Read Path</a></h3>
<ul>
<li>Check Memtable first</li>
<li>Search SSTables from newest to oldest</li>
<li>Stop when key found</li>
</ul>
<h3 id="delete-operation"><a class="header" href="#delete-operation">Delete Operation</a></h3>
<ul>
<li>Tombstone marker written as value</li>
<li>Added to latest SSTable</li>
<li>Actual removal happens during compaction</li>
</ul>
<hr>
<h2 id="lsm-optimizations"><a class="header" href="#lsm-optimizations">LSM Optimizations</a></h2>
<h3 id="sparse-index"><a class="header" href="#sparse-index">Sparse Index</a></h3>
<ul>
<li>Index containing subset of SSTable keys</li>
<li>Stores memory location for indexed keys</li>
<li>Binary search locates keys between indexed entries</li>
<li>Reduces memory overhead compared to full index</li>
</ul>
<h3 id="bloom-filters"><a class="header" href="#bloom-filters">Bloom Filters</a></h3>
<ul>
<li>Probabilistic data structure per SSTable</li>
<li>Answers whether key possibly exists or definitely absent</li>
<li>Avoids unnecessary SSTable reads for missing keys</li>
</ul>
<h3 id="compaction"><a class="header" href="#compaction">Compaction</a></h3>
<ul>
<li>Background process merging multiple SSTables</li>
<li>O(N) time complexity</li>
<li>Removes duplicate and deleted keys</li>
<li>Reduces total SSTable count</li>
<li>Trade-off is CPU overhead affecting foreground operations</li>
</ul>
<hr>
<h2 id="lsm-write-flow"><a class="header" href="#lsm-write-flow">LSM Write Flow</a></h2>
<h3 id="step-1-incoming-write"><a class="header" href="#step-1-incoming-write">Step 1: Incoming Write</a></h3>
<ul>
<li>Key-value pair arrives at LSM Tree</li>
<li>Written to active Memtable in sorted order</li>
<li>Simultaneously appended to WAL for durability</li>
</ul>
<h3 id="step-2-memtable-flush-trigger"><a class="header" href="#step-2-memtable-flush-trigger">Step 2: Memtable Flush Trigger</a></h3>
<ul>
<li>Memtable reaches size threshold</li>
<li>Current Memtable frozen, no new writes accepted</li>
<li>New empty Memtable created for incoming writes</li>
<li>Frozen Memtable flushed to disk as immutable SSTable</li>
<li>Flush happens in background, non-blocking</li>
</ul>
<h3 id="step-3-continuous-operation"><a class="header" href="#step-3-continuous-operation">Step 3: Continuous Operation</a></h3>
<ul>
<li>New writes target active Memtable only</li>
<li>Never written directly to existing SSTables</li>
<li>Multiple SSTables accumulate over time</li>
</ul>
<h3 id="step-4-compaction-process"><a class="header" href="#step-4-compaction-process">Step 4: Compaction Process</a></h3>
<ul>
<li>Triggered as SSTable count grows</li>
<li>Merges multiple SSTables into fewer larger ones</li>
<li>Discards overwritten key versions</li>
<li>Removes tombstoned deletions</li>
<li>Output is sorted, compacted SSTables</li>
<li>Improves read performance by reducing files to search</li>
</ul>
<h2 id="question-1-why-lsm-tree-has-better-write-speed-than-b-tree"><a class="header" href="#question-1-why-lsm-tree-has-better-write-speed-than-b-tree">Question 1: Why LSM Tree has better write speed than B-Tree</a></h2>
<h3 id="b-tree-write-process"><a class="header" href="#b-tree-write-process">B-Tree Write Process</a></h3>
<ul>
<li>B-Tree stores data directly on disk in sorted order</li>
<li>Every write requires finding correct position in tree</li>
<li>May trigger node splits when nodes overflow</li>
<li>Node split causes multiple disk writes</li>
<li>Updates happen in-place requiring random disk seeks</li>
<li>Random I/O is slow on disk</li>
</ul>
<h3 id="lsm-tree-write-process"><a class="header" href="#lsm-tree-write-process">LSM Tree Write Process</a></h3>
<ul>
<li>Writes go to in-memory Memtable first</li>
<li>Memory writes are extremely fast</li>
<li>WAL append is sequential disk write</li>
<li>Sequential I/O is much faster than random I/O</li>
<li>No immediate disk structure modification</li>
<li>SSTable flush is one sequential bulk write</li>
<li>No in-place updates ever</li>
</ul>
<h3 id="key-difference-summary"><a class="header" href="#key-difference-summary">Key Difference Summary</a></h3>
<ul>
<li>B-Tree does random writes to disk on every operation</li>
<li>LSM Tree batches writes in memory then does sequential disk writes</li>
<li>Sequential writes can be 100x faster than random writes on HDD</li>
<li>LSM trades immediate disk consistency for write throughput</li>
</ul>
<h3 id="interview-one-liner"><a class="header" href="#interview-one-liner">Interview One-Liner</a></h3>
<p>LSM Tree converts random writes into sequential writes by buffering in memory and
flushing sorted batches, while B-Tree must perform random disk seeks for every write to maintain sorted structure.</p>
<hr>
<h2 id="question-2-why-hash-index-cannot-do-range-queries-but-b-tree-and-lsm-can"><a class="header" href="#question-2-why-hash-index-cannot-do-range-queries-but-b-tree-and-lsm-can">Question 2: Why Hash Index cannot do range queries but B-Tree and LSM can</a></h2>
<h3 id="hash-index-structure"><a class="header" href="#hash-index-structure">Hash Index Structure</a></h3>
<ul>
<li>Keys stored based on hash function output</li>
<li>Hash function distributes keys randomly across buckets</li>
<li>Key “A” and key “B” may be in completely different locations</li>
<li>No ordering relationship preserved</li>
<li>To find keys between X and Y, must scan entire hashmap</li>
<li>Full scan defeats purpose of index</li>
</ul>
<h3 id="b-tree-structure"><a class="header" href="#b-tree-structure">B-Tree Structure</a></h3>
<ul>
<li>Keys stored in sorted order within tree nodes</li>
<li>Left subtree contains smaller keys</li>
<li>Right subtree contains larger keys</li>
<li>Leaf nodes often linked for sequential access</li>
<li>Range query process
<ul>
<li>Find start key using tree traversal</li>
<li>Follow leaf node links until end key</li>
<li>All keys in range are adjacent</li>
</ul>
</li>
</ul>
<h3 id="lsm-tree-structure"><a class="header" href="#lsm-tree-structure">LSM Tree Structure</a></h3>
<ul>
<li>Memtable is sorted balanced tree</li>
<li>Each SSTable is sorted by key</li>
<li>Range query process
<ul>
<li>Scan range in Memtable</li>
<li>Scan range in each SSTable</li>
<li>Merge results from all sources</li>
</ul>
</li>
<li>Sorting preserved at every level</li>
</ul>
<h3 id="core-insight"><a class="header" href="#core-insight">Core Insight</a></h3>
<ul>
<li>Range queries require data locality</li>
<li>Nearby keys must be stored nearby</li>
<li>Hash function destroys this locality</li>
<li>Tree structures preserve key ordering</li>
</ul>
<h3 id="interview-one-liner-1"><a class="header" href="#interview-one-liner-1">Interview One-Liner</a></h3>
<p>Hash functions deliberately scatter keys randomly for uniform distribution, destroying any ordering relationship.
B-Trees and LSM Trees maintain sorted order, so adjacent keys are stored together, making range scans a simple sequential read.</p>
<hr>
<h2 id="question-3-comparison-of-all-three-for-range-queries"><a class="header" href="#question-3-comparison-of-all-three-for-range-queries">Question 3: Comparison of all three for range queries</a></h2>
<h3 id="hash-index-range-query"><a class="header" href="#hash-index-range-query">Hash Index Range Query</a></h3>
<ul>
<li>Complexity is O(N) where N is total keys</li>
<li>Must check every bucket</li>
<li>No early termination possible</li>
<li>Completely impractical for large datasets</li>
</ul>
<h3 id="b-tree-range-query"><a class="header" href="#b-tree-range-query">B-Tree Range Query</a></h3>
<ul>
<li>Find start key in O(logN)</li>
<li>Traverse leaf nodes sequentially</li>
<li>Total complexity O(logN + K) where K is result size</li>
<li>Single structure to search</li>
<li>Most efficient for range queries</li>
</ul>
<h3 id="lsm-tree-range-query"><a class="header" href="#lsm-tree-range-query">LSM Tree Range Query</a></h3>
<ul>
<li>Must check Memtable and all SSTables</li>
<li>Each SSTable searched independently</li>
<li>Results merged from multiple sources</li>
<li>More I/O operations than B-Tree</li>
<li>Complexity O(logN + K) per SSTable</li>
<li>Compaction reduces SSTable count to improve this</li>
</ul>
<h3 id="why-b-tree-wins-for-range-queries"><a class="header" href="#why-b-tree-wins-for-range-queries">Why B-Tree wins for range queries</a></h3>
<ul>
<li>Data in single sorted structure</li>
<li>One sequential scan after finding start</li>
<li>No merge step required</li>
<li>Leaf nodes often physically sequential on disk</li>
</ul>
<h3 id="why-lsm-tree-is-slower-for-range-queries"><a class="header" href="#why-lsm-tree-is-slower-for-range-queries">Why LSM Tree is slower for range queries</a></h3>
<ul>
<li>Data spread across multiple SSTables</li>
<li>Same key range exists in multiple files</li>
<li>Must read from all and merge</li>
<li>Merge operation adds CPU overhead</li>
<li>More disk seeks across files</li>
</ul>
<h3 id="interview-one-liner-2"><a class="header" href="#interview-one-liner-2">Interview One-Liner</a></h3>
<p>B-Tree stores all data in one sorted structure allowing single sequential scan.
LSM Tree spreads data across Memtable and multiple SSTables requiring parallel
scans and merge operations, adding I/O and CPU overhead for range queries.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="abstraction"><a class="header" href="#abstraction">Abstraction</a></h1>
<p>Abstraction focuses on implementation hiding providing the user with
a simple interface to interact with the object.User does not need to
know internal working of the object just need to know the behaviour
of the object. A class has the behaviour(methods) and properties(variables)
of the object.</p>
<pre><code class="language-py">from abc import ABC, abstractmethod


class Car(
    ABC
):  # interface defining the methods , methods are to be implemented by class implementing this abstract class
    @abstractmethod
    def start(self):
        pass

    @abstractmethod
    def accelerate(self):
        pass

    @abstractmethod
    def deccelerate(self):
        pass

    @abstractmethod
    def stop(self):
        pass


class SportsCar(Car):
    def __init__(self) -&gt; None:
        self.curr_speed = 0
        self.isEngineOn = False

    def start(self):
        self.isEngineOn = True
        print("car engine is on")

    def stop(self):
        self.curr_speed = 0
        self.isEngineOn = False
        print("car stoppped")

    def accelerate(self):
        self.curr_speed += 20
        print(f"car is moving at speed of {self.curr_speed}km/h")

    def deccelerate(self):
        self.curr_speed -= 20
        print(f"car is moving at speed of {self.curr_speed}km/h")


if __name__ == "__main__":
    spc = SportsCar()

    spc.start()
    spc.accelerate()
    spc.accelerate()
    spc.accelerate()
    spc.deccelerate()
    spc.accelerate()
    spc.stop()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="encapsulation"><a class="header" href="#encapsulation">Encapsulation</a></h1>
<p>Encapsulation is about bundling data and methods to protect the data
It deals with data security.
In python we can use access modifier to do data security
private methods/variables are prefixed with double underscore [can be only accessed within a class]
normally privated variable modification/viewing are done by using getter and setter
protected methods/variables are prefixed with single underscore [can be only accessed within a class and child classes]</p>
<pre><code class="language-py">import uuid


class BankAccount:
    def __init__(self, initial_amount: float) -&gt; None:
        self.__acount_number: uuid.UUID = uuid.uuid4()
        self.__curr_balance = initial_amount
        self.public_var = "sds"
        self._protected_var = "sds"

    def deposit(self, amount: float):
        if amount &gt; 0:
            self.__curr_balance += amount
            print(f"Deposited ${amount}. New balance: ${self.__curr_balance}")
        else:
            print("Invalid deposit amount.")

    def withdraw(self, amount: float):
        if self.__curr_balance - amount &gt; 0:
            self.__curr_balance -= amount
            print(
                f"Successfuly withdrawn {amount}. New balance: ${self.__curr_balance}"
            )
        else:
            print(f"Insufficient funds.Cannot withdraw {amount}.")

    def get_acc_details(self):  # Using getter to access private variables
        print("Acc no:", self.__acount_number)
        print("Curr bal:", self.__curr_balance)


class TestChildClass(BankAccount):
    def __init__(self, initial_amount: float) -&gt; None:
        super().__init__(
            initial_amount
        )  # Must invoke the constructor of parent to access methods/variables

    def test(self):
        print(self.public_var)
        print(self._protected_var)
        self.withdraw(10)
        super().withdraw(10)


if __name__ == "__main__":
    acc = BankAccount(1000)
    acc.deposit(100)
    acc.deposit(100)
    acc.withdraw(100)
    acc.withdraw(10000)
    acc.get_acc_details()

    tc = TestChildClass(100)
    tc.test()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="inheritance"><a class="header" href="#inheritance">Inheritance</a></h1>
<p>In Inheritance a child class inherits the properties and methods
of its parent class.Child class has access to all methods of
the parent class and on the top of that they can have their own
methods too.Python uses MRO (Method Resolution order) to determine
ordering of methods whithout ambiguity.MRO uses c3 linearization algo
under the hood</p>
<pre><code class="language-py">class Car:
    def __init__(self, model: str, brand: str) -&gt; None:
        self.model = model
        self.brand = brand
        self.isEngineOn = False

    def start(self):
        self.isEngineOn = True

    def stop(self):
        self.isEngineOn = False


class ManualCar(Car):
    def __init__(self, model: str, brand: str) -&gt; None:
        super().__init__(model, brand)

    def shift_gear(self):  # Own specific methods
        print("gear shifted")


class Electric(Car):
    def __init__(self, model: str, brand: str) -&gt; None:
        self.battery = 100
        super().__init__(model, brand)

    def charge_battery(self):  # Own specific methods
        print("battery charged!")


if __name__ == "__main__":
    mc = ManualCar("audi", "a8")
    ec = Electric("byd", "seal")

    mc.start()
    mc.shift_gear()
    mc.stop()

    ec.charge_battery()
    ec.start()
    ec.stop()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="polymorphism"><a class="header" href="#polymorphism">Polymorphism</a></h1>
<p>Polymorphism means abilty to exists in different form
We have mainly 2 types of polymorphism</p>
<ul>
<li>Dynamic -&gt; method overriding (child class define their own method implementation)</li>
<li>Static -&gt; method overloading (a single class has multi methods with same name,return type but differnt args),operator overloading</li>
</ul>
<pre><code class="language-py">from abc import ABC, abstractmethod


class Car(ABC):
    def __init__(self, brand: str, model: str) -&gt; None:
        self.brand = brand
        self.model = model
        self.isEngineOn = False
        self.speed = 0

    def start(self):
        self.isEngineOn = True

    def stop(self):
        self.isEngineOn = False
        self.speed = 0

    @abstractmethod
    def accelerate(
        self,
    ):  # Dynamic Polymorphism child class should implement this method
        pass

    # def accelerate(
    #     self, speed: float
    # ):  # Dynamic + Static Polymorphism child class should implement this [not supported in python]
    #     pass


class ManualCar(Car):
    def __init__(self, brand: str, model: str) -&gt; None:
        super().__init__(brand, model)

    def accelerate(self):  # Dynamic polymorphism
        self.speed += 10
        print(
            f"{self.brand}{self.model} currently moving at speed at {self.speed}km/hr"
        )


class ElectricCar(Car):
    def __init__(self, brand: str, model: str) -&gt; None:
        self.battery = 100
        super().__init__(brand, model)

    def accelerate(self):  # Dynamic polymorphism
        self.speed += 10
        self.battery -= 1
        print(
            f"{self.brand}{self.model} currently moving at speed at {self.speed}km/hr, battery :{self.battery}%"
        )


if __name__ == "__main__":
    mc = ManualCar("audi", "a8")
    mc.start()
    mc.accelerate()
    mc.accelerate()
    mc.stop()

    ec = ElectricCar("byd", "seal")
    ec.start()
    ec.accelerate()
    ec.accelerate()
    ec.stop()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="uml"><a class="header" href="#uml">UML</a></h1>
<h3 id="types-of-diagram-most-commonly-used"><a class="header" href="#types-of-diagram-most-commonly-used">Types of diagram (most commonly used)</a></h3>
<ul>
<li><strong>Structural</strong> (class diagrams represent classes and their relationships)</li>
<li><strong>Behaviour</strong> (sequence diagrams show how different objects interact with each other)</li>
</ul>
<h2 id="class-diagram"><a class="header" href="#class-diagram">Class Diagram</a></h2>
<p><img src="class_diag.png" alt="Class_Diagram"></p>
<ul>
<li>User <code>+</code> for public member/method</li>
<li>User <code>-</code> for private member/method</li>
<li>User <code>#</code> for protected member/method</li>
</ul>
<h3 id="association-types"><a class="header" href="#association-types">Association Types</a></h3>
<ul>
<li>
<p><strong>Class Association</strong></p>
<ul>
<li><strong>Inheritance (extends) (is-a relation)</strong>
<ul>
<li>Example: Example: A dog is a animal,A cat is a animal.</li>
</ul>
</li>
</ul>
<p><img src="inheritance.png" alt="Inheritance"></p>
</li>
<li>
<p><strong>Object Association (has-a/uses-a relationship)</strong></p>
<ul>
<li>
<p><strong>Simple</strong> : A general relationship between two classes where one class uses or interacts with another.</p>
<ul>
<li><strong>Example</strong> : XYZ person has a house</li>
<li><strong>Example</strong> : XYZ person has a car</li>
<li><strong>Example</strong> : Customer and Order</li>
<li><strong>Example</strong> : Student and Course</li>
</ul>
</li>
<li>
<p><strong>Aggregation</strong> : In this type of relation we have a parent/aggregator object inside which we have small objects.
Each components in this relation can exist individually.</p>
<ul>
<li><strong>Example</strong> : A room consisits of sofa,bed,chair.A library has books. Each components can exist individually.</li>
<li><strong>Example</strong> : A sports team consisting of players</li>
<li><strong>Example</strong> : A car has an engine, but the engine can exist independently and be used in different cars.</li>
</ul>
</li>
<li>
<p><strong>Composition</strong> : In this type of relation we have a main object,and some other small objects,these small objects
cannot exist individually without the main object.</p>
<ul>
<li><strong>Example</strong> : A house is made up of rooms, and if the house is destroyed, the rooms cease to exist as well.</li>
<li><strong>Example</strong> : Parts of a chair -&gt; arms,wheels</li>
<li><strong>Example</strong> : A human body contains a heart. If the body is no longer alive, the heart cannot function independently.</li>
<li><strong>Example</strong> : A computer consists of a motherboard. If the computer is dismantled, the motherboard is no longer part of a functioning system.</li>
</ul>
</li>
</ul>
<p><img src="association.png" alt="Association"></p>
</li>
</ul>
<h2 id="sequence-diagram"><a class="header" href="#sequence-diagram">Sequence Diagram</a></h2>
<ul>
<li><strong>Lifeline</strong> : Lifeline indicates the existence of an object over time during the interaction</li>
<li><strong>Activation bar</strong> : Indicates the period during which an object is active</li>
</ul>
<p><img src="activation_bar_lifeline.png" alt="SeqDiagBasic"></p>
<blockquote>
<p>Types of messages</p>
</blockquote>
<ul>
<li><strong>Synchronous message</strong></li>
<li><strong>Asynchronous message</strong></li>
</ul>
<p><img src="message.png" alt="SeqDiagMessage1"></p>
<ul>
<li><strong>Create Msg</strong></li>
<li><strong>Destroy Msg</strong></li>
</ul>
<p><img src="create_destroy_msg.png" alt="SeqDiagMessage2"></p>
<ul>
<li><strong>Lost Msg</strong></li>
<li><strong>Found Msg</strong></li>
</ul>
<p><img src="lost_found_msg.png" alt="SeqDiagMessage3"></p>
<h3 id="basic-sequence-diagram-of-atm-transaction"><a class="header" href="#basic-sequence-diagram-of-atm-transaction">Basic Sequence Diagram of ATM transaction</a></h3>
<ul>
<li>User will insert card</li>
<li>ATM will ask for pin</li>
<li>User will enter pin</li>
<li>if wrong pin inserted then end</li>
<li>if right pin inserted then validate pin with bank</li>
<li>atm asks select transaction type</li>
<li>user enters withdraw</li>
<li>atm speak with bank server and checks amount availibility</li>
<li>if available create transaction &amp; dispense cash</li>
<li>if not available end</li>
</ul>
<p>@startuml
skinparam defaultFontSize 20
skinparam ParticipantPadding 20
skinparam Shadowing false
skinparam SequenceMessageAlign center
skinparam participantNameAlignment top</p>
<p>participant User as “ATM User”
participant ATM as “ATM Machine”
participant Transaction as “Transaction”
participant Bank as “Bank Server”</p>
<p>activate ATM
activate User
User -&gt; ATM : Insert Card
ATM -&gt; User : Request PIN
User -&gt; ATM : Enter PIN</p>
<p>activate Bank
ATM -&gt; Bank : Validate PIN</p>
<p>alt#Gold #LightBlue Correct PIN
Bank -&gt; ATM : PIN Validated</p>
<pre><code>activate Transaction
ATM -&gt; Transaction : &lt;&lt;Create Transaction&gt;&gt;
Transaction -&gt; ATM : Get Transaction Type

ATM -&gt; User : Select Transaction Type
User -&gt; ATM : Request Withdraw Cash

ATM -&gt; Transaction : Check Cash Availability
Transaction -&gt; Bank : Check Cash Availability

alt#Gold #Orange Cash Available
    Bank -&gt; Transaction : Cash is Available
    Transaction -&gt; ATM : Cash is Available
    ATM -&gt; User : Dispense Cash
    User -&gt; ATM : Collect Cash
    ATM -&gt; User : Eject Card
else #Grey Cash Unavailable
    Bank -&gt; Transaction : Cash is Unavailable
    Transaction -&gt; ATM : Cash is Unavailable
    ATM -&gt; User : Eject Card
end

destroy Transaction
deactivate Transaction
</code></pre>
<p>else #Pink Wrong PIN
Bank -&gt; ATM : Wrong PIN Entered
ATM -&gt; User : Eject Card
end</p>
<p>deactivate Bank
deactivate ATM
deactivate User</p>
<p>@enduml</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="single-responsibility-principle"><a class="header" href="#single-responsibility-principle">Single Responsibility Principle</a></h1>
<p>SRP states that a class should do only one thing.
It should have only one reason to change such that
if in the future we need to add some feature we can
easily do it without affecting other parts of the system.
We typically use composition when following this principle.
We basically break down functionailites into different classes,
and each class will be responsible for one thing only and
it may have reference of some other class to fulfill its
responsibilities. (composition is used)</p>
<blockquote>
<p>SRP violated</p>
</blockquote>
<p>Below i have taken an example of a payment processor,
which is now handling multiple responsibilites like
process payment,handle refund,send receipt.Now its
completely violating SRP as it has 3 reasons to change
because if payment processor changes(e.g., from Stripe to PayPal) process_payment methods needs
to be changed,if refund policy changes then handle_refund
needs to be changed,if email service changes(e.g., from SendGrid to Mailgun), then send receipt
needs to be changed.
Violating SRP as it handles multiple responsibilites</p>
<pre><code class="language-py">class PaymentGateway:
    def process_payment(self, amount):
        # code to process payment using a specific payment processor
        pass

    def handle_refund(self, amount):
        # code to handle refund using a specific refund policy
        pass

    def send_receipt(self, email):
        # code to send receipt via email
        pass
</code></pre>
<blockquote>
<p>SRP Followed</p>
</blockquote>
<pre><code class="language-py">class PaymentProcessor:
    def process_payment(self, amount):
        # code to process payment using a specific payment processor
        pass


class RefundHandler:
    def handle_refund(self, amount):
        # code to handle refund using a specific refund policy
        pass


class EmailService:
    def send_receipt(self, email):
        # code to send receipt via email
        pass


# PaymentGateway class acts as a facade, providing a simple interface to the other classes, while still maintaining the SRP.
class PaymentGateway:
    def __init__(self, payment_processor, refund_handler, email_service):
        self.payment_processor = payment_processor
        self.refund_handler = refund_handler
        self.email_service = email_service

    def process_payment(self, amount):
        self.payment_processor.process_payment(amount)

    def handle_refund(self, amount):
        self.refund_handler.handle_refund(amount)

    def send_receipt(self, email):
        self.email_service.send_receipt(email)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="open-close-principle"><a class="header" href="#open-close-principle">Open close principle</a></h1>
<p>Open close principle states that a class should be Open
for extension but close for modification.
This means that you should be able to add new functionality to a class
without changing its existing code.</p>
<blockquote>
<p>OCP violated</p>
</blockquote>
<p>In below example in PaymentProcessor everytime we need to add a new
payment processor we need to modify existing code of PaymentProcessor
class.For following OCP we should be able to integrate new payment
processor whithout modifying existing code</p>
<pre><code class="language-py">class PaymentProcessor:
    def process_payment(self, amount: float, payment_method: str):
        if payment_method == "stripe":
            # code to process payment using Stripe
            pass
        elif payment_method == "paypal":
            # code to process payment using PayPal
            pass


class RefundHandler:
    def handle_refund(self, amount: float):
        # code to handle refund using a specific refund policy
        pass


class EmailService:
    def send_receipt(self, email: str):
        # code to send receipt via email
        pass


class PaymentGateway:
    def __init__(
        self,
        payment_processor: PaymentProcessor,
        refund_handler: RefundHandler,
        email_service: EmailService,
    ):
        self.payment_processor = payment_processor
        self.refund_handler = refund_handler
        self.email_service = email_service

    def process_payment(self, amount: float, payment_method: str):
        if payment_method == "stripe":
            # code to process payment using Stripe
            pass
        elif payment_method == "paypal":
            # code to process payment using PayPal
            pass

    def handle_refund(self, amount: float):
        self.refund_handler.handle_refund(amount)

    def send_receipt(self, email: str):
        self.email_service.send_receipt(email)
</code></pre>
<blockquote>
<p>OCP follwed</p>
</blockquote>
<p>Now, OCP is satisfied:</p>
<ul>
<li>The PaymentGateway class is open for extension because we can add new payment methods without changing its code.</li>
<li>The PaymentGateway class is closed for modification because we don’t need to change its existing code to add new functionality.</li>
</ul>
<pre><code class="language-py">from abc import ABC, abstractmethod


class PaymentProcessor(ABC):
   @abstractmethod
   def process_payment(self, amount: float):
       pass


class StripePaymentProcessor(PaymentProcessor):
   def process_payment(self, amount: float):
       pass


class PaypalPaymentProcessor(PaymentProcessor):
   def process_payment(self, amount: float):
       pass


class UPIPaymentProcessor(PaymentProcessor):
   def process_payment(self, amount: float):
       pass


class RefundHandler:
   def handle_refund(self, amount: float):
       # code to handle refund using a specific refund policy
       pass


class EmailService:
   def send_receipt(self, email: str):
       # code to send receipt via email
       pass


class PaymentGateway:
   def __init__(
       self,
       payment_processor: PaymentProcessor,
       refund_handler: RefundHandler,
       email_service: EmailService,
   ):
       self.payment_processor = payment_processor
       self.refund_handler = refund_handler
       self.email_service = email_service

   def process_payment(self, amount: float):
       self.payment_processor.process_payment(amount)

   def handle_refund(self, amount):
       self.refund_handler.handle_refund(amount)

   def send_receipt(self, email):
       self.email_service.send_receipt(email)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="liskov-substituition-principle"><a class="header" href="#liskov-substituition-principle">Liskov Substituition Principle</a></h1>
<p>LSP states that we should be able to replace a base class
with its child class easily without breaking any part of
the system. A child class should always extend the features
of its parent class but it should not narrow down the features
of its parent class.</p>
<blockquote>
<p>LSP violated</p>
</blockquote>
<p>Below i have taken an example of bank account,A bank account
is an abstract class from which we have 3 child class implementing
it.We have a savings account,salary account and fixed deposit account.
But one thing to consider that a fixed deposit account does not have
withdraw functionality in real life but we are overrding the method
but not implementing it just throwing an error but this breaks LSP
because when the client will call its withdraw function it will get an
error.</p>
<pre><code class="language-py">from abc import ABC, abstractmethod


class BankAccount(ABC):
    @abstractmethod
    def deposit(self):
        pass

    @abstractmethod
    def withdraw(self):
        pass


class SavingsAcount(BankAccount):
    def deposit(self):
        pass

    def withdraw(self):
        pass


class SalaryAcount(BankAccount):
    def deposit(self):
        pass

    def withdraw(self):
        pass


class FixedTermAccound(BankAccount):
    def deposit(self):
        pass

    def withdraw(self):
        raise Exception("cannot withdraw from fixed account")


class BankAccountClient:
    def __init__(self) -&gt; None:
        self.accounts: list[BankAccount] = []

    def add_bank_account(self, account: BankAccount):
        self.accounts.append(account)

    def withdraw_from_all(self):
        for account in self.accounts:
            # Will get an exception for fixed deposit accounts
            # Wrong way of handling it and breaks LSP
            if isinstance(account, FixedTermAccound):
                continue
            else:
                account.withdraw()
</code></pre>
<blockquote>
<p>LSP followed</p>
</blockquote>
<pre><code class="language-py">from abc import ABC, abstractmethod


class DepositableBankAccount(ABC):
    @abstractmethod
    def deposit(self):
        pass


class WithdrawableBankAccount(DepositableBankAccount, ABC):
    @abstractmethod
    def withdraw(self):
        pass


class SavingsAcount(WithdrawableBankAccount):
    def deposit(self):
        pass

    def withdraw(self):
        pass


class SalaryAcount(WithdrawableBankAccount):
    def deposit(self):
        pass

    def withdraw(self):
        pass


class FixedTermAccound(DepositableBankAccount):
    def deposit(self):
        pass


class BankAccountClient:
    def __init__(self) -&gt; None:
        self.withdrwable_accounts: list[WithdrawableBankAccount] = []
        self.depositable_accounts: list[DepositableBankAccount] = []

    def add_withdrawable_bank_account(self, account: WithdrawableBankAccount):
        self.withdrwable_accounts.append(account)

    def add_depositable_bank_account(self, account: DepositableBankAccount):
        self.depositable_accounts.append(account)

    def withdraw_from_all(self):
        # Following LSP
        for account in self.withdrwable_accounts:
            account.withdraw()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="lsp-signature-rule"><a class="header" href="#lsp-signature-rule">LSP Signature Rule</a></h1>
<h3 id="method-argument-rule"><a class="header" href="#method-argument-rule">Method argument rule</a></h3>
<p>When overriding methods in subclasses, the types of the method arguments must be the
same or broader than those in the parent class (contravariance).
Narrowing them breaks substitutability and violates LSP.</p>
<blockquote>
<p>Method argument rule violated</p>
</blockquote>
<pre><code class="language-py">class Animal:
    def eat(self, food: str):
        print(f"Eating {food}")


class Bone:
    def __str__(self):
        return "a bone"


class Dog(Animal):
    # Narrowed argument type: only accepts "Bone" objects
    def eat(self, food: "Bone"):  #  Not LSP-compliant
        print(f"Dog chewing {food}")


if __name__ == "__main__":
    b = Bone()
    d = Dog()
    d.eat(b)
</code></pre>
<blockquote>
<p>Method argument rule followed</p>
</blockquote>
<pre><code class="language-py">class Animal:
    def eat(self, food: str):
        print(f"Eating {food}")


class Dog(Animal):
    # broader argument type
    def eat(self, food: str):  #  LSP-compliant
        print(f"Dog chewing {food}")


if __name__ == "__main__":
    d = Dog()
    d.eat("a bone")
</code></pre>
<h3 id="method-return-type-rule"><a class="header" href="#method-return-type-rule">Method return type rule</a></h3>
<p>When overriding methods in subclasses, the return type must be the same as,
or a narrowed down type, the parent’s return type. Returning a broader
or unrelated type breaks substitutability and violates LSP.</p>
<blockquote>
<p>Method return type violated</p>
</blockquote>
<pre><code class="language-py">from abc import ABC, abstractmethod


class Organism:
    def __str__(self):
        return "Organism"


class Animal(Organism):
    def __str__(self):
        return "Generic Animal"


class Dog(Animal):
    def __str__(self):
        return "Dog"


class Cat(Animal):
    def __str__(self):
        return "Cat"


class AnimalFeeder(ABC):
    # Parent contract:
    # - Argument: can feed ANY Animal
    # - Return: gives back an Animal
    @abstractmethod
    def feed(self, animal: Animal) -&gt; Animal:
        pass


class DogOnlyFeeder(AnimalFeeder):
    # Return Type Rule violated:
    # Parent promised -&gt; Animal
    # But child broadens it -&gt; Organism (superclass of Animal)
    def feed(self, animal: Animal) -&gt; Organism:
        if isinstance(animal, Dog):
            print(f"Feeding {animal}")
            return animal
        raise Exception("animal is not of type Dog")


if __name__ == "__main__":
    d = Dog()
    c = Cat()
    df = DogOnlyFeeder()
    df.feed(d)
</code></pre>
<blockquote>
<p>Method return type followed</p>
</blockquote>
<pre><code class="language-py">from abc import ABC, abstractmethod


class Organism:
    def __str__(self):
        return "Organism"


class Animal(Organism):
    def __str__(self):
        return "Generic Animal"


class Dog(Animal):
    def __str__(self):
        return "Dog"


class Cat(Animal):
    def __str__(self):
        return "Cat"


class AnimalFeeder(ABC):
    # Parent contract:
    # - Argument: can feed ANY Animal
    # - Return: gives back an Animal
    @abstractmethod
    def feed(self, animal: Animal) -&gt; Animal:
        pass


class DogOnlyFeeder(AnimalFeeder):
    # Return Type Rule follwed:
    # Parent promised -&gt; Animal
    # But child narrows it
    def feed(self, animal: Animal) -&gt; Dog:
        if isinstance(animal, Dog):
            print(f"Feeding {animal}")
            return animal
        raise Exception("animal is not of type Dog")


if __name__ == "__main__":
    d = Dog()
    c = Cat()
    df = DogOnlyFeeder()
    df.feed(d)
</code></pre>
<h3 id="exception-rule"><a class="header" href="#exception-rule">Exception rule</a></h3>
<p>When overriding a method in a subclass , it should not throw new exceptions or broader exceptions than its base class.
It may throw fewer or narrower ones. Doing otherwise breaks Liskov Substitution Principle.</p>
<blockquote>
<p>Exception rule violated</p>
</blockquote>
<pre><code class="language-py">class AnimalFeeder:
    def feed(self, food: str) -&gt; None:
        if food == "":
            raise ValueError("Food cannot be empty")
        print(f"Feeding animal with {food}")


class ExoticAnimalFeeder(AnimalFeeder):
    def feed(self, food: str) -&gt; None:
        if food == "":
            # Broader exception than parent promised
            raise Exception("Something went wrong: no food!")
</code></pre>
<blockquote>
<p>Exception rule followed</p>
</blockquote>
<pre><code class="language-py">class AnimalFeeder:
    def feed(self, food: str) -&gt; None:
        if food == "":
            raise ValueError("Food cannot be empty")
        print(f"Feeding animal with {food}")


class CarefulExoticAnimalFeeder(AnimalFeeder):
    def feed(self, food: str) -&gt; None:
        if food == "":
            # Same exception type as parent, still safe
            raise ValueError("Food cannot be empty")
        print(f"Feeding animal with {food}")
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="lsp-property-rule"><a class="header" href="#lsp-property-rule">LSP Property Rule</a></h1>
<h3 id="class-invariant-rule"><a class="header" href="#class-invariant-rule">Class Invariant Rule</a></h3>
<p>A class invariant is a condition (or set of properties) that must
always hold true for valid objects of that class.
A subclass must honor (preserve) all invariants of its parent.</p>
<blockquote>
<p>Class Invariant Rule violated</p>
</blockquote>
<pre><code class="language-py">class BankAccount:
    def __init__(self) -&gt; None:
        self.balance: int = 0

    def set_balance(self, b: int):
        # bank balance cannot be negative
        assert b &gt;= 0, "Dimensions must be non-negative"
        self.balance = b


class FunnyAccount(BankAccount):
    def __init__(self) -&gt; None:
        self.balance: int = 0

    def set_balance(self, b: int):
        # CIR violated as it allows negative balance as well
        self.balance = b
</code></pre>
<blockquote>
<p>Class Invariant Rule followed</p>
</blockquote>
<pre><code class="language-py">class BankAccount:
    def __init__(self) -&gt; None:
        self.balance: int = 0

    def set_balance(self, b: int):
        # bank balance cannot be negative
        assert b &gt;= 0, "Dimensions must be non-negative"
        self.balance = b


class FunnyAccount(BankAccount):
    def __init__(self) -&gt; None:
        self.balance: int = 0

    def set_balance(self, b: int):
        # bank balance cannot be negative
        assert b &gt;= 0, "Dimensions must be non-negative"
        self.balance = b
</code></pre>
<h3 id="history-constraint"><a class="header" href="#history-constraint">History Constraint</a></h3>
<p>A subclass must not change how the object’s state is supposed to evolve over time compared to its parent class.
Parent’s promise: “If you deposit, balance goes up. If you withdraw, balance goes down.”
Child must follow the same story.
The subclass can add harmless side quests but not change the behaviour by increasing balance
on withdrawing</p>
<blockquote>
<p>History Constraint violated</p>
</blockquote>
<pre><code class="language-py">class BankAccount:
    def __init__(self):
        self.balance = 0

    # Balance can only increase on deposit, or decrease on valid withdraw.

    def deposit(self, amount: int):
        assert amount &gt;= 0
        self.balance += amount

    def withdraw(self, amount: int):
        assert 0 &lt;= amount &lt;= self.balance
        self.balance -= amount

    def get_balance(self):
        return self.balance


class FunnyAccount(BankAccount):
    def withdraw(self, amount: int):
        # Breaks history: adds cashback surprise!
        super().withdraw(amount)
        self.balance += 1000  # Magical free bonus
</code></pre>
<blockquote>
<p>History Constraint followed</p>
</blockquote>
<pre><code class="language-py">class BankAccount:
    def __init__(self):
        self.balance = 0

    # Balance can only increase on deposit, or decrease on valid withdraw.

    def deposit(self, amount: int):
        assert amount &gt;= 0
        self.balance += amount

    def withdraw(self, amount: int):
        assert 0 &lt;= amount &lt;= self.balance
        self.balance -= amount

    def get_balance(self):
        return self.balance


class PremiumAccount(BankAccount):
    def __init__(self):
        super().__init__()
        self.reward_points = 0

    def withdraw(self, amount: int):
        super().withdraw(amount)
        # Adds side-effect: gives reward points,
        # but doesn't mess with balance history
        self.reward_points += amount // 10
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="lsp-method-rule"><a class="header" href="#lsp-method-rule">LSP Method Rule</a></h1>
<h3 id="pre-condition-rule"><a class="header" href="#pre-condition-rule">Pre condition rule</a></h3>
<p>A precondition is something that must be true before a method can be safely called.
When you override a method in a subclass:
You must not strengthen (make stricter) the preconditions.</p>
<blockquote>
<p>Precondition rule violated</p>
</blockquote>
<pre><code class="language-py">class User:
    def __init__(self) -&gt; None:
        self.pw = ""

    def set_password(self, pw: str):
        assert len(pw) &gt;= 8, "password must be greater than 8 characters"
        self.pw = pw


class AdminUser(User):
    def __init__(self) -&gt; None:
        super().__init__()

    def set_password(self, pw: str):
        # precondition rule broken as we have strengthened the condition
        assert len(pw) &gt;= 100, "password must be greater than 100 characters"
        self.pw = pw
</code></pre>
<blockquote>
<p>Precondition rule followed</p>
</blockquote>
<pre><code class="language-py">class User:
    def __init__(self) -&gt; None:
        self.pw = ""

    def set_password(self, pw: str):
        assert len(pw) &gt;= 8, "password must be greater than 8 characters"
        self.pw = pw


class AdminUser(User):
    def __init__(self) -&gt; None:
        super().__init__()

    def set_password(self, pw: str):
        # precondition rule followed as we have weakend the condition
        assert len(pw) &gt;= 16, "password must be greater than 6 characters"
        self.pw = pw

</code></pre>
<h3 id="post-condition-rule"><a class="header" href="#post-condition-rule">Post condition rule</a></h3>
<p>A postcondition defines what is guaranteed to hold after a method finishes.
When you override a method in a subclass:
You must not weaken (relax) the postconditions.
Subclasses must honor or strengthen the postconditions defined by their parent. They may
guarantee more, but they must never promise less.</p>
<blockquote>
<p>Post condition rule violated</p>
</blockquote>
<pre><code class="language-py">
class BankAccount:
    def __init__(self):
        self.balance = 0

    # When you deposit an amount amt then it get deposited
    def deposit(self, amount: int):
        if amount &lt; 0:
            raise ValueError("Deposit must be non-negative")
        self.balance += amount


class FunnyAccount(BankAccount):
    def deposit(self, amount: int):
        if amount &lt; 0:
            raise ValueError("Deposit must be non-negative")
        # Violates postcondition: only half is deposited!
        self.balance += amount // 2
</code></pre>
<blockquote>
<p>Post condition rule followed</p>
</blockquote>
<pre><code class="language-py">
class BankAccount:
    def __init__(self):
        self.balance = 0

    # When you deposit an amount amt then it get deposited
    def deposit(self, amount: int):
        if amount &lt; 0:
            raise ValueError("Deposit must be non-negative")
        self.balance += amount


class FunnyAccount(BankAccount):
    def deposit(self, amount: int):
        if amount &lt; 0:
            raise ValueError("Deposit must be non-negative")
        self.balance += amount
        # Stronger guarantee: add bonus interest too
        self.balance += 10
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="interface-segregation-principle"><a class="header" href="#interface-segregation-principle">Interface Segregation Principle</a></h1>
<h3 id="isp"><a class="header" href="#isp">ISP</a></h3>
<p>ISP states that we should not force our client to implement our interface
Instead of having one general purpose interface we should have multiple
client specific interface</p>
<blockquote>
<p>ISP violated</p>
</blockquote>
<pre><code class="language-py">from abc import ABC, abstractmethod


class Shape(ABC):
    @abstractmethod
    def area(self) -&gt; float:
        pass

    @abstractmethod
    def volume(self) -&gt; float:
        pass


class Rectange(Shape):
    def __init__(self, length: float, breadth: float) -&gt; None:
        self.l = length
        self.b = breadth

    def area(self) -&gt; float:
        return self.l * self.b

    # violates ISP as it forces client to implement an interface
    def volume(self) -&gt; float:
        raise Exception("Rectange does not support volume as its not a 3d shape")


class Cube(Shape):
    def __init__(self, side: float) -&gt; None:
        self.side = side

    def area(self) -&gt; float:
        return 6 * (self.side**2)

    def volume(self) -&gt; float:
        return self.side**3
</code></pre>
<blockquote>
<p>ISP followed</p>
</blockquote>
<p>Now we have segregated the interface into multiple
client specific interface,namely 2d shape and 3d
shape interfaces</p>
<pre><code class="language-py">from abc import ABC, abstractmethod


class TwoDShape(ABC):
    @abstractmethod
    def area(self) -&gt; float:
        pass


class ThreeDShape(ABC):
    @abstractmethod
    def volume(self) -&gt; float:
        pass

    @abstractmethod
    def area(self) -&gt; float:
        pass


class Rectangle(TwoDShape):
    def __init__(self, length: float, breadth: float):
        self.l = length
        self.b = breadth

    def area(self) -&gt; float:
        return self.l * self.b


class Cube(ThreeDShape):
    def __init__(self, side: float):
        self.side = side

    def area(self) -&gt; float:
        return 6 * (self.side**2)

    def volume(self) -&gt; float:
        return self.side**3
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="dependency-inversion-principle"><a class="header" href="#dependency-inversion-principle">Dependency Inversion Principle</a></h1>
<h3 id="dip"><a class="header" href="#dip">DIP</a></h3>
<p>DIP states that high level modules and low level modules
should interact with each other through an interface,
high level module should not depend on low level modules,
rather they should depend on interface.
If you want to do OCP then do DIP</p>
<blockquote>
<p>DIP violated</p>
</blockquote>
<pre><code class="language-py">class MongoDB:
    def save(self, data):
        print(f"Saving {data} into MongoDB")


class SQLDB:
    def save(self, data):
        print(f"Saving {data} into SQLDB")


class Client:
    # Client is heavily dependent on low level module details
    def __init__(self, mongo: MongoDB, sql: SQLDB) -&gt; None:
        self.mongo = mongo
        self.sql = sql

    def save_to_mongo(self, data):
        self.mongo.save(data)

    def save_to_sql(self, data):
        self.sql.save(data)
</code></pre>
<blockquote>
<p>DIP followed</p>
</blockquote>
<p>Now the high level module just need to know
about the contract/interface instead of being
heavily dependent on low level modules</p>
<pre><code class="language-py">from abc import ABC, abstractmethod


class Persistence(ABC):
    @abstractmethod
    def save(self, data):
        pass


class MongoDB(Persistence):
    def save(self, data):
        print(f"Saving {data} into MongoDB")


class SQLDB(Persistence):
    def save(self, data):
        print(f"Saving {data} into SQLDB")


class Client:
    def __init__(self, db: Persistence) -&gt; None:
        self.db = db

    def save(self, data):
        self.db.save(data)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="1_design_google_doc"><a href="#1_design_google_doc" class="header">1_Design_Google_Doc</a></h1>
<h3 id="requirement"><a class="header" href="#requirement">Requirement</a></h3>
<ul>
<li>User should able to add text,image</li>
<li>Design in such a way user should able to other kinds of element</li>
<li>Save the document to a db or file</li>
</ul>
<h3 id="uml-1"><a class="header" href="#uml-1">UML</a></h3>
<p><img src="https://www.plantuml.com/plantuml/img/ZLHDQ-Cm4BthLmovrAMab3sQDZImBGHww9AzbM8czj28jQKWJSfss_tlbMn9iTtYH1UZcVVcusd6jvRHyBwfnHci-QqciCGirOiLzezKEpJOG5cZjKjc8pTxfbMfrLh-8xWQG-wrujRpuqguU3TJn_cN6yi6IuODMkeYv71NKqEAZz8nabjUfC7rzT2nMC2x07Skm92go6JdEJY0-2z4n_nDVpbWvi3kqladEQi6NoYHfByLE-Jj9FKCLcfBHZAgal8kBweg19FDBhGG5MW1bvSVYsJfa0FJCPqcb7uaOwLbSjMS4cKaU8yz9Rh5LyegPCmTm6dngcLrq77zw-54vBsiwIXqfB2FxWLkkGTz-trxIAjdtzZYlrXF6EYVkjotANpMUBch96jpbDsrcIB4sQAkQFTSjIlaAJpxSn02gwe8Y2nyqmP5NVhJM61TVndcOQ4fSwNBFFc2pJg06y7Xx1nAyTkJfHKQ5k3zxQ9aetKPmlpJ5goBa2aRlExIMbrAPAdLeJJOeeK6rLjit8haci_Jfa0EiuYS2J5gsWCJgqFEliFqfpx2nAtJrlr1Fm40" alt="image"></p>
<pre><code class="language-plantuml">@startuml
' Style settings
skinparam classAttributeIconSize 0
skinparam classFontSize 20

' =============================
' Abstract base class: Element
' =============================
abstract class Element &lt;&lt;abstract class&gt;&gt; {
    + render(): str
}

class Text {
    - text: str
    + render(): str
}

class Image {
    - image_path: str
    + render(): str
}

' Inheritance: Text and Image implement Element
Text ..|&gt; Element
Image ..|&gt; Element

' ================================
' Abstract base class: Persistence
' ================================
abstract class Persistence &lt;&lt;abstract class&gt;&gt; {
    + save(data:str): void
}

class SQL {
    + save(data:str): void
}

class File {
    + save(data:str): void
}

' Inheritance: SQL and File implement Persistence
SQL ..|&gt; Persistence
File ..|&gt; Persistence

' =============================
' Document and DocumentEditor
' =============================
class Document {
    - elements: list[Element]
    + add_element(element: Element): void
    + render_all(): str
}

class DocumentEditor {
    - doc: Document
    - storage: Persistence
    + add_text(text: str): void
    + add_image(image_path: str): void
    + save_to_storage(): void
}

' Association: Document has many Elements
Document --&gt; Element : "has many"

DocumentEditor --&gt; Document : "has"
DocumentEditor --&gt; Persistence : "has"

@enduml
</code></pre>
<h3 id="code"><a class="header" href="#code">Code</a></h3>
<pre><code class="language-py">from abc import ABC, abstractmethod


class Element(ABC):
    @abstractmethod
    def render(self) -&gt; str:
        pass


class Text(Element):
    def __init__(self, txt: str) -&gt; None:
        self.__text = txt

    def render(self) -&gt; str:
        return self.__text


class Image(Element):
    def __init__(self, image_path: str) -&gt; None:
        self.__image_path = image_path

    def render(self) -&gt; str:
        return f"[image : {self.__image_path}]"


class Persistence(ABC):
    @abstractmethod
    def save(self, data: str) -&gt; None:
        pass


class SQL(Persistence):
    def save(self, data: str) -&gt; None:
        print("saving data to sql db")


class File(Persistence):
    def save(self, data: str) -&gt; None:
        print("saving data to file")


class Document:
    def __init__(self) -&gt; None:
        self.__elements: list[Element] = []

    def add_element(self, element: Element) -&gt; None:
        self.__elements.append(element)

    def render_all(self) -&gt; str:
        res = ""
        for element in self.__elements:
            res += element.render()
        return res


class DocumentEditor:
    def __init__(self, doc: Document, storage: Persistence) -&gt; None:
        self.__doc = doc
        self.__storage = storage

    def add_text(self, txt: str) -&gt; None:
        self.__doc.add_element(Text(txt))

    def add_image(self, image_path: str) -&gt; None:
        self.__doc.add_element(Image(image_path))

    def save(self) -&gt; None:
        data = self.__doc.render_all()
        self.__storage.save(data)


# Usage
if __name__ == "__main__":
    document = Document()
    storage = File()
    editor = DocumentEditor(document, storage)
    editor.add_text("Hello, world!")
    editor.add_image("path/to/image.jpg")
    editor.save()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="strategy-pattern"><a class="header" href="#strategy-pattern">Strategy Pattern</a></h1>
<blockquote>
<p>Defines a family of algorithm,encapsulates each one and makes them interchangeble.
We can change the strategy at runtime</p>
</blockquote>
<h3 id="example-6"><a class="header" href="#example-6">Example</a></h3>
<p>Imagine this scenario we are a company making duck simulator app.
We have a following code setup below.We have a duck abstract
class which gets inherited by different kinds of duck.Currently
quack,swim function is defined in the parent class but since each
duck look differently they override the display method respectively.
Currently we are having pure inheritance based setup.</p>
<pre><code class="language-py">from abc import ABC, abstractmethod


class Duck(ABC):
    def quack(self):
        print("quack")

    def swim(self):
        print("swim")

    @abstractmethod
    def display(self):
        pass


class MallardDuck(Duck):
    def display(self):
        print("I am MallardDuck")


class RedHeadDuck(Duck):
    def display(self):
        print("I am RedHeadDuck")


class RubberDuck(Duck):
    def display(self):
        print("I am RubberDuck")
</code></pre>
<p>But suddenly a requirements come up and we have to integrate a
fly method but there is one problem not all ducks fly what we can
do is that add another normal class called flyable duck and make
the mallard,red head duck inherit it.What we can do is define the
fly behaviour over the flyable duck class.Then the code will look
something like this.</p>
<pre><code class="language-py">from abc import ABC, abstractmethod


class Duck(ABC):
    def quack(self):
        print("quack")

    def swim(self):
        print("swim")

    @abstractmethod
    def display(self):
        pass


class Flyable:
    def fly(self):
        print("fly")


class MallardDuck(Duck, Flyable):
    def display(self):
        print("I am MallardDuck")


class RedHeadDuck(Duck, Flyable):
    def display(self):
        print("I am RedHeadDuck")


class RubberDuck(Duck):
    def display(self):
        print("I am RubberDuck")
</code></pre>
<p>But there is a problem because suppose we integrate some other
ducks that fly with jet.Then again if we use inheritance then
we have to again create 2 seperate classes flywithwing and
flywithJet which in the long run will create a mess as for
single behaviour(fly behaviour) we can multiple implementations
and it will be a burden to maintain this.</p>
<h3 id="inheritance-mess"><a class="header" href="#inheritance-mess">Inheritance Mess</a></h3>
<p><img src="https://www.plantuml.com/plantuml/img/ZPFDJiCm48JlVegz0KAL44TKHKL25I2113tql8bDiU8unLw3qiAxanz8DaaBoN5cxFbMwomyeQEG6N42AogC0g-8jDruuLDjj-WmWyIWzzT4JiU1r5sIsvNUARWOHfQvfTgvv9RDfUAEmDYJmuIQGt0JaXJcyxuQHR0NK7xdu3zqTdfs1U-vbZ_IMy0a7MZjUQdzrc3Hsbz2D4LBKwmrlQwhwNulVp77W_UA_emzLHGL_VuWLfjxpEjaMJiX_836e9CyUNIWPoLl5KxCXZXMRbAqd9kcHtV5Fqas4Sncdr6zSC7OkTfICh7ZwOjDCzF6LUsAndsTDRo_v_2IpXY1zdTyW8G_lZ5Cpnq1TUznICGSiL1MbZ_oDm00" alt="Inheritance Mess"></p>
<pre><code class="language-plantuml">@startuml
' Style settings
skinparam classAttributeIconSize 0
skinparam classFontSize 20
skinparam nodeFontSize 20

abstract class Duck &lt;&lt;abstract class&gt;&gt; {
    + swim(): void
    + quack(): void
    + abstract display(): void
}

class FlyWithWings{
    + fly(): void
}

class FlyWithJet{
    + fly(): void
}

class QuackDuck{
    + quack(): void
}

class NoQuackingDuck{
    + quack(): void
}

class MallardDuck{
    + display(): void
}

class RedHeadDuck{
    + display(): void
}

class RubberDuck{
    + display(): void
}

class JetterDuck{
    + display(): void
}

class JetzyDuck{
    + display(): void
}

MallardDuck --|&gt; Duck
RedHeadDuck --|&gt; Duck
RubberDuck --|&gt; Duck
JetterDuck --|&gt; Duck
JetzyDuck --|&gt; Duck

MallardDuck --|&gt; QuackDuck
RedHeadDuck --|&gt; QuackDuck
JetterDuck --|&gt; QuackDuck
JetzyDuck --|&gt; QuackDuck

RubberDuck --|&gt; NoQuackingDuck

MallardDuck --|&gt; FlyWithWings
RedHeadDuck --|&gt; FlyWithWings

JetterDuck --|&gt; FlyWithJet
JetzyDuck --|&gt; FlyWithJet

@enduml
</code></pre>
<p>After careful analysis what we can do is extrac the behaviour that
is changing and encapsulate it into classes.We can use composition
in place of inheritance as it will help us change duck behaviour
in runtime.We are going to extract swim,fly and quack behaviour as
it varies from duck to duck</p>
<pre><code class="language-py">from abc import ABC, abstractmethod


class SwimBehaviour(ABC):
    @abstractmethod
    def swim(self):
        pass


class SwimNormal(SwimBehaviour):
    def swim(self):
        print("swim normally")


class SwimBackwards(SwimBehaviour):
    def swim(self):
        print("swim backwards manner")


class FlyBehaviour(ABC):
    @abstractmethod
    def fly(self):
        pass


class FlyWithWings(FlyBehaviour):
    def fly(self):
        print("fly with wings")


class FlyWithJet(FlyBehaviour):
    def fly(self):
        print("fly with jet")


class NoFly(FlyBehaviour):
    def fly(self):
        print("cant fly")


class QuackBehaviour(ABC):
    @abstractmethod
    def quack(self):
        pass


class QuackNormal(QuackBehaviour):
    def quack(self):
        print("quack")


class QuackSqueak(QuackBehaviour):
    def quack(self):
        print("squeak")


class Duck(ABC):
    def __init__(self, s: SwimBehaviour, f: FlyBehaviour, q: QuackBehaviour) -&gt; None:
        self.s: SwimBehaviour = s
        self.f: FlyBehaviour = f
        self.q: QuackBehaviour = q

    def swim(self):
        self.s.swim()

    def fly(self):
        self.f.fly()

    def quack(self):
        self.q.quack()


class MallardDuck(Duck):
    def __init__(self, s: SwimBehaviour, f: FlyBehaviour, q: QuackBehaviour) -&gt; None:
        super().__init__(s, f, q)


class RubberDuck(Duck):
    def __init__(self, s: SwimBehaviour, f: FlyBehaviour, q: QuackBehaviour) -&gt; None:
        super().__init__(s, f, q)


if __name__ == "__main__":
    md = MallardDuck(SwimNormal(), FlyWithWings(), QuackNormal())
    rd = RubberDuck(SwimBackwards(), NoFly(), QuackSqueak())
</code></pre>
<h3 id="uml-with-strategy-pattern-applied"><a class="header" href="#uml-with-strategy-pattern-applied">UML with Strategy Pattern applied</a></h3>
<p><img src="https://www.plantuml.com/plantuml/img/ZPJBJiCm44NtynNUyL8an19LLQbG9P2e15bqxII6Md5iQezRXSU_uxe2_6YgP3dtZ6SySvsPGQhHTWBEI8czOCGmH2xV39YMotUgQKTgGOsvGzIyiiWUQYLB_i78TOeib4Ilt8IIL0qB5Q2LGKrhF2IHSiUxELlJBLTMayaabgTJyWd4VLV4EF3yufPi5M_W6-0_VQbqHyK8S4xhTaTrOmRPfBc5w4VrzYhwlA9BNd5Sh_RZ74K-CZpDBPKZXv2azMVhBZkg-SsUp8lv0vBHdaBBZMMq7KQJ_kvjtOvUTtxXWI9FL0YtO7zuKNnDVHbuiLN5T1ACsCkY2AoKIU4gCp4O58IbVi_ySrqg-dMcmM2M086xVUFHOu7OqaS0Y2peWT3H4FWk5mzco-CG6iFBiTKWTCCn7MPCDkwVymC0" alt="Strategy Pattern"></p>
<pre><code class="language-plantuml">@startuml
' Style settings
skinparam classAttributeIconSize 0
skinparam classFontSize 20
skinparam nodeFontSize 20

abstract class SwimBehaviour &lt;&lt;abstract class&gt;&gt; {
    + swim(): void
}

class SwimNormal {
    + swim(): void
}

class SwimBackwards {
    + swim(): void
}

abstract class FlyBehaviour &lt;&lt;abstract class&gt;&gt; {
    + fly(): void
}

class FlyWithWings {
    + fly(): void
}

class FlyWithJet {
    + fly(): void
}

class NoFly {
    + fly(): void
}

abstract class QuackBehaviour &lt;&lt;abstract class&gt;&gt; {
    + quack(): void
}

class QuackNormal {
    + quack(): void
}

class QuackSqueak {
    + quack(): void
}

abstract class Duck &lt;&lt;abstract class&gt;&gt; {
    + swim(): void
    + fly(): void
    + quack(): void
}

MallardDuck --|&gt; Duck
RubberDuck --|&gt; Duck

MallardDuck *-- SwimNormal
MallardDuck *-- FlyWithWings
MallardDuck *-- QuackNormal

RubberDuck *-- SwimBackwards
RubberDuck *-- NoFly
RubberDuck *-- QuackSqueak

SwimNormal --|&gt; SwimBehaviour
SwimBackwards --|&gt; SwimBehaviour

FlyWithWings --|&gt; FlyBehaviour
FlyWithJet --|&gt; FlyBehaviour
NoFly --|&gt; FlyBehaviour

QuackNormal --|&gt; QuackBehaviour
QuackSqueak --|&gt; QuackBehaviour

@enduml
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="simple-factory"><a class="header" href="#simple-factory">Simple Factory</a></h1>
<blockquote>
<p>Provides us a factory class which decides which concrete class to create
Its not a design pattern but just a principle</p>
</blockquote>
<h3 id="example-7"><a class="header" href="#example-7">Example</a></h3>
<p>Imagine we have a pizza store which on getting an order of pizza of
specfic type starts preparing the pizza and does the other jobs like
baking,cutting,boxing,etc.</p>
<pre><code class="language-py">from abc import ABC, abstractmethod
from enum import Enum


class Pizza(ABC):
    @abstractmethod
    def prepare(self):
        pass

    @abstractmethod
    def bake(self):
        pass

    @abstractmethod
    def cut(self):
        pass

    @abstractmethod
    def box(self):
        pass


class CheesePizza(Pizza):
    def prepare(self):
        print("Preparing cheese pizza...")

    def bake(self):
        print("Baking cheese pizza...")

    def cut(self):
        print("Cutting cheese pizza...")

    def box(self):
        print("Boxing cheese pizza...")


class PepporoniPizza(Pizza):
    def prepare(self):
        print("Preparing pepperoni pizza...")

    def bake(self):
        print("Baking pepperoni pizza...")

    def cut(self):
        print("Cutting pepperoni pizza...")

    def box(self):
        print("Boxing pepperoni pizza...")


class ClamPizza(Pizza):
    def prepare(self):
        print("Preparing clam pizza...")

    def bake(self):
        print("Baking clam pizza...")

    def cut(self):
        print("Cutting clam pizza...")

    def box(self):
        print("Boxing clam pizza...")


class VeggiePizza(Pizza):
    def prepare(self):
        print("Preparing veggie pizza...")

    def bake(self):
        print("Baking veggie pizza...")

    def cut(self):
        print("Cutting veggie pizza...")

    def box(self):
        print("Boxing veggie pizza...")


class PizzaType(Enum):
    Cheese = "cheese"
    Pepporoni = "pepporoni"
    Clam = "clam"
    Veggie = "veggie"


class PizzaStore:
    def create_order(self, pizza_type: "PizzaType"):
        p: Pizza | None = None

        if pizza_type == PizzaType.Cheese:
            p = CheesePizza()
        elif pizza_type == PizzaType.Pepporoni:
            p = PepporoniPizza()
        elif pizza_type == PizzaType.Clam:
            p = ClamPizza()
        elif pizza_type == PizzaType.Veggie:
            p = VeggiePizza()
        else:
            print("Invalid pizza type")
            return

        p.prepare()
        p.bake()
        p.cut()
        p.box()
</code></pre>
<p>There is a downside of above design as the PizzaStore class has to be modified
everytime a new pizza type is added and we will be breaking OCP principle instead
we should use a seperate factory class to create the instances of the pizza, by doing
this we are making the create_order method closed for modification following OCP.</p>
<pre><code class="language-py">from abc import ABC, abstractmethod
from enum import Enum


class Pizza(ABC):
    @abstractmethod
    def prepare(self):
        pass

    @abstractmethod
    def bake(self):
        pass

    @abstractmethod
    def cut(self):
        pass

    @abstractmethod
    def box(self):
        pass


class CheesePizza(Pizza):
    def prepare(self):
        print("Preparing cheese pizza...")

    def bake(self):
        print("Baking cheese pizza...")

    def cut(self):
        print("Cutting cheese pizza...")

    def box(self):
        print("Boxing cheese pizza...")


class PepporoniPizza(Pizza):
    def prepare(self):
        print("Preparing pepperoni pizza...")

    def bake(self):
        print("Baking pepperoni pizza...")

    def cut(self):
        print("Cutting pepperoni pizza...")

    def box(self):
        print("Boxing pepperoni pizza...")


class ClamPizza(Pizza):
    def prepare(self):
        print("Preparing clam pizza...")

    def bake(self):
        print("Baking clam pizza...")

    def cut(self):
        print("Cutting clam pizza...")

    def box(self):
        print("Boxing clam pizza...")


class VeggiePizza(Pizza):
    def prepare(self):
        print("Preparing veggie pizza...")

    def bake(self):
        print("Baking veggie pizza...")

    def cut(self):
        print("Cutting veggie pizza...")

    def box(self):
        print("Boxing veggie pizza...")


class PizzaType(Enum):
    Cheese = "cheese"
    Pepporoni = "pepporoni"
    Clam = "clam"
    Veggie = "veggie"


class SimplePizzaFactory:
    def create_pizza(self, pizza_type: "PizzaType") -&gt; Pizza:
        if pizza_type == PizzaType.Cheese:
            return CheesePizza()
        elif pizza_type == PizzaType.Pepporoni:
            return PepporoniPizza()
        elif pizza_type == PizzaType.Clam:
            return ClamPizza()
        elif pizza_type == PizzaType.Veggie:
            return VeggiePizza()
        else:
            raise Exception("Invalid pizza type")


class PizzaStore:
    def __init__(self, pf: SimplePizzaFactory) -&gt; None:
        self.pf: SimplePizzaFactory = pf

    def create_order(self, pizza_type: "PizzaType"):
        p: Pizza = self.pf.create_pizza(pizza_type)
        p.prepare()
        p.bake()
        p.cut()
        p.box()


if __name__ == "__main__":
    pf = SimplePizzaFactory()
    store = PizzaStore(pf)

    store.create_order(PizzaType.Cheese)
    print()

    store.create_order(PizzaType.Pepporoni)
    print()

    store.create_order(PizzaType.Clam)
    print()

    store.create_order(PizzaType.Veggie)

    try:
        store.create_order("Invalid Pizza Type")
    except Exception as e:
        print(f"\nError: {e}")
</code></pre>
<h3 id="standarduml"><a class="header" href="#standarduml">StandardUML</a></h3>
<p><img src="https://www.plantuml.com/plantuml/img/RP3B2i8m44NtynMpKv62k7GXhOL2Tq8_G68wIB1DIZ9PrEg_6wgr3vpbkUToOMB7mhAlArXXmMr5w8XPwPi3TrUw4LRKA2lXNC9irTKpvTBeGZq8TqibCvhxP3-Dj2bfca3lujcQqalkNWkG1383foL8nquc91lRTe3XjYWj2QPBy_7McyDGWT3ukXWTVnI6JOoYvuY7uRyqdLE8IPVXVsy0" alt="SimpleFactory"></p>
<pre><code class="language-plantuml">@startuml
' Style settings
skinparam classAttributeIconSize 0
skinparam classFontSize 20
skinparam nodeFontSize 20

class Product{}

class ProductA{}
class ProductB{}
class ProductC{}

class Factory{
    + create_product(): Product
}

Factory -&gt; Product

ProductA --|&gt; Product
ProductB --|&gt; Product
ProductC --|&gt; Product

@enduml
</code></pre>
<h1 id="factory-method"><a class="header" href="#factory-method">Factory method</a></h1>
<blockquote>
<p>Defines an interface for creating objects but allows subclass to decide
which concrete class to instantiate</p>
</blockquote>
<h3 id="example-1-1"><a class="header" href="#example-1-1">Example</a></h3>
<p>Imagine now we want to create franchise of our store in NewYork and California,
so we can just extend out Simple factory design and use factory method.But first
lets understand the current scenario.Out pizza store more or less sells 4 variants
of pizza veggie,clam,cheese,pepporoni based but for different region it will be in
different form for example new yorkers when ordeing cheese pizza they mean less cheese
whereas californians when ordering cheese pizza they mean more pizza.Below code shows
how to extend our previous design to support factory method.</p>
<pre><code class="language-py">from abc import ABC, abstractmethod
from enum import Enum


class Pizza(ABC):
    def __init__(self, name: str, dough: str, sauce: str, topppings: list[str]) -&gt; None:
        self.name = name
        self.dough = dough
        self.sauce = sauce
        self.topppings = topppings

    @abstractmethod
    def prepare(self):
        print(f"preapring {self.name}")
        print(f"toss {self.dough}")
        print(f"add {self.sauce}")
        for topping in self.topppings:
            print(f"add {topping}")

    @abstractmethod
    def bake(self):
        pass

    def cut(self):
        print("cut pizza diagonally")

    def box(self):
        print(f"put {self.name} into offical boxes")


class PizzaType(Enum):
    Cheese = "cheese"
    Pepporoni = "pepporoni"
    Clam = "clam"
    Veggie = "veggie"


class PizzaStore(ABC):
    @abstractmethod
    def create_pizza(self, pizza_type: "PizzaType") -&gt; Pizza:
        pass

    def create_order(self, pizza_type: "PizzaType"):
        p: Pizza = self.create_pizza(pizza_type)
        p.prepare()
        p.bake()
        p.cut()
        p.box()


class NYCheesePizza(Pizza):
    def __init__(self) -&gt; None:
        super().__init__(
            "NY Cheese Pizza", "NY-style dough", "Tomato sauce", ["Mozzarella cheese"]
        )

    def prepare(self):
        print(f"preparing {self.name}")
        print(f"toss {self.dough} in a NY-style")
        print(f"add {self.sauce}")
        for topping in self.topppings:
            print(f"add {topping}")

    def bake(self):
        print("bake NY-style pizza for 20 mins at 400")


class NYPepporoniPizza(Pizza):
    def __init__(self) -&gt; None:
        super().__init__(
            "NY Pepporoni Pizza",
            "NY-style dough",
            "Tomato sauce",
            ["Mozzarella cheese", "Pepporoni"],
        )

    def prepare(self):
        print(f"preparing {self.name}")
        print(f"toss {self.dough} in a NY-style")
        print(f"add {self.sauce}")
        for topping in self.topppings:
            print(f"add {topping}")

    def bake(self):
        print("bake NY-style pizza for 20 mins at 400")


class NYClamPizza(Pizza):
    def __init__(self) -&gt; None:
        super().__init__(
            "NY Clam Pizza",
            "NY-style dough",
            "Tomato sauce",
            ["Mozzarella cheese", "Clams"],
        )

    def prepare(self):
        print(f"preparing {self.name}")
        print(f"toss {self.dough} in a NY-style")
        print(f"add {self.sauce}")
        for topping in self.topppings:
            print(f"add {topping}")

    def bake(self):
        print("bake NY-style pizza for 20 mins at 400")


class NYVeggiePizza(Pizza):
    def __init__(self) -&gt; None:
        super().__init__(
            "NY Veggie Pizza",
            "NY-style dough",
            "Tomato sauce",
            ["Mozzarella cheese", "Vegetables"],
        )

    def prepare(self):
        print(f"preparing {self.name}")
        print(f"toss {self.dough} in a NY-style")
        print(f"add {self.sauce}")
        for topping in self.topppings:
            print(f"add {topping}")

    def bake(self):
        print("bake NY-style pizza for 20 mins at 400")


class CaliCheesePizza(Pizza):
    def __init__(self) -&gt; None:
        super().__init__(
            "Cali Cheese Pizza",
            "Cali-style dough",
            "Pesto sauce",
            ["Mozzarella cheese"],
        )

    def prepare(self):
        print(f"preparing {self.name}")
        print(f"toss {self.dough} in a Cali-style")
        print(f"add {self.sauce}")
        for topping in self.topppings:
            print(f"add {topping}")

    def bake(self):
        print("bake Cali-style pizza for 25 mins at 425")


class CaliPepporoniPizza(Pizza):
    def __init__(self) -&gt; None:
        super().__init__(
            "Cali Pepporoni Pizza",
            "Cali-style dough",
            "Pesto sauce",
            ["Mozzarella cheese", "Pepporoni"],
        )

    def prepare(self):
        print(f"preparing {self.name}")
        print(f"toss {self.dough} in a Cali-style")
        print(f"add {self.sauce}")
        for topping in self.topppings:
            print(f"add {topping}")

    def bake(self):
        print("bake Cali-style pizza for 25 mins at 425")


class CaliClamPizza(Pizza):
    def __init__(self) -&gt; None:
        super().__init__(
            "Cali Clam Pizza",
            "Cali-style dough",
            "Pesto sauce",
            ["Mozzarella cheese", "Clams"],
        )

    def prepare(self):
        print(f"preparing {self.name}")
        print(f"toss {self.dough} in a Cali-style")
        print(f"add {self.sauce}")
        for topping in self.topppings:
            print(f"add {topping}")

    def bake(self):
        print("bake Cali-style pizza for 25 mins at 425")


class CaliVeggiePizza(Pizza):
    def __init__(self) -&gt; None:
        super().__init__(
            "Cali Veggie Pizza",
            "Cali-style dough",
            "Pesto sauce",
            ["Mozzarella cheese", "Vegetables"],
        )

    def prepare(self):
        print(f"preparing {self.name}")
        print(f"toss {self.dough} in a Cali-style")
        print(f"add {self.sauce}")
        for topping in self.topppings:
            print(f"add {topping}")

    def bake(self):
        print("bake Cali-style pizza for 25 mins at 425")


class NYPizzaStore(PizzaStore):
    def create_pizza(self, pizza_type: "PizzaType") -&gt; Pizza:
        if pizza_type == PizzaType.Cheese:
            return NYCheesePizza()
        elif pizza_type == PizzaType.Pepporoni:
            return NYPepporoniPizza()
        elif pizza_type == PizzaType.Clam:
            return NYClamPizza()
        elif pizza_type == PizzaType.Veggie:
            return NYVeggiePizza()
        else:
            raise Exception("Invalid pizza type")


class CaliforniaPizzaStore(PizzaStore):
    def create_pizza(self, pizza_type: "PizzaType") -&gt; Pizza:
        if pizza_type == PizzaType.Cheese:
            return CaliCheesePizza()
        elif pizza_type == PizzaType.Pepporoni:
            return CaliPepporoniPizza()
        elif pizza_type == PizzaType.Clam:
            return CaliClamPizza()
        elif pizza_type == PizzaType.Veggie:
            return CaliVeggiePizza()
        else:
            raise Exception("Invalid pizza type")


# Example usage:
if __name__ == "__main__":
    ny_store = NYPizzaStore()
    cali_store = CaliforniaPizzaStore()

    ny_cheese_pizza = ny_store.create_order(PizzaType.Cheese)
    print("\n")
    cali_cheese_pizza = cali_store.create_order(PizzaType.Cheese)

    ny_pepperoni_pizza = ny_store.create_order(PizzaType.Pepporoni)
    print("\n")
    cali_pepperoni_pizza = cali_store.create_order(PizzaType.Pepporoni)

    ny_clam_pizza = ny_store.create_order(PizzaType.Clam)
    print("\n")
    cali_clam_pizza = cali_store.create_order(PizzaType.Clam)

    ny_veggie_pizza = ny_store.create_order(PizzaType.Veggie)
    print("\n")
    cali_veggie_pizza = cali_store.create_order(PizzaType.Veggie)
</code></pre>
<h3 id="standarduml-1"><a class="header" href="#standarduml-1">StandardUML</a></h3>
<p><img src="https://www.plantuml.com/plantuml/img/bPAn3e8m48RtFaKtDOP4EpeGw43YPi83c5eQquWjQOy1qNUt0O5I6RHRl_-xI-_In08pKDzBjC8vDAN0LW18TRN8tgIgc65tp4jcRGfWvAK6SUHQvV8Xy2vKCgsWIuWVALq8Fq6TYqz65pM7zXM0TE_Gd92Gq2-7agbHnZXeqxG8kxF5t0W6ubprudfp66fGM97-Nq9_AXb7mr7qZCTad6yHqsMR1ZOQ7j_ZpssWT4vzEPuslem9yhl4q_ANiTCJeGhtbzu0" alt="FactoryMethod"></p>
<pre><code class="language-plantuml">@startuml
' Style settings
skinparam classAttributeIconSize 0
skinparam classFontSize 20
skinparam nodeFontSize 20

class Product{}

class ProductA1{}
class ProductA2{}
class ProductB1{}
class ProductB2{}

class Factory{
    + create_product(): Product
}

class FactoryA{
    + create_product(): Product
}

class FactoryB{
    + create_product(): Product
}

ProductA1 --|&gt; Product
ProductA2 --|&gt; Product
ProductB1 --|&gt; Product
ProductB2 --|&gt; Product

FactoryA --|&gt; Factory
FactoryB --|&gt; Factory

FactoryA --&gt; ProductA1
FactoryA --&gt; ProductA2

FactoryB --&gt; ProductB1
FactoryB --&gt; ProductB2

@enduml
</code></pre>
<h1 id="abstract-factory"><a class="header" href="#abstract-factory">Abstract Factory</a></h1>
<blockquote>
<p>Provides inteface for creating families of related object without specfying concrete classes</p>
</blockquote>
<h3 id="example-2-1"><a class="header" href="#example-2-1">Example</a></h3>
<p>Suppose in our pizza store ,different kind of pizza will have different ingredients as
different regions will use different ingredients to make the pizza.</p>
<pre><code class="language-py">from abc import ABC, abstractmethod
from enum import Enum


class PizzaIngridentFactory(ABC):
    def __init__(self):
        self.dough: str = ""
        self.sauce: str = ""
        self.cheese: str = ""
        self.veggies: list[str] = []
        self.pepporoni: str = ""
        self.clam = ""

    @abstractmethod
    def add_dough(self) -&gt; str:
        pass

    @abstractmethod
    def add_sauce(self) -&gt; str:
        pass

    @abstractmethod
    def add_cheese(self) -&gt; str:
        pass

    @abstractmethod
    def add_veggies(self) -&gt; list[str]:
        pass

    @abstractmethod
    def add_pepporoni(self) -&gt; str:
        pass

    @abstractmethod
    def add_clams(self) -&gt; str:
        pass


class NYStylePizzaIngredientFactory(PizzaIngridentFactory):
    def __init__(self):
        super().__init__()

    def add_dough(self) -&gt; str:
        self.dough = "NY-style dough"
        return self.dough

    def add_sauce(self) -&gt; str:
        self.sauce = "Tomato sauce"
        return self.sauce

    def add_cheese(self) -&gt; str:
        self.cheese = "Mozzarella cheese"
        return self.cheese

    def add_pepporoni(self) -&gt; str:
        self.pepporoni = "Fresh Pepporoni"
        return self.pepporoni

    def add_veggies(self) -&gt; list[str]:
        self.veggies = ["Onions", "Peppers"]
        return self.veggies

    def add_clams(self) -&gt; str:
        self.clam = "Fresh clams from Long Island Sound"
        return self.clam


class CaliforniaStylePizzaIngredientFactory(PizzaIngridentFactory):
    def __init__(self):
        super().__init__()

    def add_dough(self) -&gt; str:
        self.dough = "Cali-style dough"
        return self.dough

    def add_sauce(self) -&gt; str:
        self.sauce = "Pesto sauce"
        return self.sauce

    def add_cheese(self) -&gt; str:
        self.cheese = "Ricotta cheese"
        return self.cheese

    def add_pepporoni(self) -&gt; str:
        self.pepporoni = "Fresh Pepporoni"
        return self.pepporoni

    def add_veggies(self) -&gt; list[str]:
        self.veggies = ["Spinach", "Mushrooms"]
        return self.veggies

    def add_clams(self) -&gt; str:
        self.clam = "Fresh clams from California coast"
        return self.clam


class Pizza(ABC):
    def __init__(self, name: str, pif: PizzaIngridentFactory) -&gt; None:
        self.name = name
        self.pif = pif

    @abstractmethod
    def prepare(self):
        pass

    @abstractmethod
    def bake(self):
        pass

    def cut(self):
        print("Cutting pizza...")

    def box(self):
        print("Boxing pizza...")


class CheesePizza(Pizza):
    def __init__(self, name: str, pif: PizzaIngridentFactory) -&gt; None:
        super().__init__(name, pif)

    def prepare(self):
        print(f"Preparing {self.name} cheese pizza...")
        self.pif.add_dough()
        self.pif.add_sauce()
        self.pif.add_cheese()
        print(
            f"Adding ingredients: {self.pif.dough}, {self.pif.sauce}, {self.pif.cheese}"
        )

    def bake(self):
        print(f"Baking {self.name} cheese pizza...")


class PepporoniPizza(Pizza):
    def __init__(self, name: str, pif: PizzaIngridentFactory) -&gt; None:
        super().__init__(name, pif)

    def prepare(self):
        print(f"Preparing {self.name} pepperoni pizza...")
        self.pif.add_dough()
        self.pif.add_sauce()
        self.pif.add_cheese()
        self.pif.add_pepporoni()
        print(
            f"Adding ingredients: {self.pif.dough}, {self.pif.sauce}, {self.pif.cheese}, {self.pif.pepporoni}"
        )

    def bake(self):
        print(f"Baking {self.name} pepperoni pizza...")


class ClamPizza(Pizza):
    def __init__(self, name: str, pif: PizzaIngridentFactory) -&gt; None:
        super().__init__(name, pif)

    def prepare(self):
        print(f"Preparing {self.name} clam pizza...")
        self.pif.add_dough()
        self.pif.add_sauce()
        self.pif.add_cheese()
        self.pif.add_clams()
        self.pif.add_veggies()
        print(
            f"Adding ingredients: {self.pif.dough}, {self.pif.sauce}, {self.pif.cheese}, {self.pif.clam}, {self.pif.veggies}"
        )

    def bake(self):
        print(f"Baking {self.name} clam pizza...")


class VeggiePizza(Pizza):
    def __init__(self, name: str, pif: PizzaIngridentFactory) -&gt; None:
        super().__init__(name, pif)

    def prepare(self):
        print(f"Preparing {self.name} veggie pizza...")
        self.pif.add_dough()
        self.pif.add_sauce()
        self.pif.add_cheese()
        self.pif.add_veggies()
        print(
            f"Adding ingredients: {self.pif.dough}, {self.pif.sauce}, {self.pif.cheese}, {self.pif.veggies}"
        )

    def bake(self):
        print(f"Baking {self.name} veggie pizza...")


class PizzaType(Enum):
    Cheese = "cheese"
    Pepporoni = "pepporoni"
    Clam = "clam"
    Veggie = "veggie"


class PizzaStore(ABC):
    @abstractmethod
    def create_pizza(self, pizza_type: "PizzaType", name: str) -&gt; Pizza:
        pass

    def create_order(self, pizza_type: "PizzaType", name: str):
        p = self.create_pizza(pizza_type, name)
        p.prepare()
        p.bake()
        p.cut()
        p.box()


class NYPizzaStore(PizzaStore):
    def create_pizza(self, pizza_type: "PizzaType", name: str) -&gt; Pizza:
        pif = NYStylePizzaIngredientFactory()
        if pizza_type == PizzaType.Cheese:
            return CheesePizza(name, pif)
        elif pizza_type == PizzaType.Pepporoni:
            return PepporoniPizza(name, pif)
        elif pizza_type == PizzaType.Clam:
            return ClamPizza(name, pif)
        elif pizza_type == PizzaType.Veggie:
            return VeggiePizza(name, pif)


class CaliPizzaStore(PizzaStore):
    def create_pizza(self, pizza_type: "PizzaType", name: str) -&gt; Pizza:
        pif = CaliforniaStylePizzaIngredientFactory()
        if pizza_type == PizzaType.Cheese:
            return CheesePizza(name, pif)
        elif pizza_type == PizzaType.Pepporoni:
            return PepporoniPizza(name, pif)
        elif pizza_type == PizzaType.Clam:
            return ClamPizza(name, pif)
        elif pizza_type == PizzaType.Veggie:
            return VeggiePizza(name, pif)


if __name__ == "__main__":
    ny_store = NYPizzaStore()
    cali_store = CaliPizzaStore()

    ny_store.create_order(PizzaType.Cheese, "New York Style Cheese Pizza")
    print()

    cali_store.create_order(PizzaType.Clam, "California Style Clam Pizza")
    print()

    ny_store.create_order(PizzaType.Pepporoni, "NY Style Pepporoni Pizza")
    print()

    cali_store.create_order(PizzaType.Veggie, "Cali Veggie Pizza")
</code></pre>
<h3 id="standarduml-2"><a class="header" href="#standarduml-2">StandardUML</a></h3>
<p><img src="https://www.plantuml.com/plantuml/img/bPFDYi8m4CVlUOhSLbc4pHmz53i7OM-23o0n3Kkn9f9C3twzkqMjZKa3RcxvpVy3XcJXIJfgzmtxuciwDffxJLIRFy_yhZO7wUIUgqPwNnAvUjkI_bNMhEkJvZ-nP6aDtISGZeojT3XXTorVELkrYixN29H2TEmTGOe4f2f8mZ0DmpGCqp0CmvPIaNN7C-FT-URAQKbwStWe9zDvRsAne_o_1J-o3BlYizcbU8s6XOrp0HbznDcmlr43PWemKu19GR-X1txUUehlD1GNmJiPvv3X0Z9wO65l4RoTSGuPFXH4-gvWeKtL_R8R" alt="Abstract Factory"></p>
<pre><code class="language-plantuml">@startuml
' Style settings
skinparam classAttributeIconSize 0
skinparam classFontSize 20
skinparam nodeFontSize 20

class Product{}

class ProductA11{}
class ProductA21{}
class ProductA12{}
class ProductA22{}

class ProductB11{}
class ProductB21{}
class ProductB12{}
class ProductB22{}

class Factory{
    + create_product(): Product
}

class FactoryA{
    + create_product(): Product
}

class FactoryB{
    + create_product(): Product
}

ProductA11 --|&gt; Product
ProductA21 --|&gt; Product
ProductA12 --|&gt; Product
ProductA22 --|&gt; Product

ProductB11 --|&gt; Product
ProductB21 --|&gt; Product
ProductB12 --|&gt; Product
ProductB22 --|&gt; Product

FactoryA --|&gt; Factory
FactoryB --|&gt; Factory

FactoryA --&gt; ProductA11
FactoryA --&gt; ProductA21
FactoryA --&gt; ProductA12
FactoryA --&gt; ProductA22

FactoryB --&gt; ProductB11
FactoryB --&gt; ProductB21
FactoryB --&gt; ProductB12
FactoryB --&gt; ProductB22

@enduml
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="singleton-pattern"><a class="header" href="#singleton-pattern">Singleton Pattern</a></h1>
<blockquote>
<p>The Singleton Pattern ensures a class has only one instance, and provides a global point of access to it</p>
</blockquote>
<ul>
<li>Used by logging,caching,database connections</li>
</ul>
<h3 id="example-8"><a class="header" href="#example-8">Example</a></h3>
<blockquote>
<p>Way of creating Singleton in python</p>
</blockquote>
<pre><code class="language-py">class Singleton:
    __instance = None

    @staticmethod
    def get_instance() -&gt; "Singleton":
        if Singleton.__instance is None:
            Singleton.__instance = Singleton()
        return Singleton.__instance


s1 = Singleton.get_instance()
s2 = Singleton.get_instance()
s3 = Singleton.get_instance()
s4 = Singleton.get_instance()
s5 = Singleton.get_instance()

print(id(s1) == id(s3) == id(s5) == id(s2))
</code></pre>
<blockquote>
<p>Way of creating Singleton in python [thread safe]</p>
</blockquote>
<pre><code class="language-py">import threading


class Singleton:
    __instance = None
    __lock = threading.Lock()

    @staticmethod
    def get_instance() -&gt; "Singleton":
        with Singleton.__lock:
            if Singleton.__instance is None:
                Singleton.__instance = Singleton()
            return Singleton.__instance


s1 = Singleton.get_instance()
s2 = Singleton.get_instance()
s3 = Singleton.get_instance()
s4 = Singleton.get_instance()
s5 = Singleton.get_instance()

print(id(s1) == id(s3) == id(s5) == id(s2))
</code></pre>
<blockquote>
<p>Way of creating Singleton in python [thread safe double locking]</p>
</blockquote>
<pre><code class="language-py">import threading


class Singleton:
    __instance = None
    __lock = threading.Lock()

    @staticmethod
    def get_instance() -&gt; "Singleton":
        if Singleton.__instance is None:  # First check (no lock)
            with Singleton.__lock:
                if Singleton.__instance is None:  # Second check (with lock)
                    Singleton.__instance = Singleton()
        return Singleton.__instance


# Testing
s1 = Singleton.get_instance()
s2 = Singleton.get_instance()
s3 = Singleton.get_instance()
s4 = Singleton.get_instance()
s5 = Singleton.get_instance()

print(id(s1) == id(s2) == id(s3) == id(s4) == id(s5))
</code></pre>
<blockquote>
<p>Way of creating Singleton in golang [thread safe double locking]</p>
</blockquote>
<pre><code class="language-go">package main

import (
	"fmt"
	"sync"
)

type Singleton struct {
	val int
}

var (
	singletonInstance *Singleton
	mu                sync.Mutex
)

var c int

func getInstance() *Singleton {
	if singletonInstance == nil {
		mu.Lock()
		defer mu.Unlock()

		if singletonInstance == nil {
			singletonInstance = &amp;Singleton{
				val: c,
			}
			c += 1
		}
	}
	return singletonInstance
}

func main() {
	wg := new(sync.WaitGroup)
	c := 100
	wg.Add(c)

	for i := 0; i &lt; c; i++ {
		fmt.Println(getInstance())
		wg.Done()
	}

	wg.Wait()
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="design-zomato"><a class="header" href="#design-zomato">Design zomato</a></h1>
<h3 id="functional-requirements"><a class="header" href="#functional-requirements">Functional Requirements</a></h3>
<ul>
<li>User can search for restaurants based on location</li>
<li>User can add items in cart.</li>
<li>User can checkout and make payment.</li>
<li>User should be notified once order places successfully.</li>
</ul>
<h3 id="non-functional-requirements"><a class="header" href="#non-functional-requirements">Non Functional Requirements</a></h3>
<ul>
<li>Each part of design should be scalable and modifiable.</li>
</ul>
<h3 id="uml-2"><a class="header" href="#uml-2">UML</a></h3>
<pre><code class="language-plantuml">
</code></pre>
<h3 id="code-1"><a class="header" href="#code-1">Code</a></h3>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
